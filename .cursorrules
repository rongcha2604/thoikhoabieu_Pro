# Cursor AI Rules - Universal Template

## Project Context
**Tech Stack:**
- Backend: [YOUR_BACKEND_FRAMEWORK] (e.g., NestJS, FastAPI, Django, Spring Boot)
- Frontend: [YOUR_FRONTEND_FRAMEWORK] (e.g., Next.js, React, Vue, Angular)
- Database: [YOUR_DATABASE] (e.g., PostgreSQL, MySQL, MongoDB)
- Deployment: [YOUR_DEPLOYMENT] (e.g., Docker, Kubernetes, AWS, Vercel)

**Má»¥c Ä‘Ã­ch dá»± Ã¡n:** [MÃ” Táº¢ NGáº®N Gá»ŒN Vá»€ Dá»° ÃN - 1-2 cÃ¢u vá» business domain vÃ  chá»©c nÄƒng chÃ­nh]

**Project Structure:**
```
[Cháº¡y `tree -L 2` hoáº·c `ls -R` vÃ  paste káº¿t quáº£ vÃ o Ä‘Ã¢y]

Example:
my-project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ [main folders]
â”œâ”€â”€ [config files]
â””â”€â”€ [other directories]
```

**ğŸ“ NOTE:** Sau khi copy file nÃ y vÃ o dá»± Ã¡n má»›i:
1. Thay tháº¿ `[YOUR_...]` placeholders á»Ÿ trÃªn
2. Update `project_directory` trong táº¥t cáº£ MCP calls (search "[YOUR_ABSOLUTE_PROJECT_PATH]")
3. Äiá»n "Framework-Specific Notes" (tham kháº£o templates á»Ÿ cuá»‘i)
4. Äiá»n "Project-Specific Conventions" (API, naming, directories)

---

## ğŸ“š Generic Vocabulary - Tá»« Vá»±ng Tá»•ng QuÃ¡t

### ğŸ¯ Má»¥c Ä‘Ã­ch:
Äá»ƒ file rules phÃ¹ há»£p vá»›i Má»ŒI loáº¡i doanh nghiá»‡p (sáº£n pháº©m, dá»‹ch vá»¥, B2B, B2C, v.v.)

### ğŸ“ Generic Terms:

**1. Entity/Record/Item (Thá»±c thá»ƒ/Báº£n ghi/Má»¥c):**
- DÃ¹ng cho: Báº¥t ká»³ Ä‘á»‘i tÆ°á»£ng business nÃ o trong há»‡ thá»‘ng
- VÃ­ dá»¥ mapping:
  - E-commerce: "Product" = Entity
  - Service: "Service Package" = Entity
  - CRM: "Customer" = Entity
  - Booking: "Booking" = Entity
  - Project Management: "Project" = Entity
  - Document Management: "Document" = Entity

**2. Transaction (Giao dá»‹ch):**
- DÃ¹ng cho: Báº¥t ká»³ giao dá»‹ch/transaction nÃ o
- VÃ­ dá»¥ mapping:
  - E-commerce: "Order" = Transaction
  - Service: "Service Request" = Transaction
  - Booking: "Booking" = Transaction
  - Payment: "Payment" = Transaction
  - Approval: "Approval Request" = Transaction

**3. Resource (TÃ i nguyÃªn):**
- DÃ¹ng cho: Báº¥t ká»³ resource trong há»‡ thá»‘ng
- VÃ­ dá»¥ mapping:
  - E-commerce: "Product" = Resource
  - Service: "Service" = Resource
  - Content: "Article" = Resource
  - Media: "Image", "Video" = Resource

**4. Document (TÃ i liá»‡u/Há»“ sÆ¡):**
- DÃ¹ng cho: Báº¥t ká»³ document/há»“ sÆ¡ nÃ o
- VÃ­ dá»¥ mapping:
  - Legal: "Contract" = Document
  - HR: "Employee Record" = Document
  - Medical: "Medical Record" = Document
  - Education: "Certificate" = Document

**5. Service (Dá»‹ch vá»¥):**
- DÃ¹ng cho: Doanh nghiá»‡p dá»‹ch vá»¥
- VÃ­ dá»¥ mapping:
  - Consulting: "Consulting Service"
  - Photography: "Photography Service"
  - Education: "Course" = Service
  - Healthcare: "Medical Service"

**6. Project (Dá»± Ã¡n):**
- DÃ¹ng cho: Doanh nghiá»‡p dá»‹ch vá»¥ dá»± Ã¡n
- VÃ­ dá»¥ mapping:
  - Agency: "Client Project"
  - Construction: "Construction Project"
  - Software: "Development Project"
  - Consulting: "Consulting Project"

### ğŸ”„ Generic Workflows:

**1. CRUD Workflow (Generic):**
```
Create Entity â†’ View Entity â†’ Edit Entity â†’ Delete Entity
```

**2. Transaction Workflow (Generic):**
```
Initiate Transaction â†’ Process Transaction â†’ Complete Transaction
```

**3. Approval Workflow (Generic):**
```
Submit Request â†’ Review Request â†’ Approve/Reject Request
```

**4. Service Workflow (Generic):**
```
Request Service â†’ Process Service â†’ Deliver Service â†’ Complete Service
```

### ğŸ“‹ Generic Testing Scenarios:

**1. CRUD Testing (Generic):**
```
âœ… Táº¡o entity má»›i
âœ… Xem danh sÃ¡ch entities
âœ… Xem chi tiáº¿t entity
âœ… Sá»­a entity
âœ… XÃ³a entity
```

**2. Transaction Testing (Generic):**
```
âœ… Táº¡o transaction má»›i
âœ… Xem transaction
âœ… Update transaction status
âœ… Complete/Cancel transaction
```

**3. Navigation Testing (Generic):**
```
âœ… VÃ o trang danh sÃ¡ch
âœ… VÃ o trang chi tiáº¿t
âœ… VÃ o trang táº¡o má»›i
âœ… VÃ o trang sá»­a
âœ… VÃ o trang cÃ i Ä‘áº·t
```

**4. Form Testing (Generic):**
```
âœ… Fill form fields
âœ… Submit form
âœ… Validate form
âœ… Cancel form
âœ… Reset form
```

### ğŸ¯ Mapping theo NgÃ nh:

**E-commerce:**
- Entity = Product
- Transaction = Order
- Resource = Product

**Service Business:**
- Entity = Service Package
- Transaction = Service Request
- Resource = Service

**CRM:**
- Entity = Customer
- Transaction = Interaction
- Resource = Customer

**Booking:**
- Entity = Booking
- Transaction = Booking
- Resource = Service/Time Slot

**Project Management:**
- Entity = Project
- Transaction = Task
- Resource = Project

**Document Management:**
- Entity = Document
- Transaction = Document Processing
- Resource = Document

**âš ï¸ QUAN TRá»ŒNG:** Trong táº¥t cáº£ examples vÃ  code trong file nÃ y:
- "Entity" = Generic term - Thay tháº¿ báº±ng domain-specific term cá»§a báº¡n
- "Transaction" = Generic term - Thay tháº¿ báº±ng domain-specific term cá»§a báº¡n
- VÃ­ dá»¥: Náº¿u báº¡n lÃ m CRM â†’ "Entity" = "Customer", "Transaction" = "Interaction"

---

## MCP & Caching Configuration
- Enable MCP: YES - **ULTRA-SAFE MODE** ğŸ›¡ï¸
- Vector Cache: DISABLED
- Interactive Feedback: **ALWAYS 2 ROUNDS** (Before + After Code) âš¡
- Approach: **MAXIMUM SAFETY MODE** - Quality First
- Dual Round: MANDATORY (every task)
- **Version:** 4.0 - ULTRA-SAFE MODE (Always 2 Rounds MCP)

---

## ğŸ§° MCP TOOLS ECOSYSTEM

### **Available MCP Tools:**

**1. Interactive Feedback** (MANDATORY - AUTO-RUN)
- **Purpose:** Design & code review vá»›i user approval
- **When:** ALWAYS - Má»i task (Version 4.0)
- **Workflow:** 2 rounds (BEFORE + AFTER code)
- **Tools:** `mcp_interactive-feedback_interactive_feedback`
- **Priority:** ğŸ”´ HIGHEST (khÃ´ng bao giá» skip)

**2. Memory Service** (AUTO-RUN)
- **Purpose:** Persistent knowledge base across sessions
- **Storage:** Database (PostgreSQL, SQLite, hoáº·c database khÃ¡c - tÃ¹y vÃ o cáº¥u hÃ¬nh MCP Server)
- **Location:** Database server (local/cloud) hoáº·c file-based (SQLite) - xem config trong `~/.cursor/mcp.json`
- **When:** 
  - âœ… Store: Sau khi complete important tasks (architecture, decisions, bugs fixed)
  - âœ… Search: TrÆ°á»›c khi start similar tasks
  - âœ… Recall: Khi cáº§n context tá»« past sessions
- **Tools:** `store_memory`, `search_memory`, `recall_memory`, `update_memory`, `delete_memory`, `delete_by_tag`, `cleanup_duplicates`
- **Priority:** ğŸŸ¡ HIGH (automatic knowledge management)
- **ğŸ“ Function Name Reference (Clarification):**
  - `mcp_memory_retrieve_memory` (shorthand: `search_memory`) - Semantic search trong memories
  - `mcp_memory_recall_memory` (shorthand: `recall_memory`) - Time-based recall vá»›i natural language time expressions
  - `mcp_memory_search_by_tag` - Tag-based search
  - **Note:** Trong examples, dÃ¹ng shorthand names (`search_memory`, `recall_memory`) cho dá»… Ä‘á»c, nhÆ°ng actual tool names lÃ  `mcp_memory_*`
- **Best Practice:**
  - Tag vá»›i `[project-name, category, tech-stack]`
  - Store conclusions, NOT trivial changes
  - Search before starting complex tasks
- **Auto-Load on Session Start:**
  - âœ… **Khi AI báº¯t Ä‘áº§u lÃ m viá»‡c vá»›i project** â†’ Tá»± Ä‘á»™ng recall memories vá» project
  - âœ… **Query pattern:** `"[project-name] project [tech-stack]"`
  - âœ… **Purpose:** Hiá»ƒu context ngay tá»« Ä‘áº§u, khÃ´ng cáº§n user giáº£i thÃ­ch láº¡i project structure, tech stack, patterns
  - âœ… **Example:** Project "[YOUR_PROJECT]" â†’ Auto-query: "[YOUR_PROJECT] project [tech-stack]"
  - âœ… **How:** Tá»± Ä‘á»™ng gá»i `recall_memory()` vá»›i query pattern hoáº·c `search_by_tag([project-name])`
  - âš ï¸ **Optional:** Náº¿u khÃ´ng cÃ³ memories thÃ¬ bá» qua, tiáº¿p tá»¥c workflow bÃ¬nh thÆ°á»ng
  - ğŸ“ **Note:** Auto-load cháº¡y TRÆ¯á»šC BÆ¯á»šC 1 trong Universal Workflow
- **ğŸ§¹ Memory Cleanup Guidelines (MANDATORY):**
  - **Weekly Cleanup (AI tá»± Ä‘á»™ng):**
    - Má»—i tuáº§n: Check vÃ  xÃ³a memories cÅ© hÆ¡n 3 thÃ¡ng (náº¿u khÃ´ng cÃ²n relevant)
    - XÃ³a duplicates: DÃ¹ng `cleanup_duplicates` tool má»—i thÃ¡ng
    - Update outdated info: Khi detect thÃ´ng tin sai/outdated â†’ Update thay vÃ¬ táº¡o má»›i
  - **Cleanup khi detect outdated:**
    - Khi search memory tÃ¬m tháº¥y info outdated â†’ Tá»± Ä‘á»™ng update hoáº·c delete
    - Khi schema/architecture thay Ä‘á»•i â†’ XÃ³a hoáº·c update memories cÅ© vá» schema
    - Khi tech stack thay Ä‘á»•i â†’ Update tags vÃ  content
  - **Manual Cleanup triggers:**
    - User request: "Cleanup old memories" â†’ AI cleanup memories > 3 months
    - User request: "Remove memories about [topic]" â†’ Delete by tag
    - Before major refactor: Cleanup memories vá» architecture cÅ©
  - **Never delete without asking:**
    - âŒ KhÃ´ng tá»± Ä‘á»™ng xÃ³a memories < 1 thÃ¡ng
    - âŒ KhÃ´ng xÃ³a memories cÃ³ tag quan trá»ng (`architecture`, `decision`, `security`)
    - âœ… LuÃ´n há»i user trÆ°á»›c khi xÃ³a > 10 memories cÃ¹ng lÃºc

**3. PostgreSQL MCP Server** (INSTALLED - AUTO-TRIGGER) ğŸ˜
- **Purpose:** Comprehensive PostgreSQL database management & operations
- **Status:** âœ… **ÄÃƒ CÃ€I Äáº¶T** - Local build táº¡i `/Users/buithuan/DULIEU/Congviec/Python/mcp-servers/postgresql-mcp-server`
- **Config:** `~/.cursor/mcp.json` - Server name: `postgresql-mcp`
- **Connection:** Cáº§n PostgreSQL connection string trong config (Supabase hoáº·c local)
- **When:** Database-related tasks
  - âœ… Schema inspection & analysis
  - âœ… Query execution & optimization
  - âœ… Database management (tables, indexes, views, functions)
  - âœ… Data operations (CRUD)
  - âœ… Performance analysis
  - âœ… Relationship analysis
- **Tools:** 17 powerful tools organized into categories:
  - **Database Management:** `list_databases`, `list_schemas`, `list_tables`, `describe_table`, `list_indexes`, `list_views`, `list_functions`
  - **Query & Analysis:** `execute_sql`, `analyze_query`, `get_table_stats`
  - **Schema Management:** `get_table_schema`, `get_foreign_keys`, `get_constraints`, `get_table_relationships`
  - **Data Operations:** `insert_data`, `update_data`, `delete_data`
- **Priority:** ğŸŸ¡ HIGH (when database tasks needed)
- **ğŸš¨ AUTO-TRIGGER RULES (MANDATORY):**
  - **AI PHáº¢I tá»± Ä‘á»™ng detect vÃ  gá»i PostgreSQL MCP tools khi:**
    1. User Ä‘á» cáº­p Ä‘áº¿n: `database`, `schema`, `table`, `column`, `query`, `SQL`, `migration`, `index`, `foreign key`, `relationship`
    2. Task liÃªn quan Ä‘áº¿n: `thÃªm/xÃ³a/sá»­a column`, `táº¡o table`, `migration`, `optimize query`, `phÃ¢n tÃ­ch database`
    3. Files liÃªn quan: `schema.sql`, `migration`, `*.service.ts` (database services), `database.types.ts`
    4. Performance issues: `query cháº­m`, `optimize database`, `analyze performance`
  - **Auto-trigger workflow:**
    ```
    Step 1: Detect database keywords trong user request
    Step 2: Tá»± Ä‘á»™ng gá»i PostgreSQL MCP tools TRÆ¯á»šC KHI code:
      - list_tables (Ä‘á»ƒ xem tables hiá»‡n cÃ³)
      - get_table_schema (Ä‘á»ƒ hiá»ƒu cáº¥u trÃºc)
      - get_table_relationships (Ä‘á»ƒ hiá»ƒu dependencies)
      - get_table_stats (Ä‘á»ƒ xem statistics)
    Step 3: Include findings trong MCP Interactive Feedback Round 1
    Step 4: Code vá»›i database insights
    Step 5: Verify vá»›i execute_sql náº¿u cáº§n
    ```
  - **VÃ­ dá»¥ auto-trigger:**
    - User: "ThÃªm column phone vÃ o table clients"
      â†’ AI tá»± Ä‘á»™ng: `list_tables` â†’ `get_table_schema('clients')` â†’ `get_table_relationships('clients')`
    - User: "Query láº¥y projects cháº­m quÃ¡"
      â†’ AI tá»± Ä‘á»™ng: `execute_sql` (EXPLAIN ANALYZE) â†’ `list_indexes` â†’ `get_table_stats`
    - User: "Táº¡o table má»›i cho invoices"
      â†’ AI tá»± Ä‘á»™ng: `list_tables` â†’ Check naming conventions â†’ `get_table_schema` cá»§a tables liÃªn quan
- **Best Practice:**
  - Use for database analysis, schema inspection, query execution
  - Store important schema decisions in Memory
  - Use before making schema changes
  - Combine with Memory service Ä‘á»ƒ lÆ°u database patterns
  - **Tá»± Ä‘á»™ng gá»i tools TRÆ¯á»šC khi code** (khÃ´ng cáº§n user yÃªu cáº§u rÃµ rÃ ng)
- **Setup Required:** Cáº­p nháº­t PostgreSQL connection string trong `~/.cursor/mcp.json`

**4. Web Search** (BUILT-IN - Cursor Native) ğŸŒ
- **Purpose:** Research real-time information tá»« web
- **Tools:** `web_search` (built-in)
- **Priority:** ğŸŸ¡ MEDIUM (use when needed)
- **When:** 
  - âœ… **Latest technology updates** (2024-2025 releases, React 19, Next.js 14, etc.)
  - âœ… **Real-time latest documentation** - Cáº§n thÃ´ng tin má»›i nháº¥t vá» APIs/frameworks (vá»›i version numbers)
  - âœ… **Current best practices** - TÃ¬m best practices updated trong nÄƒm hiá»‡n táº¡i
  - âœ… **Recent bug fixes** - TÃ¬m giáº£i phÃ¡p cho issues má»›i (Stack Overflow, GitHub issues)
  - âœ… **Version compatibility** - Check compatibility vá»›i versions má»›i nháº¥t
  - âœ… **Developer queries** - Technical documentation, tutorials, examples (má»›i nháº¥t)
- **Best Practice:**
  - **Check Memory FIRST** - Don't Web Search for info already in Memory
  - Search trÆ°á»›c khi há»i user vá» unclear issues
  - Combine findings vá»›i Memory (store useful patterns/info)
  - Verify sources (official docs > Stack Overflow > blog posts)
  - Use specific keywords vá»›i version numbers vÃ  year cho better results
  - Add "latest" keyword: "React 19 latest features" not "React features"
  - Check dates: Prefer recent results (2024-2025)
  - Multiple sources: Check 2-3 sources for accuracy
  - Äá»c káº¿t quáº£ vÃ  summarize thay vÃ¬ dump toÃ n bá»™

---

### ğŸ¯ **MCP Decision Matrix**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Task Type          â”‚ MCPs to Use                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SIMPLE TASK        â”‚                                        â”‚
â”‚ (add field, typo)  â”‚ âœ… Interactive Feedback (2 rounds)    â”‚
â”‚                    â”‚ âš ï¸  Memory (if reusable pattern)      â”‚
â”‚                    â”‚ âš ï¸  Web Search (if unknown issue)â”‚
â”‚                    â”‚ âŒ PostgreSQL MCP (not needed)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MEDIUM TASK        â”‚                                        â”‚
â”‚ (feature, refactor)â”‚ âœ… Interactive Feedback (2 rounds)    â”‚
â”‚                    â”‚ âœ… Memory (search + store)            â”‚
â”‚                    â”‚ âœ… Web Search (research if needed)â”‚
â”‚                    â”‚ âš ï¸  PostgreSQL MCP (if DB changes)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ COMPLEX TASK       â”‚                                        â”‚
â”‚ (architecture,     â”‚ âœ… Interactive Feedback (2 rounds)    â”‚
â”‚  big decision)     â”‚ âœ… Memory (search past + store result)â”‚
â”‚                    â”‚ âœ… Web Search (research best practices)â”‚
â”‚                    â”‚ âœ… PostgreSQL MCP (if DB involved)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DATABASE TASK      â”‚                                        â”‚
â”‚ (schema, optimize) â”‚ âœ… Interactive Feedback (2 rounds)    â”‚
â”‚                    â”‚ âœ… Memory (store schema decisions)    â”‚
â”‚                    â”‚ âš ï¸  Web Search (if new DB patterns)â”‚
â”‚                    â”‚ âœ… PostgreSQL MCP (analyze schema/query)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend: âœ… Always use | âš ï¸ Use if applicable | âŒ Don't use
```

---

### ğŸ”„ **Integrated MCP Workflows**

#### **Workflow 1: Design Database Schema** (Complex)

```
Step 1: Search Memory
â†’ mcp_memory_retrieve_memory("database schema e-commerce") [shorthand: search_memory()]
â†’ TÃ¬m patterns, lessons learned tá»« past projects

Step 2: PostgreSQL MCP Server (If analyzing existing)
â†’ list_tables - List all tables
â†’ get_table_schema - Check current structure
â†’ get_table_relationships - Understand dependencies
â†’ get_table_stats - Analyze table sizes and row counts

Step 3: Interactive Feedback (MANDATORY)
â†’ Round 1: Approve design approach
â†’ Implement code
â†’ Round 2: Approve implementation

Step 4: Store Memory
â†’ store_memory(
    "E-commerce schema decision: PostgreSQL normalized design,
     reasoning: ACID + complex queries + proven scalability",
    tags: "ecommerce, database, postgresql, architecture"
  )
```

#### **Workflow 2: Optimize Slow API** (Medium)

```
Step 1: Search Memory
â†’ mcp_memory_recall_memory("API optimization performance") [shorthand: recall_memory()]
â†’ Found: "Previous optimization: index + caching pattern"

Step 2: PostgreSQL MCP Server (Analyze bottleneck)
â†’ execute_sql - Run EXPLAIN ANALYZE queries
â†’ analyze_query - Analyze query performance
â†’ list_indexes - Check existing indexes
â†’ get_table_stats - Analyze table statistics

Step 3: Interactive Feedback (MANDATORY)
â†’ Round 1: Approve optimization approach (data-driven)
â†’ Round 2: Approve implementation

Step 4: Store Memory
â†’ store_memory(
    "API optimization pattern: profile â†’ index â†’ cache â†’ measure",
    tags: "performance, postgresql, api, optimization"
  )
```

#### **Workflow 3: Add Simple Field** (Simple)

```
Step 1: NO Memory search (trivial task)

Step 2: Interactive Feedback ONLY (MANDATORY)
â†’ Round 1: Approve design (add field to schema + API + UI)
â†’ Round 2: Approve implementation

Step 4: NO Memory store (not worth storing)
```

---

### âš¡ **MCP Best Practices**

#### **Memory Service:**
- **âœ… DO:**
  - Tag consistently: `[project, category, technology]`
  - Store decisions & reasoning (WHY, not just WHAT)
  - Search before similar tasks
  - Update memories when approaches change
- **âŒ DON'T:**
  - Store trivial changes (add field, fix typo)
  - Use generic tags (tag: "code" â†’ useless)
  - Duplicate similar memories
  - Forget to tag with project name

#### **Sequential Thinking:**
- **âœ… DO:**
  - Use for complex decisions (architecture, trade-offs)
  - Clear history when switching topics
  - Combine with Memory (save Stage 5 conclusion)
  - Generate summary for documentation
- **âŒ DON'T:**
  - Use for simple tasks (waste time)
  - Skip stages (defeats the purpose)
  - Run multiple analyses in parallel (confusing)
  - Forget to clear history between topics

#### **PostgreSQL MCP Server:**
- **âœ… DO:**
  - **Tá»± Ä‘á»™ng detect** database keywords trong user request
  - **Tá»± Ä‘á»™ng gá»i tools TRÆ¯á»šC KHI code** khi detect database-related tasks
  - Use for database schema inspection, query execution, analysis
  - Use specific tools (17 available: list_tables, execute_sql, get_table_schema, etc.)
  - Store important schema decisions in Memory
  - Use before making schema changes Ä‘á»ƒ hiá»ƒu dependencies
  - Combine vá»›i Memory service Ä‘á»ƒ lÆ°u database patterns
  - Include database analysis results trong MCP Interactive Feedback proposal
- **âŒ DON'T:**
  - Wait for user to explicitly request database analysis (auto-detect vÃ  call!)
  - Use without PostgreSQL connection string configured
  - Execute destructive queries without backup
  - Ignore foreign key relationships when modifying schema
  - Forget to check table statistics before optimization
  - Skip database analysis when task clearly involves database changes

---

### ğŸš¨ **MCP Coordination Rules**

**Priority Order (When Multiple MCPs Apply):**
```
0. Memory Auto-Load (BEFORE ANYTHING - Session Start)
   â†’ Tá»± Ä‘á»™ng recall project memories khi detect project context
   â†’ Hiá»ƒu project structure, tech stack, patterns ngay tá»« Ä‘áº§u
   â†’ Query: "[project-name] project [tech-stack]" hoáº·c search_by_tag([project-name])
   â†’ Náº¿u khÃ´ng cÃ³ memories â†’ Bá» qua, tiáº¿p tá»¥c workflow

1. Interactive Feedback (ALWAYS FIRST)
   â†’ Approve approach before any other MCP

2. Memory Search (BEFORE analysis)
   â†’ Reuse knowledge before reinventing

3. Web Search (IF needed - research unknown issues)
   â†’ Find real-time info, solutions, best practices
   â†’ Use proactively when info not in Memory

4. PostgreSQL MCP Server (DATA for decisions - if DB involved)
   â†’ **AUTO-TRIGGER:** Tá»± Ä‘á»™ng gá»i khi detect database keywords
   â†’ Schema inspection, query execution, real metrics
   â†’ Use for database analysis, optimization, schema changes
   â†’ Gá»i TRÆ¯á»šC MCP Round 1 Ä‘á»ƒ gather database info

5. Interactive Feedback Round 2 (ALWAYS LAST)
   â†’ Approve final implementation

6. Memory Store (AFTER success)
   â†’ Save learnings for future (including Brave Search findings)
```

**Avoid Conflicts:**
- âŒ Don't skip Interactive Feedback for "speed"
- âŒ Don't store every trivial change in Memory
- âŒ Don't use PostgreSQL MCP without connection string configured
- âŒ Don't Web Search for info already in Memory (check Memory first!)
- âœ… **Tá»± Ä‘á»™ng gá»i PostgreSQL MCP tools** khi detect database keywords (khÃ´ng cáº§n user yÃªu cáº§u!)

---

## ğŸš¨ VERSION 4.0 - ULTRA-SAFE MODE (Always 2 Rounds MCP)

### âš¡ **GOLDEN RULE: Every Task = 2 Rounds MCP Feedback**

```
ğŸ›¡ï¸ ULTRA-SAFE APPROACH - MAXIMUM SAFETY:

Má»ŒI TASK (100%) â†’ 2 ROUNDS MCP:

ğŸ“‹ ROUND 1 (BEFORE CODE):
- AI phÃ¢n tÃ­ch task
- Äá» xuáº¥t approach chi tiáº¿t
- ğŸš¨ Gá»ŒI MCP Feedback
- â¸ï¸ Äá»£i user approve design

ğŸ“‹ ROUND 2 (AFTER CODE):  
- AI implement theo approval
- Show actual code changes
- ğŸš¨ Gá»ŒI MCP Feedback láº§n 2
- â¸ï¸ Äá»£i user approve code
- Done âœ…

ğŸš¨ SPECIAL RULE khi user xÃ¡c nháº­n:
User: "Äá»“ng Ã½" / "OK" / "LÃ m Ä‘i" / "ÄÆ°á»£c"
â†’ AI: "ÄÆ°á»£c! Äá»ƒ tÃ´i gá»i MCP Feedback ROUND 1..."
â†’ [Gá»ŒI MCP ROUND 1]
â†’ â¸ï¸ Äá»£i approval
â†’ [Code]
â†’ [Gá»ŒI MCP ROUND 2]  
â†’ â¸ï¸ Äá»£i approval láº§n 2
â†’ Done!

âœ… BENEFITS:
- 100% visibility - User biáº¿t má»i thá»© BEFORE VÃ€ AFTER code
- Maximum safety - Review cáº£ design VÃ€ implementation
- Zero surprises - KhÃ´ng cÃ³ unexpected changes
- Better quality - Catch issues á»Ÿ cáº£ 2 stages (design + code)
- Full control - User approve má»i bÆ°á»›c
```

### ğŸ“ **Reminder Prompts (User cÃ³ thá»ƒ dÃ¹ng):**

Náº¿u AI khÃ´ng tá»± Ä‘á»™ng gá»i MCP, user cÃ³ thá»ƒ nháº¯c:

**Option 1: Nháº¯c nháº¹ nhÃ ng:**
```
"Nhá»› Ã¡p dá»¥ng Version 4.0 - ULTRA-SAFE MODE nhÃ©!"
```

**Option 2: Force trigger:**
```
"Please follow .cursorrules - call MCP 2 rounds"
```

**Option 3: Reminder ngáº¯n:**
```
"MCP 2 rounds?"
```

**Option 4: Explicit request:**
```
"Theo Version 4.0, má»i task cáº§n 2 rounds MCP Feedback"
```

---

### ğŸ“‹ **3 MODES SYSTEM:**

**MODE 1: NORMAL (First Attempt) - 75% cases**
- Trigger: Láº§n Ä‘áº§u vá»›i task/issue
- MCP Rounds: **2 (BEFORE + AFTER code)** - Version 4.0 ULTRA-SAFE MODE
- Flow: Analyze â†’ MCP R1 â†’ Wait â†’ Code â†’ MCP R2 â†’ Wait â†’ Done

**MODE 2: REPEATED (Second Attempt) - 20% cases**
- Trigger: ÄÃ£ lÃ m 1 láº§n nhÆ°ng váº«n chÆ°a xong
- MCP Rounds: **2 (BEFORE + AFTER code)**
- Flow: Analyze failure â†’ MCP R1 â†’ Wait â†’ Code â†’ MCP R2 â†’ Wait â†’ Done

**MODE 3: DEBUG PROTOCOL (Third+ Attempt) - 5% cases** ğŸ”¥
- Trigger: ÄÃ£ lÃ m 2 láº§n nhÆ°ng VáºªN CHÆ¯A GIáº¢I QUYáº¾T
- MCP Rounds: **3 (BEFORE + DEBUG ANALYSIS + CLEANUP)**
- Flow: Deep analysis â†’ MCP R1 â†’ Add debug logs â†’ Test â†’ MCP R2 â†’ Fix â†’ MCP R3 â†’ Remove logs â†’ Done

### ğŸ¯ **AUTO-DETECTION MECHANISM FOR MODE 3:**

AI PHáº¢I tá»± Ä‘á»™ng nháº­n biáº¿t khi nÃ o trigger MODE 3:

```markdown
## ğŸ” AUTO-DETECTION RULES:

### Internal Tracking (AI MUST maintain):
For EVERY issue, track:
- issue_id: string (unique identifier, e.g., "email_validation_bug")
- attempt_count: number (starts at 0)
- previous_approaches: string[] (list of approaches tried)
- previous_results: "success" | "failed"
- current_understanding: string (what we learned so far)

### Detection Logic:
When attempt_count >= 2 AND previous_results = "failed":
â†’ AUTO-TRIGGER MODE 3 (DEBUG PROTOCOL)

### User Communication:
AI MUST say to user:
"âš ï¸ 3-STRIKE RULE TRIGGERED!
This is attempt #3 for issue '[issue_id]'
Previous attempts:
1. [approach 1] â†’ Failed: [reason]
2. [approach 2] â†’ Failed: [reason]

Applying DEBUG PROTOCOL with comprehensive logging..."

### Benefits:
- No manual counting needed
- Automatic escalation for stuck issues
- Consistent MODE 3 protocol application
- Better debugging with full context
```

---

### ğŸ¯ **SIMPLE WORKFLOW:**

```
EVERY Task:
1. Answer 4 questions:
   Q1: Láº§n Ä‘áº§u? Láº§n 2? Láº§n 3+? â†’ MODE 1 / 2 / 3
   Q2: Files affected? â†’ List
   Q3: Notable points? â†’ Risks/Notes
   Q4: (If MODE 3) Previous attempts? â†’ What failed & why
   
2. ğŸš¨ CALL MCP (ALWAYS!)
   - Show detailed proposal
   - â¸ï¸ WAIT for approval
   - âŒ NEVER code before approval

3. Implement after approval

4. MODE 1: ğŸš¨ CALL MCP Round 2 (code review) - Version 4.0 ULTRA-SAFE MODE
   MODE 2: ğŸš¨ CALL MCP Round 2 (code review)
   MODE 3: ğŸš¨ CALL MCP Round 2 (debug analysis)
   - Show results/logs
   - â¸ï¸ WAIT for approval

5. MODE 3 only: ğŸš¨ CALL MCP Round 3 (cleanup)
   - Confirm issue solved
   - Request permission to remove logs
   - â¸ï¸ WAIT for user: "Remove debug logs?"
   - After confirmation: Clean up

6. Done âœ…
```

### âœ… **WHY ALWAYS MCP?**

1. **Zero Surprises** - User knows everything
2. **Better Quality** - Catch issues early (cheap!)
3. **User Control** - Approve every change
4. **ROI 10-20x** - Small cost (2-5 min) â†’ Big savings (avoid 30-120 min refactors)

### âŒ **BIGGEST MISTAKE:**

```
âŒ "Task nÃ y Ä‘Æ¡n giáº£n, skip MCP"
âŒ "Chá»‰ sá»­a typo thÃ´i, khÃ´ng cáº§n"
âŒ "TÃ´i cháº¯c cháº¯n rá»“i, lÃ m luÃ´n"

â†’ WRONG! Version 4.0 = ALWAYS 2 ROUNDS MCP!
```

---

## ğŸš€ VERSION 3.0 - ALWAYS MCP MODE (ULTRA-SAFE)

### ğŸ›¡ï¸ **CORE PHILOSOPHY: "Review Everything, Miss Nothing"**

**Triáº¿t lÃ½ má»›i:**
- âœ… **Má»ŒI task Ä‘á»u qua MCP Feedback** - KhÃ´ng cÃ³ exceptions!
- âœ… **Lá»—i nhá», lá»—i lá»›n, feature nhá», feature lá»›n** â†’ Táº¥t cáº£ MCP
- âœ… **Dá»± Ã¡n lá»›n hay nhá»** â†’ KhÃ´ng quan trá»ng, váº«n MCP
- âœ… **Maximum safety** â†’ KhÃ´ng bao giá» skip review

**Táº¡i sao ALWAYS MCP?**
1. ğŸ¯ **Catch má»i issue sá»›m** - Ngay cáº£ lá»—i nhá» cÃ³ thá»ƒ cÃ³ big impact
2. ğŸ§  **User cÃ³ context Ä‘áº§y Ä‘á»§** - Biáº¿t AI Ä‘ang lÃ m gÃ¬ má»i lÃºc
3. ğŸ¤ **Collaboration tá»‘t hÆ¡n** - User tham gia vÃ o má»i quyáº¿t Ä‘á»‹nh
4. ğŸ“š **Learning opportunity** - Cáº£ AI vÃ  User Ä‘á»u há»c tá»« má»i task
5. ğŸ›¡ï¸ **Zero surprise** - KhÃ´ng cÃ³ unexpected changes
6. âš¡ **Better quality** - Review trÆ°á»›c = Less bugs sau

---

### ğŸ¯ **1. TWO-MODE SYSTEM (Simplified)**

AI chá»‰ cáº§n phÃ¢n biá»‡t 2 modes:

```markdown
## MODE 1: NORMAL TASK (First Attempt)
â†’ 2 ROUNDS MCP: BEFORE + AFTER code (Version 4.0 ULTRA-SAFE MODE)

Flow:
1. Äá»c yÃªu cáº§u user
2. PhÃ¢n tÃ­ch task (complexity, impact, files affected)
3. ğŸš¨ ROUND 1 MCP: Design Review (BEFORE code)
   - Äá» xuáº¥t approach
   - List files sáº½ thay Ä‘á»•i
   - Explain reasoning
4. â¸ï¸ Äá»¢I user approval design
5. Implement theo feedback
6. ğŸš¨ ROUND 2 MCP: Code Review (AFTER code)
   - Show actual implementation
   - Verify logic correctness
   - Check edge cases
7. â¸ï¸ Äá»¢I user approval code
8. Done âœ…

Ãp dá»¥ng cho:
- âœ… Feature má»›i (lá»›n hoáº·c nhá»)
- âœ… Bug fixes (lá»›n hoáº·c nhá»)
- âœ… Refactoring
- âœ… Má»i thá»© láº§n Ä‘áº§u lÃ m

## MODE 2: REPEATED ISSUE (Second+ Attempt)
â†’ 2 ROUNDS MCP: BEFORE + AFTER code

Trigger: CÃ¹ng má»™t váº¥n Ä‘á» Ä‘Ã£ fix 1 láº§n nhÆ°ng CHÆ¯A GIáº¢I QUYáº¾T

Flow:
1. Nháº­n biáº¿t: "ÄÃ¢y lÃ  láº§n thá»© 2 vá»›i cÃ¹ng issue"
2. ğŸš¨ ROUND 1 MCP: Design Review (BEFORE code)
   - PhÃ¢n tÃ­ch sÃ¢u hÆ¡n
   - Táº¡i sao láº§n trÆ°á»›c failed?
   - Approach má»›i khÃ¡c gÃ¬?
   - Root cause analysis
3. â¸ï¸ Äá»¢I user approval approach
4. Implement carefully vá»›i approach má»›i
5. ğŸš¨ ROUND 2 MCP: Code Review (AFTER code)
   - Show actual implementation
   - Verify logic correctness
   - Check edge cases
6. â¸ï¸ Äá»¢I user approval code
7. Deploy/Commit
8. Done âœ…

Ãp dá»¥ng cho:
- âœ… Bug váº«n cÃ²n sau fix láº§n 1
- âœ… Feature chÆ°a hoáº¡t Ä‘á»™ng Ä‘Ãºng sau láº§n 1
- âœ… User bÃ¡o "váº«n bá»‹ lá»—i"
- âœ… Test case váº«n fail sau fix láº§n 1

## MODE 3: DEBUG PROTOCOL (Third+ Attempt - 3-Strike Rule) ğŸ”¥
â†’ 3 ROUNDS: BEFORE + DEBUG LOGGING + AFTER

Trigger: ÄÃ£ lÃ m 2 láº§n nhÆ°ng VáºªN CHÆ¯A GIáº¢I QUYáº¾T (3rd attempt)

Flow:
1. Nháº­n biáº¿t: "ÄÃ¢y lÃ  láº§n thá»© 3! Critical issue!"
2. ğŸš¨ ROUND 1 MCP: Root Cause Deep Dive (BEFORE code)
   - Chi tiáº¿t 2 attempts trÆ°á»›c (what/why failed)
   - Root cause hypothesis (theory má»›i)
   - Debug strategy (cÃ¡ch verify)
   - Logging plan (track execution flow)
3. â¸ï¸ Äá»¢I user approval strategy
4. Implement vá»›i COMPREHENSIVE DEBUG LOGGING:
   - Add detailed console.log/print statements
   - Log function entry/exit
   - Log variable states at key points
   - Log API requests/responses
   - Log error stack traces
   - Track execution flow
5. Test vÃ  thu tháº­p logs
6. ğŸš¨ ROUND 2 MCP: Debug Analysis (AFTER testing)
   - Share all logs collected
   - Point out suspicious patterns
   - Propose final fix based on logs
7. â¸ï¸ Äá»¢I user approval final fix
8. Implement final fix
9. Test vÃ  verify
10. ğŸš¨ ROUND 3 MCP: Cleanup Confirmation
    - Confirm issue resolved
    - Request permission to remove debug logs
    - â¸ï¸ Äá»¢I user confirmation: "Issue solved? Remove logs?"
11. After user confirms: Remove all debug logging code
12. Done âœ…

Ãp dá»¥ng cho:
- âœ… Bug váº«n tá»“n táº¡i sau 2 attempts
- âœ… Mysterious bugs khÃ´ng rÃµ nguyÃªn nhÃ¢n
- âœ… User frustrated: "Sao váº«n chÆ°a fix Ä‘Æ°á»£c?"
- âœ… Complex issues cáº§n deep investigation

**Debug Logging Requirements:**
- âœ… Logs PHáº¢I cÃ³ timestamps
- âœ… Logs PHáº¢I cÃ³ context (function name, line number)
- âœ… Logs PHáº¢I cÃ³ variable values
- âœ… Logs PHáº¢I dá»… Ä‘á»c (format clear)
- âœ… Logs PHáº¢I comprehensive (cover all paths)

**Cleanup Protocol:**
- âŒ KHÃ”NG tá»± Ä‘á»™ng xÃ³a logs
- âœ… PHáº¢I Ä‘á»£i user confirm "Issue solved"
- âœ… SAU ÄÃ“ má»›i remove debug code
- âœ… Keep only critical error handling logs
```

---

### ğŸ” **2. TASK ANALYSIS (Simplified - No Complex Scoring)**

Thay vÃ¬ risk score phá»©c táº¡p, AI CHá»ˆ cáº§n tráº£ lá»i 3 cÃ¢u há»i:

```markdown
## 3 CRITICAL QUESTIONS:

### Q1: ÄÃ¢y cÃ³ pháº£i láº§n Ä‘áº§u lÃ m task nÃ y?
- YES â†’ MODE 1 (2 rounds MCP BEFORE+AFTER) - Version 4.0 ULTRA-SAFE MODE
- NO (Ä‘Ã£ lÃ m 1+ láº§n) â†’ MODE 2 (2 rounds MCP BEFORE+AFTER)

### Q2: Task nÃ y thay Ä‘á»•i nhá»¯ng gÃ¬?
- Files affected: [List]
- Database: [YES/NO - details]
  - ğŸš¨ Náº¿u YES â†’ Tá»° Äá»˜NG gá»i PostgreSQL MCP tools TRÆ¯á»šC KHI code:
    * list_tables (xem tables hiá»‡n cÃ³)
    * get_table_schema (hiá»ƒu cáº¥u trÃºc table)
    * get_table_relationships (hiá»ƒu foreign keys)
    * get_table_stats (statistics náº¿u cáº§n)
- API: [YES/NO - details]
- UI: [YES/NO - details]
- Logic: [YES/NO - details]

### Q3: CÃ³ Ä‘iá»ƒm nÃ o user cáº§n biáº¿t trÆ°á»›c?
- Breaking changes: [YES/NO - what]
- Data migration: [YES/NO - plan]
- Dependencies: [YES/NO - what]
- Risks: [List if any]
```

### ğŸš¨ **AUTO-DETECTION: Database-Related Tasks**

**AI PHáº¢I tá»± Ä‘á»™ng nháº­n biáº¿t vÃ  trigger PostgreSQL MCP khi detect:**

**Keywords/Phrases:**
- Database/Schema: `database`, `schema`, `table`, `column`, `field`, `migration`, `alter table`, `create table`
- Query: `query`, `SQL`, `SELECT`, `INSERT`, `UPDATE`, `DELETE`, `EXPLAIN`, `optimize query`
- Performance: `slow query`, `performance`, `index`, `optimize database`
- Relationships: `foreign key`, `relationship`, `join`, `cascade`
- Data: `seed`, `import`, `export`, `backup`

**File Patterns:**
- `*.sql`, `schema.sql`, `migration*`, `*.service.ts` (database services)
- `database.types.ts`, `models.ts`, `entities.ts`

**Auto-Action khi detect:**
1. **TRÆ¯á»šC MCP Round 1:** Tá»± Ä‘á»™ng gá»i PostgreSQL MCP tools Ä‘á»ƒ gather database info
2. **Include findings** trong MCP Interactive Feedback proposal
3. **Use insights** Ä‘á»ƒ code chÃ­nh xÃ¡c hÆ¡n

---

### ğŸ¯ **3. MCP FEEDBACK TEMPLATE (Simplified)**

**For MODE 1 (Normal - BEFORE code):**

```xml
<invoke name="mcp_interactive-feedback_interactive_feedback">
  <parameter name="project_directory">[YOUR_ABSOLUTE_PROJECT_PATH]</parameter>
  <parameter name="summary">
## CÃ”NG VIá»†C: [TÃªn task]

### CHáº¾ Äá»˜: Láº§n Ä‘áº§u
**MCP VÃ’NG:** 1/1 (TRÆ¯á»šC KHI CODE)

### TÃ”I Sáº¼ LÃ€M GÃŒ:
[Giáº£i thÃ­ch rÃµ rÃ ng cÃ´ng viá»‡c]

### CÃCH LÃ€M:
[MÃ´ táº£ cÃ¡ch giáº£i quyáº¿t]

### FILE Sáº¼ THAY Äá»”I:
- File 1: [Ä‘Æ°á»ng dáº«n] - [thay Ä‘á»•i gÃ¬]
- File 2: [Ä‘Æ°á»ng dáº«n] - [thay Ä‘á»•i gÃ¬]
- ...

### CHI TIáº¾T Ká»¸ THUáº¬T:
**Backend:**
- [Thay Ä‘á»•i náº¿u cÃ³]

**Frontend:**
- [Thay Ä‘á»•i náº¿u cÃ³]

**Database:**
- [Thay Ä‘á»•i náº¿u cÃ³]

### ÄIá»‚M Cáº¦N LÆ¯U Ã:
- ThÆ° viá»‡n phá»¥ thuá»™c: [Náº¿u cÃ³]
- áº¢nh hÆ°á»Ÿng: [Náº¿u cÃ³]
- Migration: [Náº¿u cÃ³]
- Rá»§i ro: [Náº¿u cÃ³]

### CÃC CÃCH KHÃC TÃ”I ÄÃƒ XEM XÃ‰T:
- CÃ¡ch A: [MÃ´ táº£] - Táº¡i sao khÃ´ng chá»n?
- CÃ¡ch B: [MÃ´ táº£] - Táº¡i sao chá»n cÃ¡ch nÃ y?

### CÃ‚U Há»I CHO Báº N:
[CÃ¡c Ä‘iá»ƒm cáº§n lÃ m rÃµ]
  </parameter>
</invoke>
```

**For MODE 2 (Repeated - BEFORE code):**

```xml
<parameter name="summary">
## CÃ”NG VIá»†C: [TÃªn task] - Láº¦N THá»¨ 2

### CHáº¾ Äá»˜: Váº¤N Äá»€ Láº¶P Láº I âš ï¸
**MCP VÃ’NG:** 1/2 (TRÆ¯á»šC KHI CODE - Xem xÃ©t thiáº¿t káº¿)

### Láº¦N TRÆ¯á»šC ÄÃƒ LÃ€M GÃŒ:
**ÄÃ£ thá»­:**
- Láº§n 1: [LÃ m gÃ¬]
  
**Káº¿t quáº£:**
- [Váº«n lá»—i / khÃ´ng hoáº¡t Ä‘á»™ng]
  
**Táº¡i sao tháº¥t báº¡i:**
- NguyÃªn nhÃ¢n: [PhÃ¢n tÃ­ch sÃ¢u]

### CÃCH Má»šI:
**KhÃ¡c gÃ¬ láº§n trÆ°á»›c:**
[Giáº£i thÃ­ch chiáº¿n lÆ°á»£c má»›i]

**Táº¡i sao cÃ¡ch nÃ y nÃªn hiá»‡u quáº£:**
[LÃ½ do]

### FILE Sáº¼ THAY Äá»”I:
[Giá»‘ng nhÆ° MODE 1]

### BÃ€I Há»ŒC Tá»ª THáº¤T Báº I:
- BÃ i há»c 1: [ÄÃ£ há»c Ä‘Æ°á»£c gÃ¬]
- BÃ i há»c 2: [ÄÃ£ bá» sÃ³t gÃ¬]

### Káº¾ HOáº CH KIá»‚M TRA:
- CÃ¡ch test: [CÃ¡c bÆ°á»›c]
- TiÃªu chÃ­ thÃ nh cÃ´ng: [RÃµ rÃ ng]

### YÃŠU Cáº¦U:
Xin vui lÃ²ng xem xÃ©t CÃCH Má»šI nÃ y trÆ°á»›c khi tÃ´i code.
Náº¿u tháº¥y váº¥n Ä‘á» gÃ¬, vui lÃ²ng chá»‰ ra ngay Ä‘á»ƒ tiáº¿t kiá»‡m thá»i gian!
</parameter>
```

**For MODE 2 (Repeated - AFTER code):**

```xml
<parameter name="summary">
## CÃ”NG VIá»†C: [TÃªn task] - Láº¦N THá»¨ 2

### CHáº¾ Äá»˜: Váº¤N Äá»€ Láº¶P Láº I âš ï¸
**MCP VÃ’NG:** 2/2 (SAU KHI CODE - Xem xÃ©t code)

### CODE ÄÃƒ VIáº¾T:
**File Ä‘Ã£ thay Ä‘á»•i:**
- File 1: [Ä‘Æ°á»ng dáº«n]
  - Thay Ä‘á»•i: [TÃ³m táº¯t]
  - DÃ²ng quan trá»ng: [Sá»‘ dÃ²ng hoáº·c Ä‘oáº¡n code]
  
- File 2: [Ä‘Æ°á»ng dáº«n]
  - Thay Ä‘á»•i: [TÃ³m táº¯t]

### ÄIá»‚M Ná»”I Báº¬T TRONG CODE:
[Hiá»‡n pháº§n quan trá»ng cá»§a code]

### KIá»‚M TRA:
- [ ] Logic Ä‘Ãºng nhÆ° thiáº¿t káº¿ Ä‘Ã£ duyá»‡t
- [ ] ÄÃ£ xá»­ lÃ½ cÃ¡c trÆ°á»ng há»£p Ä‘áº·c biá»‡t
- [ ] ÄÃ£ xá»­ lÃ½ lá»—i
- [ ] Tests (náº¿u cÃ³)

### KHÃC Vá»šI Káº¾ HOáº CH:
[Náº¿u cÃ³ thay Ä‘á»•i so vá»›i VÃ²ng 1]

### Sáº´N SÃ€NG TRIá»‚N KHAI?
Xin vui lÃ²ng xem xÃ©t code thá»±c táº¿ vÃ  xÃ¡c nháº­n an toÃ n Ä‘á»ƒ tiáº¿p tá»¥c.
</parameter>
```

---

### ğŸ• **4. TIMING STRATEGY (Crystal Clear)**

```markdown
## WHEN TO CALL MCP:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DECISION TREE - ULTRA SIMPLE                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Task má»›i
   â†“
ÄÃ¢y cÃ³ pháº£i láº§n Ä‘áº§u vá»›i task/issue nÃ y?
   â†“
YES â†’ MODE 1
   â”œâ”€ ğŸš¨ Gá»ŒI MCP TRÆ¯á»šC KHI CODE (Round 1) + SAU KHI CODE (Round 2) - Version 4.0 ULTRA-SAFE MODE
   â”œâ”€ â¸ï¸ Äá»£i approval
   â”œâ”€ Code theo approval
   â””â”€ Done âœ…

NO (Ä‘Ã£ lÃ m â‰¥1 láº§n rá»“i) â†’ MODE 2
   â”œâ”€ ğŸš¨ ROUND 1: Gá»ŒI MCP TRÆ¯á»šC KHI CODE
   â”œâ”€ â¸ï¸ Äá»£i approval design
   â”œâ”€ Code carefully
   â”œâ”€ ğŸš¨ ROUND 2: Gá»ŒI MCP SAU KHI CODE
   â”œâ”€ â¸ï¸ Äá»£i approval implementation
   â””â”€ Done âœ…

## WHY ALWAYS BEFORE?

**BEFORE code = CHEAP to change**
- 5-10 phÃºt discussion
- No code wasted
- Clear direction

**AFTER code = EXPENSIVE to change**
- 60+ phÃºt Ä‘Ã£ code
- Náº¿u sai approach â†’ refactor láº¡i
- TÃ¢m lÃ½ khÃ´ng muá»‘n Ä‘á»•i

## WHY AFTER for MODE 2?

**Khi Ä‘Ã£ fail 1 láº§n:**
- Cáº§n verify implementation chi tiáº¿t
- User muá»‘n xem actual code
- Double-check logic correctness
- Catch subtle bugs

â†’ Worth the extra round!
```

---

### ğŸ“ **5. EXAMPLES (Real Scenarios)**

[Examples giá»‘ng nhÆ° trong .cursorrules chÃ­nh - bá» qua Ä‘á»ƒ tiáº¿t kiá»‡m space]

---

### âš¡ **6. BENEFITS OF ALWAYS MCP**

[Benefits section giá»‘ng nhÆ° trong .cursorrules chÃ­nh]

---

### ğŸ¯ **AUTO RISK SCORE CALCULATOR** (LEGACY - Kept for Reference)

AI PHáº¢I tá»± Ä‘á»™ng tÃ­nh Risk Score TRÆ¯á»šC KHI phÃ¢n loáº¡i task:

```python
# Risk Score Formula
Risk Score = (Complexity Ã— Impact Ã— Uncertainty) / Experience

Complexity (1-5):
  1 = Single file, simple logic
  2 = 2-3 files, straightforward
  3 = 4-6 files, moderate logic
  4 = 7-10 files, complex logic
  5 = 10+ files, very complex

Impact (1-5):
  1 = No business impact, cosmetic
  2 = Minor feature, low risk
  3 = Important feature, moderate risk
  4 = Critical feature, high risk
  5 = Core system, security, payment

Uncertainty (1-5):
  1 = Done many times, very familiar
  2 = Done before, familiar
  3 = Some experience, moderate confidence
  4 = New territory, low confidence
  5 = Never done, no experience

Experience (1-5):
  1 = Beginner with this tech
  2 = Junior level
  3 = Mid level
  4 = Senior level
  5 = Expert level

RISK LEVEL MAPPING:
- Risk Score < 5:    ğŸŸ¢ SIMPLE (No MCP)
- Risk Score 5-10:   ğŸŸ¡ SMALL (Optional MCP)
- Risk Score 10-20:  ğŸ”µ MEDIUM (MANDATORY MCP)
- Risk Score > 20:   ğŸ”´ CRITICAL (ABSOLUTELY MANDATORY MCP)
```

**Example Calculations:**

```
Task: "ThÃªm field email vÃ o Entity model"
- Complexity: 2 (schema, API, frontend = 3 files)
- Impact: 1 (no business impact)
- Uncertainty: 1 (done many times)
- Experience: 4 (senior level)
â†’ Risk Score = (2Ã—1Ã—1)/4 = 0.5 â†’ ğŸŸ¢ SIMPLE â†’ NO MCP

Task: "Implement VNPay Payment Gateway"
- Complexity: 4 (7+ files: gateway, webhook, API, UI, etc.)
- Impact: 5 (payment = critical!)
- Uncertainty: 4 (never done with VNPay)
- Experience: 3 (mid level)
â†’ Risk Score = (4Ã—5Ã—4)/3 = 26.7 â†’ ğŸ”´ CRITICAL â†’ MANDATORY MCP

Task: "Redesign Dashboard vá»›i 3 tabs"
- Complexity: 3 (6 files: page, 3 tabs, 2 charts)
- Impact: 3 (important feature)
- Uncertainty: 2 (done similar before)
- Experience: 4 (senior level)
â†’ Risk Score = (3Ã—3Ã—2)/4 = 4.5 â†’ ğŸŸ¡ SMALL
BUT: >3 files rule â†’ Override to ğŸ”µ MEDIUM â†’ MANDATORY MCP
```

**AI MUST:**
1. Calculate Risk Score for EVERY task before starting
2. Show calculation in response to user
3. Use score + 6 rules to determine final level
4. Override to higher level if specific rules match

---

### ğŸ“‹ **2. STRUCTURED MCP FEEDBACK TEMPLATE (Version 2.0)**

Khi gá»i MCP cho tasks ğŸ”µğŸ”´, PHáº¢I dÃ¹ng format cÃ³ cáº¥u trÃºc nÃ y:

```xml
<invoke name="mcp_interactive-feedback_interactive_feedback">
  <parameter name="project_directory">[YOUR_ABSOLUTE_PROJECT_PATH]</parameter>
  <parameter name="summary">
## TASK: [Task name/title]

### 1. CONTEXT
- Type: [Feature/Bugfix/Refactor/Security/Performance]
- Risk Level: [ğŸŸ¢ğŸŸ¡ğŸ”µğŸ”´] (Risk Score: X.X)
- Affected Modules: [List modules]
- Dependencies: [List dependencies náº¿u cÃ³]

### 2. PROPOSED APPROACH
- Architecture: [High-level design]
- Files to Create: [List new files]
- Files to Modify: [List existing files]
- Database Changes: [Migration náº¿u cÃ³]
- API Changes: [Breaking changes náº¿u cÃ³]
- Performance Impact: [Expected impact]

### 3. TECHNICAL DETAILS
- Backend Changes:
  * [Detail 1]
  * [Detail 2]
- Frontend Changes:
  * [Detail 1]
  * [Detail 2]
- Testing Strategy:
  * [Test plan]

### 4. RISK ASSESSMENT
- Security Risks: [Liá»‡t kÃª hoáº·c "None identified"]
- Performance Concerns: [Náº¿u cÃ³]
- Breaking Changes: [Náº¿u cÃ³]
- Rollback Plan: [How to undo if fails]

### 5. ALTERNATIVES CONSIDERED
- Option A: [Brief description] - Pros/Cons
- Option B: [Brief description] - Pros/Cons
- Recommended: [Selected option] because [reason]

### 6. VALIDATION CRITERIA
- [ ] Functionality works as expected
- [ ] No security vulnerabilities
- [ ] Performance acceptable (<Xms response time)
- [ ] Tests pass (unit + integration)
- [ ] Documentation updated
- [ ] No breaking changes (or documented)
  </parameter>
</invoke>
```

**So vá»›i format cÅ© (simple):**
- CÅ©: `summary: "One-line description"` â†’ Thiáº¿u chi tiáº¿t
- Má»›i: 6 sections Ä‘áº§y Ä‘á»§ â†’ RÃµ rÃ ng, dá»… review

---

### ğŸ” **3. PRE-FLIGHT CHECKLIST - Tá»° Äá»˜NG**

TrÆ°á»›c KHI viáº¿t code, AI PHáº¢I tá»± check vÃ  SHOW:

```markdown
## PRE-FLIGHT CHECKLIST

### Step 1: Risk Assessment
- [ ] Calculate Risk Score: [Show calculation]
- [ ] Task Level: [ğŸŸ¢/ğŸŸ¡/ğŸ”µ/ğŸ”´]
- [ ] MCP Required: [YES/NO]

### Step 2: Early Error Detection (4 Risks)
1. **Logic Risk:** [YES/NO - Explanation]
   - Affects business logic/pricing/payment/workflow?
   
2. **Data Structure Risk:** [YES/NO - Explanation]
   - Changes schema/model/migration?
   
3. **Security Risk:** [YES/NO - Explanation]
   - Involves auth/password/token/API keys/payment?
   
4. **Error Handling Risk:** [YES/NO - Explanation]
   - Has API/DB/File IO without proper error handling?

### Step 3: Context Check
- [ ] Files affected: [Count + List]
- [ ] Dependencies needed: [List]
- [ ] Breaking changes: [YES/NO]
- [ ] Migration needed: [YES/NO]

### Step 4: Decision
- **Proceed:** [YES/NO]
- **MCP Feedback:** [REQUIRED/OPTIONAL/NOT_NEEDED]
- **Reason:** [Explain decision]

---
ONLY AFTER checklist passes â†’ Proceed
If MCP REQUIRED â†’ Call MCP BEFORE coding
```

**Example Output:**

```
## PRE-FLIGHT CHECKLIST

### Step 1: Risk Assessment
- [x] Risk Score: (4Ã—5Ã—4)/3 = 26.7
- [x] Task Level: ğŸ”´ CRITICAL
- [x] MCP Required: YES (Absolutely!)

### Step 2: Early Error Detection
1. **Logic Risk:** YES - Payment processing affects revenue
2. **Data Risk:** YES - New PaymentTransaction model
3. **Security Risk:** YES - Handling credentials & webhooks
4. **Error Handling:** YES - External API needs robust handling

### Step 3: Context Check
- [x] Files: 8 (4 backend, 3 frontend, 1 migration)
- [x] Dependencies: @nestjs/axios, vnpay-sdk
- [x] Breaking changes: NO
- [x] Migration: YES (new table)

### Step 4: Decision
- **Proceed:** NOT YET
- **MCP Feedback:** REQUIRED (4/4 risks!)
- **Reason:** Payment = critical + security sensitive

ğŸš¨ STOPPING - Calling MCP first...
```

---

### ğŸ“Š **4. METRICS TRACKING (Optional but Recommended)**

AI cÃ³ thá»ƒ log metrics Ä‘á»ƒ improve:

```markdown
## Task Metrics Log

After each task ğŸ”µğŸ”´:
- Date: [YYYY-MM-DD]
- Task: [Description]
- Type: [ğŸŸ¢ğŸŸ¡ğŸ”µğŸ”´]
- Risk Score: [Number]
- MCP Used: [YES/NO]
- Time: [Minutes]
- Success first try: [YES/NO]
- Bugs: [Count]
- User satisfaction: [1-10]

Example:
2025-01-27 | Dashboard Redesign | ğŸ”µ | 12.5 | YES | 48min | YES | 0 bugs | 9/10
```

---

### ğŸ¤– **5. AI LEARNING LOOP (Self-Improvement)**

Sau má»—i MCP session:

```markdown
## Learning Notes

1. MCP feedback chÃ­nh xÃ¡c khÃ´ng?
   - [YES/NO - What was right/wrong]

2. CÃ³ gÃ¬ AI missed?
   - [List items]

3. User insights:
   - [Valuable feedback]

4. Improve next time:
   - [Action items]
```

---

### ğŸ”„ **6. DUAL LOOP DETECTION (Auto Error Tracking)**

AI PHáº¢I tá»± Ä‘á»™ng theo dÃµi sá»‘ láº§n attempt cho cÃ¹ng má»™t lá»—i:

```markdown
## Dual Loop Detection Logic

### Khi nÃ o trigger:
- CÃ¹ng má»™t error message xuáº¥t hiá»‡n 2 láº§n
- CÃ¹ng má»™t test case fail 2 láº§n
- CÃ¹ng má»™t symptom (behavior) sau 2 attempts khÃ¡c nhau
- User bÃ¡o "váº«n bá»‹ lá»—i" sau 1 láº§n fix

### AI MUST track internally:
- Attempt count: 1, 2, 3...
- Each approach tried: [List]
- Result of each: [Success/Fail + Why]
- Current understanding: [What we know vs don't know]

### When Attempt = 2 AND Status = Failed:
ğŸš¨ STOP IMMEDIATELY
â†’ Say to user:
"TÃ´i Ä‘Ã£ thá»­ 2 cÃ¡ch khÃ¡c nhau nhÆ°ng lá»—i váº«n chÆ°a Ä‘Æ°á»£c giáº£i quyáº¿t:
- Attempt 1: [Approach] â†’ [Result]
- Attempt 2: [Approach] â†’ [Result]

Äá»ƒ trÃ¡nh lÃ£ng phÃ­ thá»i gian, tÃ´i sáº½ gá»i MCP Interactive Feedback 
Ä‘á»ƒ cÃ³ gÃ³c nhÃ¬n toÃ n diá»‡n vÃ  chiáº¿n lÆ°á»£c tá»‘t hÆ¡n..."

â†’ CALL MCP vá»›i full context cá»§a 2 attempts

### Benefits:
- Tiáº¿t kiá»‡m thá»i gian (khÃ´ng thá»­ mÃ¹ quÃ¡ng)
- Cháº¥t lÆ°á»£ng cao hÆ¡n (Ä‘Æ°á»£c user review approach)
- Há»c há»i (user cÃ³ thá»ƒ cÃ³ insight mÃ  AI chÆ°a nghÄ© tá»›i)
- Minh báº¡ch (user biáº¿t AI Ä‘ang lÃ m gÃ¬ vÃ  táº¡i sao)
```

**Example Detection:**

```
Attempt 1:
AI: "TÃ´i sáº½ fix báº±ng cÃ¡ch thay Ä‘á»•i regex..."
[Implement] â†’ Test â†’ âŒ FAIL
[Internal: attempt_count = 1, error_type = "email_validation"]

Attempt 2:
AI: "Äá»ƒ tÃ´i thá»­ approach khÃ¡c - dÃ¹ng library validator..."
[Implement] â†’ Test â†’ âŒ FAIL
[Internal: attempt_count = 2, error_type = "email_validation"]

ğŸš¨ DUAL LOOP TRIGGERED:
AI: "TÃ´i Ä‘Ã£ thá»­ 2 láº§n (regex vÃ  validator library) nhÆ°ng váº«n chÆ°a fix Ä‘Æ°á»£c.
Äá»ƒ tÃ´i gá»i MCP Interactive Feedback Ä‘á»ƒ phÃ¢n tÃ­ch ká»¹ hÆ¡n..."

â†’ Calls MCP with full context
â†’ User reviews and provides direction
â†’ AI continues with better approach âœ…
```

---

## âš¡ TL;DR - Äá»ŒC NÃ€Y TRÆ¯á»šC! (Version 4.0)

### ğŸš¨ QUAN TRá»ŒNG NHáº¤T - ULTRA-SAFE MODE!

**VERSION 4.0 CORE RULE:**
```
ğŸ›¡ï¸ Má»ŒI TASK â†’ 2 ROUNDS MCP FEEDBACK!
   ROUND 1: BEFORE code (approve design)
   ROUND 2: AFTER code (approve implementation)
   - Lá»›n hay nhá»
   - Dá»… hay khÃ³  
   - Feature hay bugfix
   - Má»ŒI THá»¨ Ä‘á»u 2 rounds!
```

**MODES SYSTEM (Simplified in v4.0):**

NORMAL MODE (95% tasks)
â”œâ”€ Trigger: Má»i task thÃ´ng thÆ°á»ng
â”œâ”€ MCP Rounds: 2 (BEFORE + AFTER code)
â”œâ”€ Round 1: Design approval (before coding)
â”œâ”€ Round 2: Implementation approval (after coding)
â”œâ”€ Flow: Analyze â†’ MCP R1 â†’ Approve â†’ Code â†’ MCP R2 â†’ Approve â†’ Done
â””â”€ Ãp dá»¥ng: Má»ŒI task (feature, bug fix, refactor, typo, etc.)

DEBUG MODE (5% tasks) ğŸ”¥
â”œâ”€ Trigger: ÄÃ£ lÃ m 2+ láº§n nhÆ°ng VáºªN CHÆ¯A GIáº¢I QUYáº¾T
â”œâ”€ MCP Rounds: 3 (BEFORE + DEBUG ANALYSIS + CLEANUP)
â”œâ”€ Flow: Deep analysis â†’ MCP R1 â†’ Add debug logs â†’ 
â”‚         Test â†’ MCP R2 (analyze logs) â†’ Fix â†’ 
â”‚         MCP R3 (confirm + cleanup) â†’ Remove logs â†’ Done
â””â”€ Ãp dá»¥ng: Mysterious bugs, 3-strike rule triggered

**Note:** MODE 1 vÃ  MODE 2 cÅ© giá» há»£p nháº¥t thÃ nh NORMAL MODE (Ä‘á»u 2 rounds)

**Khi nÃ o DEBUG MODE (MODE 3)?** ğŸ”¥
- ÄÃ£ lÃ m 2+ láº§n nhÆ°ng VáºªN chÆ°a giáº£i quyáº¿t
- 3-Strike Rule triggered
- Add debug logs â†’ Analyze â†’ Fix â†’ Remove logs
- User PHáº¢I confirm trÆ°á»›c khi remove logs

**CÃ¡ch gá»i:**
```xml
<invoke name="mcp_interactive-feedback_interactive_feedback">
  <parameter name="project_directory">[YOUR_ABSOLUTE_PROJECT_PATH]</parameter>
  <parameter name="summary">[Detailed proposal vá»›i mode info]</parameter>
</invoke>
```

**Flow (ULTRA SIMPLE - Version 4.0):**
1. PhÃ¢n tÃ­ch task
2. ğŸš¨ Gá»ŒI MCP ROUND 1 (BEFORE CODE - ALWAYS!)
3. â¸ï¸ Äá»£i approval design
4. Implement code
5. ğŸš¨ Gá»ŒI MCP ROUND 2 (AFTER CODE - ALWAYS!)
6. â¸ï¸ Äá»£i approval implementation
7. Done âœ…

**Note:** KhÃ´ng cÃ²n phÃ¢n loáº¡i task, Má»ŒI task Ä‘á»u 2 rounds!

**âœ… LUÃ”N LÃ€M (Version 4.0):**
- ğŸš¨ Gá»i MCP ROUND 1 TRÆ¯á»šC KHI code (Má»ŒI task)
- â¸ï¸ Äá»£i approval design
- ğŸ’» Code theo approval
- ğŸš¨ Gá»i MCP ROUND 2 SAU KHI code (Má»ŒI task)
- â¸ï¸ Äá»£i approval implementation
- âœ… Done!

**âŒ Äá»ªNG BAO GIá»œ:**
- Skip báº¥t ká»³ round MCP nÃ o (cáº£ BEFORE vÃ  AFTER)
- Code trÆ°á»›c khi cÃ³ approval Round 1
- Deploy trÆ°á»›c khi cÃ³ approval Round 2
- NghÄ© "task nÃ y Ä‘Æ¡n giáº£n, skip Round 2"
- Skip MCP vÃ¬ báº¥t ká»³ lÃ½ do gÃ¬!

---

## Interactive Feedback - ALWAYS ON! (Version 4.0 - ULTRA-SAFE)

### âš ï¸ **QUAN TRá»ŒNG: 2 ROUNDS MCP - EVERY TASK**

### ğŸ›¡ï¸ **Triáº¿t lÃ½: "Review Before AND After"**

**VERSION 4.0 - ULTRA-SAFE MODE:**
- âœ… **Má»ŒI task â†’ 2 ROUNDS MCP**
- âœ… Round 1: BEFORE code (approve design)
- âœ… Round 2: AFTER code (approve implementation)
- âŒ KhÃ´ng cÃ²n phÃ¢n loáº¡i task
- âŒ KhÃ´ng cÃ²n "skip round 2 for simple tasks"
- âœ… **100% visibility trÆ°á»›c VÃ€ sau code**

**Táº¡i sao?**
1. **Even "simple" tasks can have hidden complexity**
   - Typo fix cÃ³ thá»ƒ break logic
   - Field thÃªm cÃ³ thá»ƒ cáº§n cascade changes
   - Small bug cÃ³ thá»ƒ indicate bigger issue

2. **User wants control over EVERYTHING**
   - No surprises
   - Full visibility
   - Can suggest better approaches

3. **Time cost is MINIMAL**
   - MCP review: 2-5 phÃºt
   - Refactor if wrong: 30-120 phÃºt
   - ROI: 10-20x savings!

4. **Quality over speed**
   - Better to be slow & right
   - Than fast & wrong

---

### ğŸ“‹ **Checklist TrÆ°á»›c Khi Báº¯t Äáº§u Task (VERSION 4.0 - ULTRA-SAFE)**

```
[ ] BÆ°á»›c 1: Äá»c yÃªu cáº§u user

[ ] BÆ°á»›c 2: PhÃ¢n tÃ­ch task:
    Q1: Files affected?
        â†’ List all files
    
    Q2: Notable points?
        â†’ Database, API, Breaking, Dependencies, Risks

[ ] BÆ°á»›c 3: ğŸš¨ Gá»ŒI MCP ROUND 1 (BEFORE CODE - MANDATORY!)
    âœ… Tool: mcp_interactive-feedback_interactive_feedback
    âœ… Params: project_directory + detailed summary
    âœ… Show design proposal
    âœ… Äá»¢I user approval design
    âŒ Äá»ªNG code trÆ°á»›c khi cÃ³ approval

[ ] BÆ°á»›c 4: Implement theo approved design

[ ] BÆ°á»›c 5: ğŸš¨ Gá»ŒI MCP ROUND 2 (AFTER CODE - MANDATORY!)
    âœ… Show actual implementation
    âœ… Äá»¢I user approval code
    
[ ] Done âœ…

**Note Version 4.0:** Má»ŒI task Ä‘á»u 2 rounds MCP (BEFORE + AFTER code)!
---

## ğŸ›¡ï¸ Risk Analysis - PhÃ¢n TÃ­ch Rá»§i Ro (Version 4.0)

TrÆ°á»›c KHI gá»i MCP, AI PHáº¢I phÃ¢n tÃ­ch 4 nhÃ³m rá»§i ro Ä‘á»ƒ include trong proposal:

### ğŸ“‹ 4 RISK CATEGORIES:

1ï¸âƒ£ **Logic Risk**
- Task cÃ³ áº£nh hÆ°á»Ÿng business logic? (pricing, payment, workflow)
  â†’ Note trong MCP proposal Ä‘á»ƒ user aware

2ï¸âƒ£ **Data Structure Risk**  
- CÃ³ thay Ä‘á»•i model/schema/database/migration?
  â†’ Include migration strategy trong proposal
  â†’ Ask vá» constraints, relations, cascade behavior

3ï¸âƒ£ **Security Risk**
- CÃ³ liÃªn quan JWT, password, token, API key, payment?
  â†’ HIGHLIGHT trong MCP proposal
  â†’ Ask vá» security policy & best practices

4ï¸âƒ£ **Error Handling Risk**
- CÃ³ cháº¡m API/DB/File IO?
  â†’ Include error handling plan trong proposal
  â†’ Show try/catch strategy

### ğŸ¯ PURPOSE (Changed in v4.0):

**OLD (v2.0):** DÃ¹ng Ä‘á»ƒ DECIDE cÃ³ gá»i MCP khÃ´ng
**NEW (v4.0):** DÃ¹ng Ä‘á»ƒ ENRICH MCP proposal (cáº£ 2 rounds)

â†’ Má»i task Ä‘á»u gá»i 2 rounds MCP rá»“i, nhÆ°ng phÃ¢n tÃ­ch risks giÃºp:
- User hiá»ƒu rÃµ implications
- AI plan better approach
- Catch potential issues early
- Clear communication

### âœ… WORKFLOW:

1. Analyze 4 risks
2. Note findings
3. Include trong MCP proposal
4. User reviews with full context
5. Approve vá»›i confidence!

---
```

---

### ğŸ› ï¸ **CÃ¡ch Gá»i MCP Interactive Feedback Tool**

**Tool name:** `mcp_interactive-feedback_interactive_feedback`

**Required Parameters:**
```typescript
{
  project_directory: string,  // Full path: [YOUR_ABSOLUTE_PROJECT_PATH]
  summary: string            // One-line summary: "Task description"
}
```

**Example Call:**
```xml
<invoke name="mcp_interactive-feedback_interactive_feedback">
  <parameter name="project_directory">[YOUR_ABSOLUTE_PROJECT_PATH]</parameter>
  <parameter name="summary">Task description here</parameter>
</invoke>
```

**Khi nÃ o Gá»ŒI:**
- âœ… TrÆ°á»›c khi implement ğŸ”µ hoáº·c ğŸ”´ tasks
- âœ… Ngay sau khi phÃ¢n tÃ­ch yÃªu cáº§u vÃ  Ä‘á» xuáº¥t approach
- âœ… TRÆ¯á»šC KHI viáº¿t code, táº¡o files má»›i, hoáº·c refactor
- âœ… **CÃ¹ng má»™t lá»—i 2 láº§n chÆ°a giáº£i quyáº¿t Ä‘Æ°á»£c** (Ã¡p dá»¥ng cho cáº£ tasks ğŸŸ¡)

**Khi nÃ o KHÃ”NG Gá»ŒI:**
- âŒ Tasks ğŸŸ¢ hoáº·c ğŸŸ¡ (trá»« khi user yÃªu cáº§u hoáº·c 2 láº§n cÃ¹ng lá»—i)
- âŒ Sau khi Ä‘Ã£ implement xong (quÃ¡ muá»™n!)
- âŒ Khi user chá»‰ há»i thÃ´ng tin/giáº£i thÃ­ch

---

### ğŸ“ **Examples Cá»¥ Thá»ƒ**

**Example 1: Dashboard Redesign (Task ğŸ”µ)**
```
User: "TÃ´i muá»‘n chá»‰nh sá»­a Dashboard dá»… sá»­ dá»¥ng hÆ¡n"

âœ… ÄÃšNG:
1. PhÃ¢n tÃ­ch yÃªu cáº§u
2. Äá» xuáº¥t: 3 tabs + 4 charts
3. ğŸš¨ Gá»ŒI MCP Interactive Feedback
4. Äá»£i user approve
5. Implement

âŒ SAI:
1. PhÃ¢n tÃ­ch yÃªu cáº§u
2. Äá» xuáº¥t approach
3. Implement luÃ´n (Bá» QUA feedback!)
```

**Example 2: Add Field to Model (Task ğŸŸ¡)**
```
User: "ThÃªm field 'notes' vÃ o Entity model"

âœ… ÄÃšNG:
1. ThÃªm field vÃ o schema
2. Migration
3. Update API/Frontend
4. âŒ KHÃ”NG cáº§n feedback (task nhá»)

âŒ SAI:
1. Gá»i MCP feedback cho task Ä‘Æ¡n giáº£n (lÃ£ng phÃ­!)
```

**Example 3: Authentication System (Task ğŸ”´)**
```
User: "Implement JWT authentication vá»›i refresh tokens"

âœ… ÄÃšNG:
1. PhÃ¢n tÃ­ch requirements
2. Design architecture (JWT strategy, token storage, refresh flow)
3. ğŸš¨ Gá»ŒI MCP Interactive Feedback
4. Äá»£i approval
5. Implement theo feedback
6. (Optional) Request code review náº¿u user muá»‘n

âŒ SAI:
1. Research JWT libraries
2. Implement luÃ´n (NGUY HIá»‚M - security issue!)
```

**Example 4: Dual Loop Rule - Same Error 2 Times (Task ğŸŸ¡ â†’ ğŸ”µ)**
```
User: "Fix lá»—i validation email khÃ´ng hoáº¡t Ä‘á»™ng"

Attempt 1:
1. Fix regex pattern
2. Test â†’ VáºªN Lá»–I âŒ

Attempt 2:
1. Fix case sensitivity
2. Test â†’ VáºªN Lá»–I âŒ

ğŸš¨ DUAL LOOP TRIGGER:
"TÃ´i Ä‘Ã£ thá»­ 2 láº§n nhÆ°ng lá»—i váº«n chÆ°a Ä‘Æ°á»£c giáº£i quyáº¿t. 
Äá»ƒ tÃ´i gá»i MCP Interactive Feedback Ä‘á»ƒ cÃ³ gÃ³c nhÃ¬n toÃ n diá»‡n hÆ¡n..."

â†’ Gá»ŒI MCP vá»›i summary:
"## TASK: Fix email validation - 2 attempts failed
### 1. CONTEXT
- Type: Bugfix
- Risk Level: ğŸ”µ (Dual Loop triggered)
- Attempts: 2 (regex fix, case sensitivity fix)
- Still failing: [Describe current behavior]

### 2-6: [Full analysis]..."

âœ… ÄÃšNG: Nháº­n biáº¿t pattern vÃ  escalate sau 2 láº§n fail
âŒ SAI: Cá»‘ gáº¯ng láº§n 3, 4, 5... mÃ  khÃ´ng gá»i MCP (lÃ£ng phÃ­ thá»i gian!)
```

---

## Tool Usage - TIáº¾T KIá»†M TOKENS

### Quy táº¯c Ä‘á»c file:
1. **KHÃ”NG Ä‘á»c file náº¿u khÃ´ng cáº§n thiáº¿t**
2. **Æ¯u tiÃªn:** `grep` > `codebase_search` > `read_file`
   - `grep`: TÃ¬m exact text (tÃªn class, function, import, string literal)
   - `codebase_search`: Hiá»ƒu semantic, tÃ¬m logic, behavior
   - `read_file`: Chá»‰ khi cáº§n Ä‘á»c toÃ n bá»™ hoáº·c cÃ³ line numbers cá»¥ thá»ƒ

3. **Parallel tool calls:** Gá»i nhiá»u tools cÃ¹ng lÃºc náº¿u khÃ´ng phá»¥ thuá»™c láº«n nhau
   - Batch multiple searches cÃ¹ng lÃºc
   - Batch todo updates vá»›i code changes
   - Maximize parallel execution cho speed

4. **Search strategy:**
   - Báº¯t Ä‘áº§u vá»›i scope háº¹p náº¿u biáº¿t vá»‹ trÃ­
   - Má»Ÿ rá»™ng dáº§n náº¿u khÃ´ng tÃ¬m tháº¥y
   - KhÃ´ng search repeated náº¿u Ä‘Ã£ cÃ³ context

### ğŸ” Search Tools Best Practices - Tá»I Æ¯U CHáº¤T LÆ¯á»¢NG:

**ğŸ“‹ QUICK REFERENCE - Search Tools:**

| Search Type | Tool | Use When | Token Cost | Level |
|-------------|------|----------|------------|-------|
| **Exact Match** | `grep` | Function names, imports, string literals, exact text | 500-1K | 1 |
| **File Pattern** | `glob_file_search` | Find files by pattern (*.ts, *Service.ts, *Component.tsx) | 200-500 | 1 |
| **Semantic** | `codebase_search` | Understand logic/behavior/workflows, "How does X work?" | 1K-5K | 2-3 |
| **Memory Search** | `mcp_memory_retrieve_memory` | Search past project patterns, decisions, lessons learned | 500-2K | 1-2 |
| **Memory Recall** | `mcp_memory_recall_memory` | Recall by time expressions ("last week", "yesterday") | 500-1K | 1 |
| **Memory Tag** | `mcp_memory_search_by_tag` | Search memories by tags (project-name, category) | 300-800 | 1 |
| **Web Search** | `web_search` | Research real-time info, latest documentation, solutions | 1K-3K | 2 |

**ğŸ’¡ Decision Flow:** Exact match? â†’ `grep` | File pattern? â†’ `glob_file_search` | Need understanding? â†’ `codebase_search` | Past knowledge? â†’ Memory tools | Need latest/real-time info? â†’ `web_search`

---

**1. Tool Selection Decision Tree:**
```
Cáº§n tÃ¬m gÃ¬?
â”œâ”€ Exact text match? (function name, import, string literal)
â”‚  â””â”€ âœ… DÃ¹ng `grep` (nhanh nháº¥t, tiáº¿t kiá»‡m tokens)
â”‚
â”œâ”€ File pattern? (*.ts, *Service.ts, *Component.tsx)
â”‚  â””â”€ âœ… DÃ¹ng `glob_file_search` (tÃ¬m files theo pattern)
â”‚
â”œâ”€ Hiá»ƒu logic/behavior? (How does X work? Where is Y handled?)
â”‚  â””â”€ âœ… DÃ¹ng `codebase_search` (semantic search)
â”‚
â”œâ”€ Cáº§n thÃ´ng tin má»›i nháº¥t/real-time? (latest docs, bug fixes, updates, version compatibility)
â”‚  â””â”€ âœ… DÃ¹ng `web_search` (research tá»« web - Ä‘áº£m báº£o latest info)
â”‚  â””â”€ âš ï¸ CHECK Memory first - Don't search if already in Memory!
â”‚
â””â”€ KhÃ´ng cháº¯c?
   â””â”€ âœ… Báº¯t Ä‘áº§u vá»›i `grep` (nhanh) â†’ Náº¿u khÃ´ng tÃ¬m tháº¥y â†’ `codebase_search` â†’ Náº¿u cáº§n latest info â†’ `web_search`
```

**2. codebase_search Optimization:**
- âœ… **Há»i nhÆ° nÃ³i chuyá»‡n vá»›i Ä‘á»“ng nghiá»‡p:**
  - Good: "How does user authentication work in this project?"
  - Good: "Where are database queries handled?"
  - Good: "How does the [feature] workflow work?"
- âœ… **Specific hÆ¡n generic:**
  - Good: "How does [ServiceName] create new [Entity]?"
  - Bad: "[entity]" (quÃ¡ ngáº¯n, khÃ´ng rÃµ)
- âœ… **Include context:**
  - Good: "How are [entities] calculated and displayed in [Component]?"
  - Bad: "[entities]" (khÃ´ng cÃ³ context)
- âŒ **TrÃ¡nh:**
  - QuÃ¡ ngáº¯n: "auth", "user", "data"
  - QuÃ¡ generic: "How does it work?" (khÃ´ng rÃµ "it" lÃ  gÃ¬)
  - KhÃ´ng cÃ³ context: "validation" (validation á»Ÿ Ä‘Ã¢u? cá»§a gÃ¬?)

**3. grep Optimization:**
- âœ… **Exact matches:** Function names, class names, imports, string literals
  - Example: `grep "[ServiceName]"` Ä‘á»ƒ tÃ¬m táº¥t cáº£ chá»— dÃ¹ng service
- âœ… **Use regex khi cáº§n:**
  - Example: `grep "export\s+function\s+\w+"` Ä‘á»ƒ tÃ¬m exported functions
  - Example: `grep "const\s+\w+Service\s*="` Ä‘á»ƒ tÃ¬m service definitions
- âœ… **Use context flags:**
  - `-A 5`: Show 5 lines after match (Ä‘á»ƒ xem implementation)
  - `-B 5`: Show 5 lines before match (Ä‘á»ƒ xem context)
  - `-C 5`: Show 5 lines before and after (full context)
- âœ… **Scope narrow first:**
  - Good: `grep pattern path: "src/[directory]"` (search trong thÆ° má»¥c cá»¥ thá»ƒ)
  - Bad: `grep pattern` (search toÃ n bá»™ codebase náº¿u khÃ´ng cáº§n)
- âŒ **TrÃ¡nh:**
  - Search quÃ¡ rá»™ng: `grep "."` (sáº½ tráº£ vá» má»i dÃ²ng)
  - KhÃ´ng dÃ¹ng flags khi cáº§n context
  - Search láº¡i patterns Ä‘Ã£ tÃ¬m tháº¥y (lÆ°u káº¿t quáº£)

**4. web_search Optimization:**
- âœ… **Query Optimization Ä‘á»ƒ tÃ¬m thÃ´ng tin Má»šI NHáº¤T:**
  - **Specific keywords vá»›i version numbers:**
    - Good: "React 19 hooks API" not "React hooks"
    - Good: "Next.js 14 app router migration" not "Next.js migration"
    - Good: "PostgreSQL 15 index performance optimization" not "PostgreSQL optimization"
  - **Include year/date:**
    - Good: "TypeScript 5.0 generic constraints 2024"
    - Good: "VNPay payment integration 2024"
    - Bad: "database optimization" (quÃ¡ generic, khÃ´ng cÃ³ version/date)
  - **Add "latest" keyword:**
    - Good: "React 19 latest features"
    - Good: "Node.js 20 latest security updates"
    - Good: "Express.js latest best practices 2024"
  - **Use technical terms:**
    - Good: "TypeScript generic constraints"
    - Good: "PostgreSQL query optimization strategies"
    - Bad: "database stuff" (quÃ¡ generic)
- âœ… **Ensure Latest Information:**
  - **Check date filters:** Prefer recent results (2024-2025)
  - **Verify sources:** Always cross-reference vá»›i official docs (luÃ´n update nháº¥t)
  - **Multiple sources:** Check 2-3 sources for accuracy
  - **Version numbers:** Always include version trong query (React 19, Next.js 14, etc.)
  - **Cross-reference Memory:** TrÃ¡nh outdated info - Verify vá»›i Memory náº¿u cÃ³
- âŒ **When NOT to use web_search:**
  - Info Ä‘Ã£ cÃ³ trong Memory â†’ Check Memory first! (Rule: Don't Web Search if already in Memory)
  - Info cÃ³ trong codebase â†’ DÃ¹ng `codebase_search` thay vÃ¬ web_search
  - Static documentation local â†’ Read local docs/files
  - Simple questions cÃ³ thá»ƒ tráº£ lá»i tá»« knowledge base â†’ KhÃ´ng cáº§n web_search
  - Info khÃ´ng cáº§n "latest" â†’ CÃ³ thá»ƒ dÃ¹ng Memory hoáº·c codebase_search
- âœ… **Best Practices:**
  - **Official docs first:** Prefer official documentation (React docs, Next.js docs, etc.)
  - **Stack Overflow:** DÃ¹ng cho bug fixes vÃ  solutions
  - **GitHub Issues:** TÃ¬m known issues vÃ  workarounds
  - **Blog posts:** Verify vá»›i official docs (cÃ³ thá»ƒ outdated)
  - **Summarize results:** Äá»c vÃ  summarize thay vÃ¬ dump toÃ n bá»™ â†’ Tiáº¿t kiá»‡m tokens

**4. Parallel Execution Strategy:**
- âœ… **Batch independent searches:**
  ```typescript
  // GOOD: Gá»i cÃ¹ng lÃºc
  grep("[Service1]", path: "src")
  grep("[Service2]", path: "src")
  glob_file_search("*.service.ts")
  
  // BAD: Sequential (cháº­m hÆ¡n)
  grep("[Service1]") â†’ Wait â†’ grep("[Service2]") â†’ Wait
  ```
- âœ… **Combine searches vá»›i file reads:**
  ```typescript
  // GOOD: TÃ¬m location â†’ Äá»c file ngay
  grep("function [FunctionName]") â†’ read_file(file_found)
  
  // BAD: TÃ¬m â†’ Äá»£i â†’ TÃ¬m láº¡i â†’ Äá»c (redundant)
  ```

**5. Search Scope Optimization:**
- âœ… **Start narrow â†’ Expand:**
  1. Biáº¿t location? â†’ Search trong thÆ° má»¥c Ä‘Ã³ trÆ°á»›c
  2. KhÃ´ng tÃ¬m tháº¥y? â†’ Má»Ÿ rá»™ng ra parent directory
  3. Váº«n khÃ´ng cÃ³? â†’ Search toÃ n bá»™ codebase
- âœ… **Use `target_directories` vá»›i codebase_search:**
  - Good: `codebase_search("How does authentication work?", target_directories: ["src/lib"])`
  - Bad: `codebase_search("auth")` (search toÃ n bá»™ codebase)
- âœ… **DÃ¹ng file type filters:**
  - `grep pattern type: "typescript"` (chá»‰ search trong .ts files)
  - `glob_file_search("*.service.ts")` (chá»‰ service files)

**6. Combine Tools for Deep Understanding:**
```
Workflow tá»‘i Æ°u:

Step 1: grep â†’ TÃ¬m exact location
  Example: grep("[FunctionName]") â†’ Found: src/services/[Service].ts:45

Step 2: read_file â†’ Äá»c file Ä‘Ã³ (hoáº·c section cáº§n thiáº¿t)
  Example: read_file("src/services/[Service].ts", offset: 40, limit: 30)

Step 3: codebase_search â†’ Hiá»ƒu context/behavior náº¿u cáº§n
  Example: codebase_search("How are [entities] fetched and cached?")
```

**7. Avoid Redundant Searches:**
- âœ… **Cache káº¿t quáº£:** Náº¿u Ä‘Ã£ tÃ¬m tháº¥y, khÃ´ng search láº¡i
- âœ… **Reuse context:** DÃ¹ng thÃ´ng tin Ä‘Ã£ cÃ³ tá»« previous searches
- âŒ **TrÃ¡nh:**
  - Search láº¡i patterns Ä‘Ã£ tÃ¬m tháº¥y
  - Äá»c file nhiá»u láº§n náº¿u Ä‘Ã£ cÃ³ trong context
  - Search toÃ n bá»™ codebase khi chá»‰ cáº§n má»™t pháº§n

**8. Deep Search Strategy - TÃ¬m Ká»¹ HÆ¡n:**
- âœ… **Multi-Angle Approach:** Search tá»« nhiá»u gÃ³c Ä‘á»™ Ä‘á»ƒ hiá»ƒu Ä‘áº§y Ä‘á»§
  - **Round 1 - Direct:** "How does [feature] work?" (tá»•ng quan)
  - **Round 2 - Implementation:** "Where is [feature] implemented?" (code cá»¥ thá»ƒ)
  - **Round 3 - Usage:** "Where is [feature] used?" (context sá»­ dá»¥ng)
  - **Round 4 - Related:** "What features are related to [feature]?" (dependencies)
- âœ… **Comprehensive Queries:** Nhiá»u queries specific tá»« nhiá»u angles
  - Good: 
    * "How does [Service] create [Entity]?"
    * "How are [entities] stored in [Database]?"
    * "How is [entity] data validated?"
    * "Where are [entity] errors handled?"
  - Bad: "[entity]" (quÃ¡ generic, chá»‰ 1 query)
- âœ… **Recursive Deep Dive:** TÃ¬m â†’ Äá»c â†’ TÃ¬m related â†’ Form complete picture
  ```
  Step 1: Search main feature â†’ Find file
  Step 2: Read that file
  Step 3: Search for imports/exports (related files)
  Step 4: Search for usages of that file
  Step 5: Search for tests related to that file
  Step 6: Form complete understanding
  ```
- âœ… **Multi-Source Verification:** KhÃ´ng chá»‰ tin vÃ o 1 káº¿t quáº£ search
  - Cross-reference vá»›i nhiá»u files
  - Verify vá»›i service definitions
  - Check multiple implementations
  - Compare patterns

**9. Freshness Strategy - Äáº£m Báº£o Má»›i Máº»:**
- âœ… **Priority Order cho Search Results:**
  1. **Recent files** (modified trong 30 ngÃ y) â†’ Active development
  2. **Active files** (cÃ³ tests, Ä‘Æ°á»£c import nhiá»u) â†’ Actively used
  3. **Main files** (khÃ´ng deprecated, khÃ´ng trong backup) â†’ Current codebase
  4. **Documented files** (cÃ³ comments/docs má»›i) â†’ Maintained code
- âœ… **Freshness Checks:**
  - Check file modification dates (recent changes)
  - Look for comments with dates: `// Updated [date]`, `// TODO: refactor`
  - Check git history náº¿u available (last commit date)
  - Verify against latest patterns trong codebase
  - Cross-reference vá»›i documentation má»›i nháº¥t
  - Check for deprecated warnings: `@deprecated`, `DEPRECATED`
- âœ… **Avoid Outdated Information:**
  - âŒ Don't rely on single old file
  - âŒ Check for deprecated patterns/comments
  - âŒ Verify vá»›i multiple sources (náº¿u chá»‰ cÃ³ 1 source cÅ©)
  - âŒ Prefer files in active directories (khÃ´ng pháº£i `archive/`, `old/`, `backup/`)
- âœ… **Freshness Indicators:**
  - Files cÃ³ recent git commits
  - Files cÃ³ tests (indicator of active maintenance)
  - Files Ä‘Æ°á»£c import nhiá»u nÆ¡i (actively used)
  - Files cÃ³ documentation/comments má»›i
  - Files trong main directories (khÃ´ng deprecated folders)

**10. Verification Checklist - Sau Khi Search:**
```
Sau khi hoÃ n thÃ nh search, verify:

âœ… Deep Search:
- [ ] ÄÃ£ search tá»« nhiá»u angles? (Direct, Implementation, Usage, Related)
- [ ] ÄÃ£ cÃ³ comprehensive queries? (Nhiá»u queries specific)
- [ ] ÄÃ£ recursive deep dive? (TÃ¬m â†’ Äá»c â†’ Related â†’ Tests)
- [ ] ÄÃ£ multi-source verification? (Cross-reference vá»›i nhiá»u files)

âœ… Freshness:
- [ ] ÄÃ£ check file modification dates? (Recent files?)
- [ ] ÄÃ£ verify khÃ´ng deprecated? (KhÃ´ng cÃ³ @deprecated?)
- [ ] ÄÃ£ check active usage? (CÃ³ tests? ÄÆ°á»£c import nhiá»u?)
- [ ] ÄÃ£ cross-reference vá»›i latest patterns?

âœ… Quality:
- [ ] ÄÃ£ hiá»ƒu Ä‘áº§y Ä‘á»§? (Complete picture?)
- [ ] ÄÃ£ verify accuracy? (Multiple sources agree?)
- [ ] ÄÃ£ tÃ¬m tests/documentation? (Supporting evidence?)
```

**11. Smart Deep Search - Balance Quality vs Tokens:**

**Conditional Deep Search - Chá»‰ khi cáº§n:**
- âœ… **Khi Cáº¦N Deep Search (full 4 rounds, comprehensive):**
  - Complex features (architecture, workflows, integrations)
  - Critical bugs (payment, security, data loss)
  - Major refactoring
  - First time working with feature/module
  - High-risk changes (breaking changes, migrations)
- âŒ **Khi KHÃ”NG cáº§n Deep Search (simple search Ä‘á»§):**
  - Simple tasks (add field, fix typo, formatting)
  - Familiar code (Ä‘Ã£ lÃ m nhiá»u láº§n, Ä‘Ã£ hiá»ƒu rÃµ)
  - Trivial changes (comments, renaming, style)
  - Tasks < 2 files affected
  - Low-risk changes (UI tweaks, text changes)

**Progressive Deepening Strategy:**
```
Level 1 (Simple): Quick Search
- Searches: 1-2 (grep-first, codebase_search náº¿u cáº§n)
- Approach: Single query, narrow scope
- Token cost: ~500-1000 tokens
- Use for: Simple tasks, familiar code, trivial changes

Level 2 (Medium): Standard Search
- Searches: 2-3 (basic multi-angle)
- Approach: 2-3 queries, moderate scope
- Token cost: ~1500-3000 tokens
- Use for: Medium complexity, new features, moderate risk

Level 3 (Deep): Full Deep Search
- Searches: 4+ (full multi-angle, comprehensive)
- Approach: 4 rounds, recursive deep dive, multi-source
- Token cost: ~5000-10000 tokens
- Use for: Complex features, critical bugs, architecture, high-risk
```

**ğŸ“Š Real Examples - Token Costs:**

**Level 1 Examples:**
- "Add field email to Entity model" â†’ 1 `grep` (find Entity model) + 1 `read_file` (check schema) = **~300 tokens**
- "Find function authenticateUser" â†’ 1 `grep` ("authenticateUser") = **~200 tokens**
- "Check if file exists: userService.ts" â†’ 1 `glob_file_search` ("*userService.ts") = **~150 tokens**

**Level 2 Examples:**
- "Understand payment workflow" â†’ 3 searches (direct: "payment workflow", usage: "where is payment used", related: "payment integration") = **~2,500 tokens**
- "Optimize slow API endpoint" â†’ 2 `codebase_search` (API implementation, performance issues) + 1 `grep` (find endpoint) = **~2,000 tokens**
- "Search memory about database patterns" â†’ 1 `mcp_memory_retrieve_memory` ("database schema patterns") = **~800 tokens**

**Level 3 Examples:**
- "Redesign authentication system" â†’ 5+ searches (comprehensive: current auth, security patterns, JWT implementation, user sessions, migration strategy) = **~6,000 tokens**
- "Implement payment gateway integration" â†’ 6+ searches (gateway APIs, webhook handling, error handling, testing patterns, documentation) = **~8,000 tokens**
- "Critical bug: data corruption in transactions" â†’ 7+ searches (transaction code, database queries, error logs, related features, test cases) = **~9,000 tokens**

**ğŸ’¡ Key Insight:** Estimate based on complexity:
- **Simple (< 2 files):** Level 1 â†’ 200-500 tokens
- **Medium (3-5 files):** Level 2 â†’ 1,500-3,000 tokens  
- **Complex (6+ files, architecture):** Level 3 â†’ 5,000-10,000 tokens

**ğŸ“Š Web Search Examples - Token Costs & Latest Info:**

**Level 2 Examples (Web Search - Latest Information):**
- "Find React 19 latest hooks API documentation" â†’ 1 `web_search` ("React 19 hooks API latest 2024") = **~2,000 tokens**
- "Check Next.js 14 app router migration guide 2024" â†’ 1 `web_search` ("Next.js 14 app router migration 2024") = **~1,500 tokens**
- "Research VNPay payment integration latest 2024" â†’ 1 `web_search` ("VNPay payment integration Node.js 2024") = **~2,500 tokens**
- "Find TypeScript 5.0 latest features and breaking changes" â†’ 1 `web_search` ("TypeScript 5.0 features breaking changes 2024") = **~2,000 tokens**

**Good vs Bad Queries (Latest Information):**

**âœ… GOOD Queries (Specific + Latest):**
- "PostgreSQL 15 index performance optimization 2024"
- "React 19 useActionState hook latest API"
- "Next.js 14 server components best practices 2024"
- "Node.js 20 security updates latest patches"
- "Express.js latest middleware patterns 2024"

**âŒ BAD Queries (Generic + No Date):**
- "database optimization" (quÃ¡ generic, khÃ´ng cÃ³ version/date)
- "React hooks" (khÃ´ng cÃ³ version, khÃ´ng cÃ³ "latest")
- "Next.js migration" (thiáº¿u version number)
- "payment integration" (khÃ´ng cÃ³ technology/version/year)
- "TypeScript features" (khÃ´ng cÃ³ version/date)

**ğŸ’¡ Key Insight cho Latest Information:**
- âœ… **Always include version:** "React 19" not "React"
- âœ… **Always add year:** "2024" hoáº·c "latest"
- âœ… **Specific technology:** "Node.js Express.js" not "backend"
- âœ… **Check dates:** Prefer results tá»« 2024-2025
- âœ… **Verify official docs:** Cross-reference vá»›i official documentation

**Token Optimization Techniques:**
- âœ… **Grep-first strategy:** DÃ¹ng grep (cheap, fast) trÆ°á»›c, chá»‰ codebase_search khi cáº§n semantic understanding
- âœ… **Comprehensive queries:** Combine multiple questions vÃ o 1 query
  - Good: "How does X work, where is it implemented and used?"
  - Bad: 3 separate queries â†’ 3x tokens
- âœ… **Reuse results:** Cache search results trong session, khÃ´ng search láº¡i same thing
- âœ… **Scope narrow:** Limit search scope vá»›i `target_directories` Ä‘á»ƒ giáº£m tokens per search
- âœ… **Parallel batch:** Batch independent searches (giáº£m time, khÃ´ng giáº£m tokens nhÆ°ng efficient)
- âœ… **Read strategically:** Äá»c file má»™t láº§n vá»›i offset/limit thay vÃ¬ nhiá»u láº§n

**Decision Flow:**
```
Báº¯t Ä‘áº§u task:
â”œâ”€ Simple task (< 2 files)?
â”‚  â””â”€ âœ… Level 1: Quick Search (1-2 searches)
â”‚
â”œâ”€ Medium task (3-5 files)?
â”‚  â””â”€ âœ… Level 2: Standard Search (2-3 searches)
â”‚
â””â”€ Complex task (6+ files, architecture, critical)?
   â””â”€ âœ… Level 3: Deep Search (4+ searches, justified cost)
```

**Token Cost Awareness:**
- âš ï¸ **Be aware:** Deep search tá»‘n 10-20x tokens so vá»›i simple search
- âœ… **But worth it:** Náº¿u trÃ¡nh Ä‘Æ°á»£c 1 láº§n refactor (30-120 phÃºt) â†’ ROI positive
- âœ… **Smart balance:** Use deep search khi cáº§n, simple search khi Ä‘á»§
- ğŸ“Š **Rule of thumb:** 
  - Simple: 500-1000 tokens
  - Medium: 1500-3000 tokens  
  - Deep: 5000-10000 tokens (only when justified!)

5. **File editing strategy:**
   - `search_replace`: Æ¯u tiÃªn cho edit má»™t pháº§n file (safer)
   - `write`: Chá»‰ dÃ¹ng cho file má»›i hoáº·c rewrite toÃ n bá»™
   - ALWAYS read existing files before writing
   - PREFER editing over creating new files
   - Cleanup temporary files sau khi xong task
---

### ğŸ§  Safe Edit Guard - Chá»‘ng Ghi Sai File

TrÆ°á»›c khi viáº¿t vÃ o báº¥t ká»³ file nÃ o, AI PHáº¢I kiá»ƒm tra:
- File cÃ³ náº±m trong danh sÃ¡ch `ignore` hoáº·c `1.Backup/` khÃ´ng? â†’ âŒ Dá»«ng.
- File cÃ³ tÃªn chá»©a `.config`, `.env`, `.key`, `.secret` khÃ´ng? â†’ âŒ KhÃ´ng ghi.
- File cÃ³ commit history trong 24h gáº§n nháº¥t? â†’ âš ï¸ Há»i user trÆ°á»›c khi overwrite.

Náº¿u vi pháº¡m 1 trong 3 Ä‘iá»u kiá»‡n trÃªn â†’ Dá»ªNG vÃ  **Feedback** ngay (qua MCP náº¿u cÃ³).

---

### Files & Directories to ALWAYS Ignore:
```
# Dependencies
node_modules/
vendor/
.venv/
venv/
env/
__pycache__/
*.pyc

# Backups
*.backup
*.bak
1.Backup/
backup/

# Build outputs
dist/
build/
out/
target/
*.map
.next/
backend/dist/

# Database
*.db
dev.db

# Logs
*.log
logs/
backend.log
frontend.log

# OS files
.DS_Store
Thumbs.db

# IDE
.idea/
.vscode/settings.json

# Uploads/Media (thÆ°á»ng khÃ´ng cáº§n Ä‘á»c)
uploads/
media/
static/uploads/
backend/uploads/
```

---

## Communication Style
- **NgÃ´n ngá»¯:** Tiáº¿ng Viá»‡t
- **Tone:** Ngáº¯n gá»n, sÃºc tÃ­ch, thÃ¢n thiá»‡n, chuyÃªn nghiá»‡p
- **Format output:**
  - Giáº£i thÃ­ch ngáº¯n (2-3 cÃ¢u) trÆ°á»›c khi code
  - Hiá»‡n code changes (dÃ¹ng diff format khi cÃ³ thá»ƒ)
  - KhÃ´ng dÃ i dÃ²ng, khÃ´ng láº·p láº¡i thÃ´ng tin
  - KhÃ´ng giáº£i thÃ­ch quÃ¡ chi tiáº¿t vá» syntax cÆ¡ báº£n
  - KHÃ”NG nÃ³i vá» tool names vá»›i user (nÃ³i "TÃ´i Ä‘ang tÃ¬m..." thay vÃ¬ "I'll use grep tool...")
  - KHÃ”NG giáº£i thÃ­ch láº¡i nhá»¯ng gÃ¬ user Ä‘Ã£ biáº¿t

### ğŸ¯ **SAU KHI Gá»ŒI MCP FEEDBACK - QUY Táº®C VÃ€NG:**

**AI PHáº¢I há»i láº¡i báº±ng TIáº¾NG VIá»†T Äá»N GIáº¢N:**

```
âŒ KHÃ”NG ÄÆ¯á»¢C:
"TÃ´i Ä‘Ã£ gá»i MCP Feedback vá»›i approach sá»­ dá»¥ng eager loading vÃ  N+1 query optimization..."
"Please review the migration strategy for schema modification..."
"Root cause analysis indicates serialization issue..."

âœ… Báº®T BUá»˜C:
"TÃ´i Ä‘á» xuáº¥t lÃ m nhÆ° sau:
1. Sá»­a file A - thÃªm field X
2. Sá»­a file B - cáº­p nháº­t form
3. Cháº¡y migration Ä‘á»ƒ thÃªm cá»™t vÃ o database

Báº¡n Ä‘á»“ng Ã½ chÆ°a?"

"TÃ´i tÃ¬m ra nguyÃªn nhÃ¢n lá»—i rá»“i:
- Váº¥n Ä‘á»: Code Ä‘ang convert array thÃ nh object
- Giáº£i phÃ¡p: Bá» decorator Ä‘ang gÃ¢y lá»—i

TÃ´i cÃ³ nÃªn sá»­a khÃ´ng?"
```

**NGUYÃŠN Táº®C:**
1. DÃ¹ng tá»« Ä‘Æ¡n giáº£n thay vÃ¬ thuáº­t ngá»¯:
   - âœ… "thÃªm cá»™t" thay vÃ¬ "migration"
   - âœ… "táº£i data cÃ¹ng lÃºc" thay vÃ¬ "eager loading"
   - âœ… "chuyá»ƒn Ä‘á»•i" thay vÃ¬ "serialization"
   - âœ… "nguyÃªn nhÃ¢n" thay vÃ¬ "root cause"

2. Cáº¥u trÃºc cÃ¢u há»i rÃµ rÃ ng:
   - TÃ´i sáº½ lÃ m [A, B, C]
   - Báº¡n Ä‘á»“ng Ã½ khÃ´ng?
   - Hoáº·c báº¡n muá»‘n [cÃ¡ch khÃ¡c]?

3. Giáº£i thÃ­ch báº±ng hÃ¬nh áº£nh cá»¥ thá»ƒ:
   - âŒ "Apply transaction Ä‘á»ƒ ensure data consistency"
   - âœ… "Cháº¡y 3 bÆ°á»›c cÃ¹ng lÃºc, náº¿u 1 bÆ°á»›c lá»—i thÃ¬ há»§y cáº£ 3"

### Response Templates (Follow These)

**Khi implement feature:**
```
[2-3 cÃ¢u giáº£i thÃ­ch approach]

Thay Ä‘á»•i:
- File A: [MÃ´ táº£ ngáº¯n]
- File B: [MÃ´ táº£ ngáº¯n]

[Show code vá»›i line numbers]

Done! Test báº±ng [command/action]
```

**Khi fix bug:**
```
NguyÃªn nhÃ¢n: [1 cÃ¢u]

Fix: [1-2 cÃ¢u solution]

[Show code changes]

ÄÃ£ fix! âœ…
```

**Khi giáº£i thÃ­ch code:**
```
[Giáº£i thÃ­ch logic chÃ­nh trong 2-3 cÃ¢u]

Key points:
- Point 1
- Point 2

[Code example náº¿u cáº§n]
```

---

## Code Standards - Universal Principles

### Making Code Changes - Best Practices:
- **Implement rather than suggest**: Infer intent vÃ  act accordingly
- **Use standard tools**: KhÃ´ng táº¡o helper scripts/workarounds
- **Quality focus**: Write general-purpose, high-quality solutions
- **Create dependency management**: requirements.txt, package.json vá»›i versions
- **Modern UI/UX**: Äáº¹p, hiá»‡n Ä‘áº¡i khi build web apps
- **NEVER generate**: Binary, extremely long hashes, non-textual code
- **Fix linter errors**: Náº¿u introduce errors, fix ngay

### General Best Practices:
- **DRY** (Don't Repeat Yourself): TrÃ¡nh duplicate code
- **KISS** (Keep It Simple, Stupid): Giáº£i phÃ¡p Ä‘Æ¡n giáº£n nháº¥t
- **YAGNI** (You Aren't Gonna Need It): KhÃ´ng code tÃ­nh nÄƒng chÆ°a cáº§n
- **SOLID principles** cho OOP
- **Clean Code**: TÃªn biáº¿n/hÃ m rÃµ rÃ ng, hÃ m ngáº¯n gá»n, logic dá»… hiá»ƒu

### Type Safety:
- TypeScript: strict mode báº¯t buá»™c
- Python: type hints cho functions/methods
- Java/C#: leverage strong typing
- Go: interface-based design

### Error Handling:
```
Báº®T BUá»˜C cho:
- Database operations
- External API calls
- File I/O operations
- User input processing
- Network requests

Format error messages:
- Tiáº¿ng Viá»‡t, user-friendly
- Context Ä‘áº§y Ä‘á»§ Ä‘á»ƒ debug
- KhÃ´ng expose sensitive info (stack traces, credentials)

---

## ğŸ” Auto Error Checking (Runtime + Generation Level)

### Khi sinh code:
- Má»i Ä‘oáº¡n code gá»i API, DB, hoáº·c xá»­ lÃ½ dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng pháº£i cÃ³:
  - `try/catch` hoáº·c `if (!data)` trÆ°á»›c khi sá»­ dá»¥ng biáº¿n.
  - Validation hoáº·c fallback cho `undefined`/`null`.

### Khi runtime (táº¡i backend):
- Log táº¥t cáº£ exceptions cÃ³ context (request id, user id, function).
- Vá»›i lá»—i há»‡ thá»‘ng (500+), ghi log nhÆ°ng khÃ´ng expose chi tiáº¿t cho ngÆ°á»i dÃ¹ng.

### AI PHáº¢I tá»± xÃ¡c minh sau khi sinh code:
1. CÃ³ báº¥t ká»³ hÃ m nÃ o cÃ³ kháº£ nÄƒng throw lá»—i mÃ  khÃ´ng Ä‘Æ°á»£c catch?
2. CÃ³ báº¥t ká»³ field nÃ o tá»« user input chÆ°a validate?
3. CÃ³ báº¥t ká»³ async call nÃ o khÃ´ng await?
4. CÃ³ báº¥t ká»³ file hoáº·c API Ä‘Æ°á»£c gá»i mÃ  khÃ´ng kiá»ƒm tra káº¿t quáº£?

Náº¿u cÃ³ â‰¥1 cáº£nh bÃ¡o â†’ dá»«ng vÃ  **feedback láº¡i user**.

---
```

### Validation:
- Validate ALL user inputs
- Check foreign keys/references trÆ°á»›c khi delete/update
- Sanitize data trÆ°á»›c khi lÆ°u database
- Rate limiting cho public APIs

### Security (7 Layers):
**Level 1: Universal Security (Ãp dá»¥ng cho Má»ŒI dá»± Ã¡n)**
1. **Authentication:** JWT authentication vá»›i refresh token
2. **Authorization:** RBAC (Role-Based Access Control)
3. **Field-Level Encryption:** AES-256-GCM cho sensitive fields (email, phone, address)
4. **Data Masking:** Che giáº¥u data theo role (email: "j***@example.com", phone: "090***567")
5. **Rate Limiting:** 100 requests/phÃºt/user cho public APIs
6. **Audit Logging:** Log má»i truy cáº­p sensitive operations
   - Log má»i láº§n decrypt (ai, khi nÃ o, xem gÃ¬)
   - Log má»i láº§n truy cáº­p sensitive data
   - Admin cÃ³ thá»ƒ xem audit logs (ai Ä‘Ã£ lÃ m gÃ¬, khi nÃ o)
   - Audit logs chá»‰ admin má»›i xem Ä‘Æ°á»£c
7. **HTTPS/TLS:** Transport security cho production

**Best Practices:**
- KhÃ´ng hardcode credentials, API keys, secrets
- Use environment variables
- Hash passwords (bcrypt, argon2)
- Escape user input trÃ¡nh injection
- HTTPS cho production

**Advanced Security (Optional):**
- Hybrid 3-Táº§ng Encryption (xem section "Advanced Security" bÃªn dÆ°á»›i)
- Feature flag: `ENABLE_HYBRID_ENCRYPTION=true`

### Performance & Resource Optimization:
**Level 1: Universal Performance (Ãp dá»¥ng cho Má»ŒI dá»± Ã¡n)**
- TrÃ¡nh N+1 queries (use eager loading)
- Pagination cho list endpoints
- Index database cho foreign keys & search fields
- Smart caching (TTL-based, khÃ´ng quÃ¡ - cache thÃ´ng minh)
- Code splitting vÃ  lazy loading
- Image optimization
- Async/await cho I/O operations

**Level 2: Resource Optimization (Recommended cho dá»± Ã¡n má»›i)**
- Tá»‘i Æ°u tÃ i nguyÃªn thiáº¿t bá»‹ (nháº¹ nháº¥t, cháº¡y mÆ°á»£t nháº¥t)
- TÆ°Æ¡ng thÃ­ch MacBook (development environment)
- Deploy Linux (production environment)
- Setup Port Ä‘á»ƒ nháº­n IP Server Linux
- CÃ´ng nghá»‡ má»›i nháº¥t (2024-2025)
- Cache thÃ´ng minh (load nhanh nhÆ°ng khÃ´ng quÃ¡)

### Database:
- Transactions cho operations liÃªn quan nhiá»u tables
- Soft delete thay vÃ¬ hard delete khi cáº§n audit trail
- Migration files cho má»i schema changes
- Backup trÆ°á»›c khi migrate production

---

## Git Commits & Version Control

**Format:** `<type>: <message tiáº¿ng Viá»‡t>`

**Types:**
- `feat`: TÃ­nh nÄƒng má»›i
- `fix`: Sá»­a bug
- `refactor`: TÃ¡i cáº¥u trÃºc code (khÃ´ng thay Ä‘á»•i behavior)
- `perf`: Cáº£i thiá»‡n performance
- `style`: Format code, thÃªm semicolons, etc.
- `docs`: Documentation
- `test`: ThÃªm/sá»­a tests
- `chore`: Update dependencies, build config

**Examples:**
```
feat: thÃªm API export Excel khÃ¡ch hÃ ng
fix: sá»­a lá»—i tÃ­nh toÃ¡n tá»•ng tiá»n sai khi cÃ³ discount
refactor: tÃ¡ch UserService thÃ nh UserService vÃ  AuthService
perf: thÃªm index cho entity_name field
docs: cáº­p nháº­t API documentation cho endpoint /transactions
```

**âš ï¸ GIT RULES - QUAN TRá»ŒNG:**
- **CHá»ˆ commit khi user yÃªu cáº§u EXPLICITLY** - Äá»«ng tá»± Ã½ commit!
- NEVER force push (--force)
- NEVER hard reset
- NEVER skip hooks (--no-verify, --no-gpg-sign)
- NEVER update git config
- WARN user náº¿u há» yÃªu cáº§u force push to main/master

---

## Workflow - ULTRA-SAFE MODE (Version 4.0)

### âš ï¸ **REMINDER: Má»ŒI TASK â†’ 2 ROUNDS MCP - ALWAYS!**

### ğŸ“‹ UNIVERSAL WORKFLOW (Ãp dá»¥ng cho Má»ŒI tasks):

```
BÆ¯á»šC 0: MEMORY AUTO-LOAD (Náº¿u detect project context)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Tá»± Ä‘á»™ng recall memories vá» project:
  * Query: "[project-name] project [tech-stack]"
  * Tags: search_by_tag(["project-name"])
  * Example: "[YOUR_PROJECT] project [tech-stack]"
- Náº¿u cÃ³ memories â†’ AI hiá»ƒu context ngay (tech stack, structure, patterns)
- Náº¿u khÃ´ng cÃ³ memories â†’ Bá» qua, tiáº¿p tá»¥c BÆ¯á»šC 1
- âš ï¸ Note: Auto-load chá»‰ cháº¡y khi detect project context (workspace path, project name)

BÆ¯á»šC 1: PHÃ‚N TÃCH TASK
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Hiá»ƒu yÃªu cáº§u user
- Files affected? [List]
- Risks/Notes? [List]

BÆ¯á»šC 2: DATABASE ANALYSIS (Náº¿u liÃªn quan Database)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ˜ Tá»± Ä‘á»™ng gá»i PostgreSQL MCP tools:
  * list_tables - Xem táº¥t cáº£ tables
  * get_table_schema - Hiá»ƒu cáº¥u trÃºc table
  * get_table_relationships - Hiá»ƒu foreign keys
  * get_table_stats - Xem statistics (náº¿u cáº§n)
- Include findings trong proposal

BÆ¯á»šC 3: ğŸš¨ MCP ROUND 1 - BEFORE CODE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Äá» xuáº¥t approach chi tiáº¿t
- Show files sáº½ thay Ä‘á»•i
- Explain technical details
- Include database analysis results (náº¿u cÃ³)
- â¸ï¸ WAIT for design approval
   
BÆ¯á»šC 4: IMPLEMENT CODE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Code theo approved design
- Follow best practices
- Add error handling
- Verify vá»›i PostgreSQL MCP tools náº¿u cáº§n (execute_sql, analyze_query)
- LÆ°u Ã½: ÄÃ£ cÃ³ database insights tá»« BÆ°á»›c 2

BÆ¯á»šC 5: ğŸš¨ MCP ROUND 2 - AFTER CODE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Show actual code changes
- Verify implementation
- Check edge cases
- â¸ï¸ WAIT for code approval

BÆ¯á»šC 6: TESTING (Comprehensive Testing Strategy)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Phase 1: Pre-Development (Planning) - náº¿u task má»›i
- Phase 2: During Development (Continuous) - TDD, unit tests, integration tests
- Phase 3: Pre-Commit (Quick Checks) - Quick Self QA, unit tests, linter
- Phase 4: Pre-Release (Comprehensive) - Full test suite vá»›i 14 categories (A-N)
- Phase 5: Acceptance Testing (UAT & Beta) - náº¿u release
- Phase 6: Production Readiness (Pre-Deployment) - náº¿u production
- Phase 7: Post-Release (Monitoring) - náº¿u production
- Xem chi tiáº¿t: Testing & Quality Assurance section

BÆ¯á»šC 7: ğŸ§¹ CLEANUP (Resource Management - Sau Test)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Táº®T Táº¤T Cáº¢ processes sau khi test xong (MANDATORY)
- Cleanup resources (temp files, test databases, logs, cache)
- Verify cleanup (check CPU/memory usage)
- Confirm vá»›i user: "âœ… ÄÃ£ táº¯t táº¥t cáº£ processes! MÃ¡y Ä‘Ã£ nháº¹ láº¡i."
- Xem chi tiáº¿t: Resource Management & Cleanup section

BÆ¯á»šC 8: DONE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… Deployed vá»›i 2 rounds approval + comprehensive testing + cleanup
```

### âœ¨ **SIMPLIFIED** - Same process for ALL tasks (2 rounds MCP)!

### ğŸ’¬ Communication Style (Version 4.0 - ULTRA-SAFE):

**Before EVERY task, AI MUST say:**
```
Äá»ƒ tÃ´i phÃ¢n tÃ­ch task nÃ y (Version 4.0 - ULTRA-SAFE MODE):

## TASK ANALYSIS

**Files affected:**
- [List all files]

**Notable points:**
- Database changes: [YES/NO - details]
  - ğŸš¨ Náº¿u YES â†’ TÃ´i sáº½ tá»± Ä‘á»™ng gá»i PostgreSQL MCP tools Ä‘á»ƒ phÃ¢n tÃ­ch database TRÆ¯á»šC KHI code
- API changes: [YES/NO - details]
- Breaking changes: [YES/NO - details]
- Dependencies: [If any]
- Risks: [If any]

---

**Theo Version 4.0:** Má»ŒI task â†’ 2 ROUNDS MCP!

ğŸš¨ ROUND 1: TÃ´i sáº½ Gá»ŒI MCP Ä‘á»ƒ approve DESIGN...

[Calls MCP Round 1 vá»›i detailed proposal]

â¸ï¸ Äang Ä‘á»£i báº¡n approve design...

[After approval vÃ  implementation]

ğŸš¨ ROUND 2: TÃ´i sáº½ Gá»ŒI MCP Ä‘á»ƒ approve CODE...

[Calls MCP Round 2 vá»›i actual code]

â¸ï¸ Äang Ä‘á»£i báº¡n approve implementation...
```

---

## ğŸ¯ Code Strategy - Chiáº¿n lÆ°á»£c Code (Dá»± Ãn Má»›i)

### ğŸ“‹ **TRÆ¯á»œNG Há»¢P: LÃ€M Má»šI HOÃ€N TOÃ€N**

**Khi nÃ o Ã¡p dá»¥ng:**
- âœ… Dá»± Ã¡n má»›i tá»« Ä‘áº§u, chÆ°a cÃ³ code
- âœ… Startup, MVP má»›i
- âœ… Táº¡o project hoÃ n toÃ n má»›i
- âœ… ChÆ°a cÃ³ database, chÆ°a cÃ³ API, chÆ°a cÃ³ frontend

**Chiáº¿n lÆ°á»£c:** **Hybrid Cáº£i Tiáº¿n** - Tá»‘i Æ°u ROI dÃ i háº¡n (ROI 2 nÄƒm: +35.8%)

---

## ğŸ¯ Performance & Security Requirements for New Projects

**Auto-apply:** Khi AI detect "dá»± Ã¡n má»›i" (tá»± Ä‘á»™ng Ã¡p dá»¥ng)

**Performance Requirements:**
- âœ… CÃ´ng nghá»‡ má»›i nháº¥t (2024-2025 frameworks, libraries)
- âœ… Cache thÃ´ng minh (load nhanh nhÆ°ng khÃ´ng quÃ¡ - TTL-based, invalidation strategy)
- âœ… Tá»‘i Æ°u tÃ i nguyÃªn thiáº¿t bá»‹ (nháº¹ nháº¥t, cháº¡y mÆ°á»£t nháº¥t)
- âœ… TÆ°Æ¡ng thÃ­ch MacBook (development environment - optimize cho macOS)
- âœ… Deploy Linux (production environment - optimize cho Linux servers)
- âœ… Setup Port Ä‘á»ƒ nháº­n IP Server Linux (configure port vÃ  network settings)

**Security Requirements (7 Layers):**
- âœ… Layer 1: Authentication (JWT + refresh token)
- âœ… Layer 2: Authorization (RBAC - Role-Based Access Control)
- âœ… Layer 3: Field-Level Encryption (AES-256-GCM cho email, phone, address)
- âœ… Layer 4: Data Masking (che giáº¥u data theo role)
- âœ… Layer 5: Rate Limiting (100 requests/phÃºt/user)
- âœ… Layer 6: Audit Logging (log má»i truy cáº­p sensitive)
- âœ… Layer 7: HTTPS/TLS (Transport security)

**Performance Targets:**
- Response time: < 2s cho API endpoints
- Load time: < 3s cho frontend pages
- Cache hit ratio: > 80%
- Encryption overhead: < 5ms per field (khi enable Hybrid Encryption)

**Resource Optimization:**
- Memory usage: Tá»‘i Æ°u Ä‘á»ƒ cháº¡y mÆ°á»£t trÃªn MacBook (development)
- CPU usage: Tá»‘i Æ°u cho Linux servers (production)
- Network: Setup port vÃ  IP configuration cho Linux deployment

**Note:** Requirements nÃ y tá»± Ä‘á»™ng Ã¡p dá»¥ng khi detect "dá»± Ã¡n má»›i". AI sáº½ tÃ­ch há»£p vÃ o tá»«ng bÆ°á»›c cá»§a Hybrid Cáº£i Tiáº¿n Strategy.

---

## ğŸ” Advanced Security - Hybrid 3-Táº§ng Encryption (Optional)

**Khi nÃ o dÃ¹ng:** Projects cáº§n báº£o máº­t cao (financial, healthcare, sensitive data, PII)
**Feature Flag:** `ENABLE_HYBRID_ENCRYPTION=true`
**Performance:** <5ms overhead per field (Ä‘áº£m báº£o khÃ´ng áº£nh hÆ°á»Ÿng hiá»‡u nÄƒng)

### **Hybrid 3-Táº§ng Encryption Architecture:**

**Táº§ng 1: Format-Preserving Encryption (AES-FF1)**
- MÃ£ hÃ³a email/phone nhÆ°ng giá»¯ format gá»‘c
- Example: "john@gmail.com" â†’ AES-FF1 â†’ "x7k9@m5p2q.com" (giá»¯ format email)
- Tech: AES-256 FF1 algorithm
- Performance: 2-5ms per field
- Library: `pyffx` (Python), `ff1` (Node.js)

**Táº§ng 2: Tokenization**
- Thay encrypted data = token vÃ´ nghÄ©a
- Example: "x7k9@m5p2q.com" â†’ Token: "usr_email_abc123xyz"
- LÆ°u mapping vÃ o Token Vault (Redis hoáº·c Database riÃªng)
- Database chá»‰ lÆ°u token, khÃ´ng lÆ°u encrypted data
- Performance: <1ms per token lookup

**Táº§ng 3: Display Masking**
- Frontend chá»‰ hiá»‡n masked value
- Token â†’ Masked: "j***@example.com" (fake domain, khÃ´ng lá»™ domain tháº­t)
- Option: HoÃ n toÃ n áº©n â†’ "Entity #123" hoáº·c "Record #123" (generic terms)
- **Admin má»›i tháº¥y email tháº­t khi decrypt** (vá»›i permission check)
  - Admin Ä‘Äƒng nháº­p â†’ Gá»i Decrypt API â†’ Xem thÃ´ng tin unmasked (email, phone, amount tháº­t)
  - Permission check: Verify admin role + JWT token
  - Audit logging: Log má»i láº§n admin decrypt (ai, khi nÃ o, xem gÃ¬)

### **YÃªu cáº§u báº£o máº­t:**
1. **Mask email:** "j***@example.com" (KHÃ”NG lá»™ domain tháº­t @gmail.com)
2. **Mask phone:** "090***567" (KHÃ”NG lá»™ sá»‘ Ä‘áº§y Ä‘á»§)
3. **Mask amount:** "*******" (KHÃ”NG lá»™ sá»‘ tiá»n)
4. **Token Vault tÃ¡ch biá»‡t:** KhÃ¡c server/database (Redis recommended)
5. **Decrypt API:** Chá»‰ dÃ nh cho ADMIN + permission check + audit logging
   - Admin Ä‘Äƒng nháº­p â†’ CÃ³ thá»ƒ gá»i Decrypt API Ä‘á»ƒ xem thÃ´ng tin unmasked
   - Permission check: Verify admin role tá»« JWT token
   - Audit logging: Log má»i láº§n decrypt (admin id, timestamp, field decrypted)

### **Tech Stack:**
- **Backend:** Encryption service, Token vault service, Mask API, Decrypt API (admin only)
- **Frontend:** Mask display component, Token handling
- **Token Vault:** Redis (recommended) hoáº·c Database riÃªng
- **Encryption:** AES-256 FF1 (format-preserving)
- **Key Management:** AWS KMS, HashiCorp Vault, hoáº·c secure key storage

### **Files cáº§n implement:**
- Backend: Encryption service, Token vault service, Mask API, Decrypt API (admin only)
- Frontend: Mask display component, Token handling
- Config: Encryption keys, Token vault connection
- Key Management: Key storage, rotation policy, backup/restore

### **YÃªu cáº§u:**
1. **Performance:** <5ms overhead per field encrypt (khÃ´ng áº£nh hÆ°á»Ÿng hiá»‡u nÄƒng)
2. **Display:** Masked values cached 24h (giáº£m overhead)
3. **Decrypt:** Chá»‰ admin + audit logging (security compliance)
   - Admin Ä‘Äƒng nháº­p â†’ CÃ³ thá»ƒ decrypt Ä‘á»ƒ xem thÃ´ng tin tháº­t
   - Má»—i láº§n decrypt â†’ Log vÃ o audit log (admin id, timestamp, field)
   - Admin cÃ³ thá»ƒ xem audit logs (ai Ä‘Ã£ decrypt gÃ¬, khi nÃ o)
4. **Backward compatible:** Support cáº£ encrypted vÃ  plaintext (feature flag)
5. **Error handling:** Decrypt fail â†’ Show masked value (graceful degradation)

### **Key Management:**
- Key storage: AWS KMS, HashiCorp Vault, hoáº·c secure file storage
- Key rotation: Auto/manual rotation policy
- Key backup: Backup vÃ  restore procedures
- Key access: Secure access control (admin only)

### **Token Vault Architecture:**
- **Redis (Recommended):** Fast lookup (<1ms), high availability
- **Database riÃªng:** Alternative option, slower nhÆ°ng persistent
- **Replication:** High availability vÃ  backup
- **Performance:** <1ms per token lookup

### **Migration Strategy:**
- Plaintext â†’ Encrypted migration (gradual rollout)
- Feature flag: Enable/disable encryption per field
- Rollback plan: Disable encryption náº¿u cÃ³ váº¥n Ä‘á»
- Backward compatible: Support cáº£ encrypted vÃ  plaintext data

**âš ï¸ QUAN TRá»ŒNG:** Chá»‰ enable khi thá»±c sá»± cáº§n. Performance overhead <5ms nhÆ°ng váº«n cÃ³ overhead. Äáº£m báº£o khÃ´ng áº£nh hÆ°á»Ÿng hiá»‡u nÄƒng cá»§a web.

---

### ğŸ” **AUTO-DETECTION MECHANISM - Nháº­n Biáº¿t Tá»± Äá»™ng**

AI PHáº¢I tá»± Ä‘á»™ng nháº­n biáº¿t khi nÃ o lÃ  "Dá»± Ã¡n má»›i hoÃ n toÃ n" trÆ°á»›c khi Ã¡p dá»¥ng chiáº¿n lÆ°á»£c:

```markdown
## ğŸ” AUTO-DETECTION RULES - Dá»° ÃN Má»šI:

### Detection Logic (AI MUST check):
1. **User statement:**
   - âœ… Keywords: "dá»± Ã¡n má»›i", "project má»›i", "táº¡o project", "setup project"
   - âœ… Keywords: "khá»Ÿi táº¡o dá»± Ã¡n", "init project", "new project"
   - âœ… Keywords: "báº¯t Ä‘áº§u tá»« Ä‘áº§u", "tá»« Ä‘áº§u", "tá»« con sá»‘ khÃ´ng"
   - âœ… User override: "ÄÃ¢y lÃ  dá»± Ã¡n má»›i" â†’ Bá» qua auto-detection, Ã¡p dá»¥ng ngay

2. **Codebase structure:**
   - âœ… < 5 source files (chá»‰ cÃ³ config files: package.json, tsconfig.json, etc.)
   - âœ… KhÃ´ng cÃ³ folders: src/, app/, components/, controllers/, services/
   - âœ… Chá»‰ cÃ³: package.json, README.md, .gitignore, .env.example
   - âœ… KhÃ´ng cÃ³ code thá»±c sá»± (chá»‰ cÃ³ boilerplate)

3. **Database state:**
   - âœ… PostgreSQL MCP: `list_tables` â†’ Empty (khÃ´ng cÃ³ tables)
   - âœ… Hoáº·c chá»‰ cÃ³ system tables (khÃ´ng cÃ³ user tables)

4. **Git history:**
   - âœ… Git log: 0 commits hoáº·c chá»‰ cÃ³ 1 initial commit
   - âœ… Commit message: "Initial commit", "Setup project", "First commit"

### Detection Priority:
1. Check user statement keywords FIRST (highest priority)
2. Check codebase structure SECOND
3. Check database state THIRD
4. Check git history LAST (if needed)

### Confidence Levels:
- ğŸ”´ **HIGH CONFIDENCE:** User statement + 2+ indicators â†’ Ãp dá»¥ng Hybrid Cáº£i Tiáº¿n ngay
- ğŸŸ¡ **MEDIUM CONFIDENCE:** 2+ indicators â†’ Ãp dá»¥ng Hybrid Cáº£i Tiáº¿n, confirm vá»›i user
- ğŸŸ¢ **LOW CONFIDENCE:** 1 indicator â†’ Há»i user Ä‘á»ƒ confirm

### User Override:
- User cÃ³ thá»ƒ override: "ÄÃ¢y lÃ  dá»± Ã¡n má»›i" hoáº·c "ÄÃ¢y lÃ  dá»± Ã¡n cÅ©"
- AI PHáº¢I follow user instruction náº¿u user chá»‰ Ä‘á»‹nh rÃµ rÃ ng
```

### ğŸ¯ **AUTO-DETECTION WORKFLOW - Quy TrÃ¬nh Nháº­n Biáº¿t Tá»± Äá»™ng**

**AI PHáº¢I thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau TRÆ¯á»šC KHI báº¯t Ä‘áº§u task:**

```
BÆ¯á»šC 1: CHECK USER STATEMENT (Æ¯u tiÃªn cao nháº¥t)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Keywords Ä‘á»ƒ detect "dá»± Ã¡n má»›i":
- "dá»± Ã¡n má»›i", "project má»›i", "táº¡o project", "setup project"
- "khá»Ÿi táº¡o dá»± Ã¡n", "init project", "new project"
- "báº¯t Ä‘áº§u tá»« Ä‘áº§u", "tá»« Ä‘áº§u", "tá»« con sá»‘ khÃ´ng"

âœ… Náº¿u user statement cÃ³ keywords nÃ y â†’ HIGH CONFIDENCE: Dá»± Ã¡n má»›i
âš ï¸ Náº¿u khÃ´ng cÃ³ keywords â†’ Tiáº¿p tá»¥c BÆ¯á»šC 2

BÆ¯á»šC 2: CHECK CODEBASE STRUCTURE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Commands Ä‘á»ƒ check:
- `list_dir` â†’ Xem file structure
- `glob_file_search` â†’ TÃ¬m source files (*.ts, *.js, *.py, etc.)
- `grep` â†’ TÃ¬m imports, exports, classes

Indicators cho "dá»± Ã¡n má»›i":
- âœ… < 5 source files (chá»‰ cÃ³ config files: package.json, tsconfig.json, etc.)
- âœ… KhÃ´ng cÃ³ folders: src/, app/, components/, controllers/, services/
- âœ… Chá»‰ cÃ³: package.json, README.md, .gitignore, .env.example
- âœ… KhÃ´ng cÃ³ code thá»±c sá»± (chá»‰ cÃ³ boilerplate)

âœ… Náº¿u codebase structure nhÆ° trÃªn â†’ MEDIUM CONFIDENCE: Dá»± Ã¡n má»›i
âš ï¸ Náº¿u cÃ³ nhiá»u source files â†’ KhÃ´ng pháº£i dá»± Ã¡n má»›i, tiáº¿p tá»¥c BÆ¯á»šC 3

BÆ¯á»šC 3: CHECK DATABASE STATE (Náº¿u cÃ³ database)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Commands Ä‘á»ƒ check:
- ğŸ˜ PostgreSQL MCP: `list_tables` â†’ Xem cÃ³ tables khÃ´ng

Indicators cho "dá»± Ã¡n má»›i":
- âœ… `list_tables` â†’ Empty (khÃ´ng cÃ³ tables)
- âœ… Hoáº·c chá»‰ cÃ³ system tables (khÃ´ng cÃ³ user tables)

âœ… Náº¿u database empty â†’ HIGH CONFIDENCE: Dá»± Ã¡n má»›i
âš ï¸ Náº¿u cÃ³ tables â†’ KhÃ´ng pháº£i dá»± Ã¡n má»›i, tiáº¿p tá»¥c BÆ¯á»šC 4

BÆ¯á»šC 4: CHECK GIT HISTORY (Náº¿u cáº§n)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Commands Ä‘á»ƒ check:
- `run_terminal_cmd`: `git log --oneline | head -5`
- `run_terminal_cmd`: `git log --all --oneline | wc -l`

Indicators cho "dá»± Ã¡n má»›i":
- âœ… Git log: 0 commits hoáº·c chá»‰ cÃ³ 1 initial commit
- âœ… Commit message: "Initial commit", "Setup project", "First commit"

âœ… Náº¿u git history empty â†’ MEDIUM CONFIDENCE: Dá»± Ã¡n má»›i
âš ï¸ Náº¿u cÃ³ nhiá»u commits â†’ KhÃ´ng pháº£i dá»± Ã¡n má»›i

BÆ¯á»šC 5: DECISION & CONFIRMATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Confidence Levels:
- ğŸ”´ HIGH: User statement + 2+ indicators â†’ Ãp dá»¥ng Hybrid Cáº£i Tiáº¿n Strategy
- ğŸŸ¡ MEDIUM: 2+ indicators â†’ Ãp dá»¥ng Hybrid Cáº£i Tiáº¿n Strategy, confirm vá»›i user
- ğŸŸ¢ LOW: 1 indicator â†’ Há»i user Ä‘á»ƒ confirm

AI PHáº¢I nÃ³i vá»›i user:
"ğŸ” Auto-Detection: TÃ´i detect Ä‘Ã¢y lÃ  dá»± Ã¡n má»›i vÃ¬:
- [Indicator 1]
- [Indicator 2]
- [Indicator 3]

â†’ Ãp dá»¥ng Hybrid Cáº£i Tiáº¿n Strategy (tá»‘i Æ°u ROI dÃ i háº¡n: +35.8%)

Báº¡n xÃ¡c nháº­n Ä‘Ãºng khÃ´ng? Hoáº·c báº¡n muá»‘n Ä‘iá»u chá»‰nh gÃ¬ khÃ´ng?"
```

---

### ğŸš€ **HYBRID Cáº¢I TIáº¾N STRATEGY - Lá»™ TrÃ¬nh Chi Tiáº¿t**

**Chiáº¿n lÆ°á»£c:** Tá»‘i Æ°u ROI dÃ i háº¡n (ROI 2 nÄƒm: +35.8%)

**Lá»™ trÃ¬nh Hybrid Cáº£i Tiáº¿n:**

```
BÆ¯á»šC 0: CONTEXT UNDERSTANDING (NgÃ y 1-2)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ§  Memory: TÃ¬m patterns tá»« past projects
  â†’ mcp_memory_retrieve_memory("dá»± Ã¡n má»›i architecture patterns")
- ğŸŒ Web Search: Latest best practices (2024-2025)
  â†’ web_search("React Next.js 2024 best practices architecture")
- ğŸ“Š Research: Tech stack, framework versions, architecture patterns
- ğŸ“‹ Setup: Project structure, naming conventions, coding standards

BÆ¯á»šC 1: ARCHITECTURE DESIGN (NgÃ y 3-5)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ—„ï¸ Database: Design schema (tables, relationships, indexes)
- ğŸ”Œ API: Design endpoints (RESTful, error handling, validation)
- ğŸ¨ UI: Design wireframes/mockups (khÃ´ng code - chá»‰ design)
- ğŸ“¦ Structure: Folder structure, naming conventions
- ğŸ” Security: Design security architecture (7 Layers Security)
  - Authentication strategy (JWT + refresh token)
  - Authorization strategy (RBAC)
  - Encryption strategy (Field-Level Encryption cho sensitive fields)
  - Data Masking strategy (theo role)
  - Rate Limiting strategy (100 req/min/user)
  - Audit Logging strategy
  - HTTPS/TLS configuration
- âš¡ Performance: Design performance architecture
  - Cache strategy (smart cache, TTL-based)
  - Code splitting strategy
  - Resource optimization strategy
  - MacBook compatibility (development)
  - Linux deployment strategy (production)
  - Port vÃ  network configuration

â†’ ğŸš¨ MCP Round 1: Approve architecture design
â†’ â¸ï¸ WAIT for design approval

BÆ¯á»šC 2: UI WIREFRAMES (NgÃ y 6-7)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ¨ Táº¡o wireframes/mockups (khÃ´ng code - chá»‰ design)
- âœ… Validate UX vá»›i user
- ğŸ“ Design component structure
- ğŸ¨ Design style guide (colors, typography, spacing)

â†’ ğŸš¨ MCP Round 2A: Approve UI wireframes
â†’ â¸ï¸ WAIT for wireframes approval

BÆ¯á»šC 3: DATABASE FOUNDATION (NgÃ y 8-9)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ—„ï¸ Create migration (tables, relationships, indexes)
- ğŸ“Š Seed data (dev/test data)
- âœ… Verify database
  â†’ ğŸ˜ PostgreSQL MCP: list_tables (verify tables created)
  â†’ ğŸ˜ PostgreSQL MCP: get_table_schema (verify structure)
  â†’ ğŸ˜ PostgreSQL MCP: get_table_relationships (verify foreign keys)
  â†’ ğŸ˜ PostgreSQL MCP: execute_sql (test queries)

BÆ¯á»šC 4: API BACKEND CORE (NgÃ y 10-12)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ”Œ Core endpoints (CRUD operations)
- ğŸ” Authentication (JWT + refresh token, password hashing)
- ğŸ”’ Authorization (RBAC implementation)
- ğŸ” Field-Level Encryption (AES-256-GCM cho email, phone, address)
- ğŸ” Data Masking (che giáº¥u data theo role)
- ğŸ›¡ï¸ Rate Limiting (100 requests/phÃºt/user)
- ğŸ“ Audit Logging (log sensitive operations)
- âœ… Validation (input validation, error handling)
- ğŸ“¦ Type generation (TypeScript types tá»« schema)
- ğŸ“ API documentation (Swagger/OpenAPI)
- âš¡ Performance optimization:
  - Smart caching (TTL-based, khÃ´ng quÃ¡)
  - Query optimization (N+1 queries prevention)
  - Response time optimization (<2s target)

â†’ ğŸš¨ MCP Round 3: Approve backend implementation
â†’ â¸ï¸ WAIT for backend approval

**ğŸ§ª TEST INTEGRATION: BE â†” DB (Sau khi code xong)**
- âœ… Test BE káº¿t ná»‘i DB thÃ nh cÃ´ng (connection test)
- âœ… Test CRUD operations (CREATE, READ, UPDATE, DELETE)
- âœ… Test queries vá»›i foreign keys (relationships)
- âœ… Test error handling (invalid data, database errors)
- âœ… Test transactions (rollback náº¿u cÃ³ lá»—i)
- ğŸ“Š Verify data integrity (constraints, validations)

BÆ¯á»šC 5: FRONTEND FOUNDATION (NgÃ y 13-16)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ¨ Components theo mockups (layout, common components)
- ğŸ“¡ API client (fetch wrapper, error handling, loading states)
- ğŸ”„ State management (Context API / Zustand)
- ğŸ—ºï¸ Routing (Next.js App Router, protected routes)
- ğŸ¨ Styling system (TailwindCSS, CSS modules, etc.)
- ğŸ” Security components:
  - Display Masking component (mask email, phone, amount)
  - Token handling (secure token storage)
  - Authentication UI (login, logout, token refresh)
- âš¡ Performance optimization:
  - Code splitting vÃ  lazy loading
  - Image optimization
  - Resource optimization (tá»‘i Æ°u tÃ i nguyÃªn thiáº¿t bá»‹)
  - Cache thÃ´ng minh (load nhanh nhÆ°ng khÃ´ng quÃ¡)
  - Load time optimization (<3s target)

â†’ ğŸš¨ MCP Round 4: Approve frontend foundation
â†’ â¸ï¸ WAIT for frontend approval

**ğŸ§ª TEST INTEGRATION: FE â†” BE (Sau khi code xong)**
- âœ… Test FE káº¿t ná»‘i BE thÃ nh cÃ´ng (API calls)
- âœ… Test GET requests (láº¥y data tá»« BE)
- âœ… Test POST/PUT/DELETE requests (gá»­i data lÃªn BE)
- âœ… Test error handling (network errors, API errors)
- âœ… Test loading states (spinner, skeleton)
- âœ… Test authentication (JWT tokens, protected routes)
- ğŸ“Š Verify data flow FE â†’ BE â†’ DB (end-to-end cho 1-2 flows cÆ¡ báº£n)

BÆ¯á»šC 6: FEATURE DEVELOPMENT (NgÃ y 17+)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Má»—i feature: Hybrid approach (FE + BE refinement song song)
- ğŸš¨ MCP Round 1: Feature design approval (BEFORE code)
- ğŸš¨ MCP Round 2: Feature implementation approval (AFTER code)
- ğŸ”„ Iterate: FE + BE refinement based on feedback

**ğŸ§ª TEST INTEGRATION: FE â†” BE â†” DB (Sau má»—i feature)**
- âœ… Test toÃ n bá»™ flow: FE â†’ BE â†’ DB â†’ BE â†’ FE
- âœ… Test feature-specific CRUD operations
- âœ… Test data validation (FE validation + BE validation + DB constraints)
- âœ… Test error scenarios (network, API errors, DB errors)
- âœ… Test edge cases (empty data, large data, special characters)
- ğŸ“Š Verify data consistency (FE state = BE response = DB data)

**ğŸ§ª END-TO-END TEST - CUá»I Lá»˜ TRÃŒNH (Sau khi hoÃ n thÃ nh táº¥t cáº£ features)**
- âœ… Test toÃ n bá»™ há»‡ thá»‘ng: FE â†” BE â†” DB (táº¥t cáº£ flows)
- âœ… Test user journeys (tá»«ng bÆ°á»›c ngÆ°á»i dÃ¹ng thá»±c hiá»‡n)
- âœ… Test performance (response time, load time)
- âœ… Test security (authentication, authorization, data protection)
- âœ… Test data integrity toÃ n há»‡ thá»‘ng (consistency checks)
- âœ… Test error recovery (tá»± Ä‘á»™ng phá»¥c há»“i sau lá»—i)
- ğŸ“Š Verify há»‡ thá»‘ng hoáº¡t Ä‘á»™ng á»•n Ä‘á»‹nh (stress test, load test)

BÆ¯á»šC 7: DEPLOYMENT & PRODUCTION SETUP (Sau khi hoÃ n thÃ nh MVP)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ³ Docker setup (containers, docker-compose, multi-stage builds)
- â˜ï¸ Hosting setup (AWS/Vercel/Heroku/Railway/etc.)
  - Server configuration
  - Domain setup
  - SSL certificates (HTTPS)
- ğŸ”„ CI/CD pipeline (GitHub Actions/GitLab CI/Jenkins)
  - Automated testing
  - Automated build
  - Automated deployment
- ğŸ” Environment variables (production secrets, configs)
  - Secure storage (AWS Secrets Manager, Vault)
  - Different configs for dev/staging/production
- ğŸ“ Deployment documentation
  - Deployment guide
  - Rollback procedures
  - Environment setup guide
- âœ… Production deployment test
  - Test deployment process
  - Test rollback process
  - Verify production environment

â†’ ğŸš¨ MCP Round 5: Approve deployment setup
â†’ â¸ï¸ WAIT for deployment approval

**ğŸ§ª TEST DEPLOYMENT (Sau khi deploy)**
- âœ… Test app cháº¡y trÃªn production server
- âœ… Test HTTPS/SSL certificates
- âœ… Test domain vÃ  DNS
- âœ… Test environment variables
- âœ… Test database connection trÃªn production
- âœ… Test API endpoints trÃªn production
- ğŸ“Š Verify deployment successful (health checks)

BÆ¯á»šC 8: MONITORING & DOCUMENTATION (Sau deployment)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ“Š Error tracking (Sentry, LogRocket, Rollbar)
  - Track errors in real-time
  - Error notifications
  - Error analytics
- ğŸ“ˆ Performance monitoring (New Relic, Datadog, APM tools)
  - Response time monitoring
  - Server resource monitoring (CPU, memory, disk)
  - Database query performance
  - API endpoint performance
- ğŸ“ Logging system (structured logs)
  - Centralized logging (ELK stack, CloudWatch, etc.)
  - Log levels (info, warning, error)
  - Log rotation vÃ  retention
- ğŸ“– User documentation
  - User manual
  - Feature guides
  - FAQ
  - Video tutorials (náº¿u cáº§n)
- ğŸ“– Developer documentation
  - Setup guide (local development)
  - Deployment guide
  - Architecture documentation
  - API documentation (Swagger/OpenAPI)
  - Code contribution guide
- ğŸ”’ Security audit
  - Vulnerability scanning (OWASP, Snyk, etc.)
  - Security best practices review
  - Penetration testing (náº¿u cáº§n)
- âš¡ Performance optimization
  - Caching strategy (Redis, CDN)
  - Database query optimization
  - Image optimization
  - Code splitting vÃ  lazy loading
  - CDN setup cho static assets

â†’ ğŸš¨ MCP Round 6: Approve monitoring setup
â†’ â¸ï¸ WAIT for monitoring approval

**ğŸ§ª TEST MONITORING (Sau khi setup)**
- âœ… Test error tracking (trigger test error)
- âœ… Test performance monitoring (check metrics)
- âœ… Test logging (verify logs captured)
- âœ… Test alerts/notifications (test alert system)
- âœ… Test documentation (verify docs accessible)
- ğŸ“Š Verify monitoring system hoáº¡t Ä‘á»™ng Ä‘Ãºng
```

**Táº¡i sao chiáº¿n lÆ°á»£c nÃ y tá»‘i Æ°u ROI:**

1. **Wireframes trÆ°á»›c** â†’ Validate UX sá»›m (tiáº¿t kiá»‡m 12 ngÃ y refactor UX)
2. **Database foundation** â†’ Ná»n táº£ng vá»¯ng (tiáº¿t kiá»‡m 15 ngÃ y migration refactor)
3. **API core** â†’ Interface rÃµ (tiáº¿t kiá»‡m 10 ngÃ y API refactor)
4. **Frontend foundation** â†’ Components sáºµn sÃ ng (tiáº¿t kiá»‡m 18 ngÃ y component refactor)
5. **Feature development** â†’ Hybrid approach (nhanh hÆ¡n 30% so vá»›i tuáº§n tá»±)
6. **Deployment setup** â†’ Sáºµn sÃ ng production (tiáº¿t kiá»‡m 8 ngÃ y manual deployment)
7. **Monitoring setup** â†’ Catch issues sá»›m (tiáº¿t kiá»‡m 12 ngÃ y debugging production issues)

**Timeline:**
- Ngáº¯n háº¡n (1-2 tuáº§n): Foundation + 1-2 features core
- Trung háº¡n (1-2 thÃ¡ng): MVP vá»›i Ä‘á»§ features
- DÃ i háº¡n (3-6 thÃ¡ng): Production-ready vá»›i optimization + deployment + monitoring

**ROI Calculation:**
- Chi phÃ­ ban Ä‘áº§u: 16 ngÃ y (Foundation)
- Chi phÃ­ features: 45 ngÃ y (10 features)
- Chi phÃ­ deployment: 8 ngÃ y (BÆ°á»›c 7)
- Chi phÃ­ monitoring: 6 ngÃ y (BÆ°á»›c 8)
- Chi phÃ­ báº£o trÃ¬ (6 thÃ¡ng): 14 ngÃ y
- **Tá»•ng chi phÃ­: 89 ngÃ y**
- Lá»£i Ã­ch (6 thÃ¡ng): 55 ngÃ y (tá»« Foundation) + 20 ngÃ y (tá»« deployment/monitoring)
- **ROI (2 nÄƒm): +35.8%** âœ… (tÄƒng lá»£i Ã­ch tá»« monitoring setup)

---

### ğŸ¯ **DECISION TREE - CÃ¢y Quyáº¿t Äá»‹nh**

```
Báº¯t Ä‘áº§u task
   â†“
ğŸ” Auto-Detection (Kiá»ƒm tra user statement, codebase, database, git)
   â†“
â”œâ”€ ğŸ†• LÃ€M Má»šI HOÃ€N TOÃ€N?
â”‚  â””â”€ â†’ Hybrid Cáº£i Tiáº¿n Strategy
â”‚     - Lá»™ trÃ¬nh: Wireframes â†’ Database â†’ API â†’ Frontend â†’ Deployment â†’ Monitoring
â”‚     - MCP Rounds: 6 (Design, Wireframes, Backend, Frontend, Deployment, Monitoring)
â”‚     - Timeline: 16 ngÃ y foundation + feature development + 14 ngÃ y production-ready
â”‚     - ROI: +35.8% (2 nÄƒm) - Production-ready vá»›i deployment & monitoring
â”‚
â”œâ”€ â• THÃŠM TÃNH NÄ‚NG Má»šI?
â”‚  â””â”€ â†’ Hybrid Approach Strategy (Full-Stack Parallel + API-First)
â”‚     - Lá»™ trÃ¬nh: Context â†’ Design â†’ Parallel Implementation â†’ Integration
â”‚     - MCP Rounds: 2 (BEFORE + AFTER code)
â”‚     - Timeline: 7 ngÃ y (1 design + 5 parallel + 1 integration)
â”‚     - ROI: +30% (vs tuáº§n tá»±)
â”‚
â””â”€ KhÃ´ng pháº£i dá»± Ã¡n má»›i hoáº·c thÃªm tÃ­nh nÄƒng?
   â””â”€ â†’ Ãp dá»¥ng Universal Workflow (Version 4.0)
      - MCP Rounds: 2 (BEFORE + AFTER code)
      - Ãp dá»¥ng cho: Sá»­a tÃ­nh nÄƒng, refactor, bug fix, v.v.
```

---

### âœ… **TÆ¯Æ NG THÃCH Vá»šI VERSION 4.0**

**Äáº£m báº£o khÃ´ng mÃ¢u thuáº«n:**
- âœ… **Giá»¯ nguyÃªn Version 4.0:** Má»i task â†’ 2 rounds MCP (BEFORE + AFTER code)
- âœ… **Giá»¯ nguyÃªn MCP tools ecosystem:** Memory, PostgreSQL MCP, Interactive Feedback
- âœ… **Giá»¯ nguyÃªn Universal Workflow:** BÆ°á»›c 0-6 váº«n Ã¡p dá»¥ng
- âœ… **Bá»• sung thÃªm:** Chiáº¿n lÆ°á»£c code cho dá»± Ã¡n má»›i, khÃ´ng thay tháº¿

**CÃ¡ch hoáº¡t Ä‘á»™ng:**
- Chiáº¿n lÆ°á»£c code chá»‰ Ä‘á»‹nh lá»™ trÃ¬nh (timeline, thá»© tá»±) cho dá»± Ã¡n má»›i
- MCP Rounds váº«n Ã¡p dá»¥ng cho má»—i bÆ°á»›c trong lá»™ trÃ¬nh
- Universal Workflow váº«n cháº¡y cho má»—i task nhá»

**VÃ­ dá»¥:**
```
Dá»± Ã¡n má»›i â†’ Hybrid Cáº£i Tiáº¿n
  â†’ BÆ°á»›c 1: Architecture Design
    â†’ MCP Round 1: Approve design (Version 4.0)
  â†’ BÆ°á»›c 2: UI Wireframes
    â†’ MCP Round 2A: Approve wireframes (Version 4.0)
  â†’ BÆ°á»›c 4: API Backend
    â†’ MCP Round 3: Approve backend (Version 4.0)
  â†’ BÆ°á»›c 5: Frontend Foundation
    â†’ MCP Round 4: Approve frontend (Version 4.0)
  â†’ BÆ°á»›c 6: Feature Development
    â†’ Má»—i feature: MCP Round 1 + Round 2 (Version 4.0)
```

---

## ğŸ¯ Code Strategy - Chiáº¿n lÆ°á»£c Code (ThÃªm TÃ­nh NÄƒng Má»›i)

### ğŸ“‹ **TRÆ¯á»œNG Há»¢P: THÃŠM TÃNH NÄ‚NG Má»šI VÃ€O Dá»° ÃN HIá»†N CÃ“**

**Khi nÃ o Ã¡p dá»¥ng:**
- âœ… Dá»± Ã¡n Ä‘Ã£ cÃ³ code, database, API, frontend
- âœ… ThÃªm feature má»›i vÃ o há»‡ thá»‘ng Ä‘ang hoáº¡t Ä‘á»™ng
- âœ… Má»Ÿ rá»™ng tÃ­nh nÄƒng hiá»‡n cÃ³
- âœ… Cáº§n integrate vá»›i code cÅ©

**Chiáº¿n lÆ°á»£c:** **Hybrid Approach** - Full-Stack Parallel + API-First Design (ROI: +30%)

---

### ğŸ” **AUTO-DETECTION MECHANISM - Nháº­n Biáº¿t Tá»± Äá»™ng**

AI PHáº¢I tá»± Ä‘á»™ng nháº­n biáº¿t khi nÃ o lÃ  "ThÃªm tÃ­nh nÄƒng má»›i" trÆ°á»›c khi Ã¡p dá»¥ng chiáº¿n lÆ°á»£c:

```markdown
## ğŸ” AUTO-DETECTION RULES - THÃŠM TÃNH NÄ‚NG Má»šI:

### Detection Logic (AI MUST check):
1. **User statement:**
   - âœ… Keywords: "thÃªm tÃ­nh nÄƒng", "add feature", "táº¡o feature má»›i", "new feature"
   - âœ… Keywords: "má»Ÿ rá»™ng tÃ­nh nÄƒng", "extend feature", "thÃªm chá»©c nÄƒng"
   - âœ… Keywords: "implement feature", "tÃ­nh nÄƒng má»›i"
   - âœ… User override: "ÄÃ¢y lÃ  tÃ­nh nÄƒng má»›i" â†’ Bá» qua auto-detection, Ã¡p dá»¥ng ngay

2. **Codebase state:**
   - âœ… ÄÃ£ cÃ³ code (src/, components/, services/, controllers/)
   - âœ… ÄÃ£ cÃ³ database tables (PostgreSQL MCP: `list_tables` â†’ cÃ³ tables)
   - âœ… ÄÃ£ cÃ³ API endpoints (cÃ³ routes, controllers)
   - âœ… ÄÃ£ cÃ³ frontend components (cÃ³ components, pages)

3. **Feature scope:**
   - âœ… Feature má»›i (chÆ°a cÃ³ trong codebase)
   - âœ… Cáº§n integrate vá»›i code cÅ©
   - âœ… CÃ³ thá»ƒ cáº§n database changes (new tables/columns)
   - âœ… CÃ³ thá»ƒ cáº§n API changes (new endpoints)
   - âœ… CÃ³ thá»ƒ cáº§n UI changes (new components/pages)

### Detection Priority:
1. Check user statement keywords FIRST (highest priority)
2. Check codebase state SECOND
3. Check feature scope THIRD

### Confidence Levels:
- ğŸ”´ **HIGH CONFIDENCE:** User statement + codebase cÃ³ sáºµn â†’ Ãp dá»¥ng Hybrid Approach ngay
- ğŸŸ¡ **MEDIUM CONFIDENCE:** Codebase cÃ³ sáºµn + feature má»›i â†’ Ãp dá»¥ng Hybrid Approach, confirm vá»›i user
- ğŸŸ¢ **LOW CONFIDENCE:** 1 indicator â†’ Há»i user Ä‘á»ƒ confirm

### User Override:
- User cÃ³ thá»ƒ override: "ÄÃ¢y lÃ  tÃ­nh nÄƒng má»›i" hoáº·c "ÄÃ¢y lÃ  sá»­a tÃ­nh nÄƒng"
- AI PHáº¢I follow user instruction náº¿u user chá»‰ Ä‘á»‹nh rÃµ rÃ ng
```

### ğŸ¯ **AUTO-DETECTION WORKFLOW - Quy TrÃ¬nh Nháº­n Biáº¿t Tá»± Äá»™ng**

**AI PHáº¢I thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau TRÆ¯á»šC KHI báº¯t Ä‘áº§u task:**

```
BÆ¯á»šC 1: CHECK USER STATEMENT (Æ¯u tiÃªn cao nháº¥t)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Keywords Ä‘á»ƒ detect "thÃªm tÃ­nh nÄƒng má»›i":
- "thÃªm tÃ­nh nÄƒng", "add feature", "táº¡o feature má»›i", "new feature"
- "má»Ÿ rá»™ng tÃ­nh nÄƒng", "extend feature", "thÃªm chá»©c nÄƒng"
- "implement feature", "tÃ­nh nÄƒng má»›i"

âœ… Náº¿u user statement cÃ³ keywords nÃ y â†’ HIGH CONFIDENCE: ThÃªm tÃ­nh nÄƒng má»›i
âš ï¸ Náº¿u khÃ´ng cÃ³ keywords â†’ Tiáº¿p tá»¥c BÆ¯á»šC 2

BÆ¯á»šC 2: CHECK CODEBASE STATE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Commands Ä‘á»ƒ check:
- `list_dir` â†’ Xem file structure
- `glob_file_search` â†’ TÃ¬m source files (*.ts, *.js, *.py, etc.)
- ğŸ˜ PostgreSQL MCP: `list_tables` â†’ Check cÃ³ tables khÃ´ng
- `grep` â†’ TÃ¬m existing routes, controllers, components

Indicators cho "dá»± Ã¡n Ä‘Ã£ cÃ³ code":
- âœ… ÄÃ£ cÃ³ folders: src/, app/, components/, controllers/, services/
- âœ… ÄÃ£ cÃ³ source files (nhiá»u hÆ¡n 5 files)
- âœ… PostgreSQL MCP: `list_tables` â†’ CÃ³ tables
- âœ… ÄÃ£ cÃ³ API endpoints (cÃ³ routes, controllers)
- âœ… ÄÃ£ cÃ³ frontend components (cÃ³ components, pages)

âœ… Náº¿u codebase state nhÆ° trÃªn â†’ MEDIUM CONFIDENCE: ThÃªm tÃ­nh nÄƒng má»›i
âš ï¸ Náº¿u codebase empty â†’ KhÃ´ng pháº£i thÃªm tÃ­nh nÄƒng má»›i, cÃ³ thá»ƒ lÃ  dá»± Ã¡n má»›i

BÆ¯á»šC 3: CHECK FEATURE SCOPE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Commands Ä‘á»ƒ check:
- `grep` â†’ TÃ¬m feature name trong codebase
- `codebase_search` â†’ Search for existing feature implementation

Indicators cho "feature má»›i":
- âœ… Feature name chÆ°a cÃ³ trong codebase
- âœ… Cáº§n integrate vá»›i code cÅ©
- âœ… CÃ³ thá»ƒ cáº§n database changes (new tables/columns)
- âœ… CÃ³ thá»ƒ cáº§n API changes (new endpoints)
- âœ… CÃ³ thá»ƒ cáº§n UI changes (new components/pages)

âœ… Náº¿u feature scope nhÆ° trÃªn â†’ HIGH CONFIDENCE: ThÃªm tÃ­nh nÄƒng má»›i
âš ï¸ Náº¿u feature Ä‘Ã£ cÃ³ â†’ KhÃ´ng pháº£i thÃªm tÃ­nh nÄƒng má»›i, cÃ³ thá»ƒ lÃ  sá»­a tÃ­nh nÄƒng

BÆ¯á»šC 4: DECISION & CONFIRMATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Confidence Levels:
- ğŸ”´ HIGH: User statement + codebase cÃ³ sáºµn â†’ Ãp dá»¥ng Hybrid Approach Strategy
- ğŸŸ¡ MEDIUM: Codebase cÃ³ sáºµn + feature má»›i â†’ Ãp dá»¥ng Hybrid Approach Strategy, confirm vá»›i user
- ğŸŸ¢ LOW: 1 indicator â†’ Há»i user Ä‘á»ƒ confirm

AI PHáº¢I nÃ³i vá»›i user:
"ğŸ” Auto-Detection: TÃ´i detect Ä‘Ã¢y lÃ  thÃªm tÃ­nh nÄƒng má»›i vÃ¬:
- [Indicator 1]
- [Indicator 2]
- [Indicator 3]

â†’ Ãp dá»¥ng Hybrid Approach Strategy (Full-Stack Parallel + API-First Design)
  - ROI: +30% (vs tuáº§n tá»±)
  - Timeline: 7 ngÃ y (1 design + 5 parallel + 1 integration)

Báº¡n xÃ¡c nháº­n Ä‘Ãºng khÃ´ng? Hoáº·c báº¡n muá»‘n Ä‘iá»u chá»‰nh gÃ¬ khÃ´ng?"
```

---

### ğŸš€ **HYBRID APPROACH STRATEGY - Lá»™ TrÃ¬nh Chi Tiáº¿t**

**Chiáº¿n lÆ°á»£c:** Full-Stack Parallel + API-First Design (ROI: +30%)

**Lá»™ trÃ¬nh Hybrid Approach:**

```
BÆ¯á»šC 1: CONTEXT UNDERSTANDING (NgÃ y 1)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ§  Memory: TÃ¬m patterns tá»« past features
  â†’ mcp_memory_retrieve_memory("feature [feature-name] patterns")
- ğŸ˜ PostgreSQL MCP: Analyze existing schema
  â†’ list_tables (xem tables hiá»‡n cÃ³)
  â†’ get_table_schema (hiá»ƒu cáº¥u trÃºc)
  â†’ get_table_relationships (hiá»ƒu foreign keys)
  â†’ get_table_stats (statistics náº¿u cáº§n)
- ğŸ“Š Research: Existing API patterns, UI components
- ğŸ“‹ Understand: Feature requirements, dependencies, integration points

BÆ¯á»šC 2: DESIGN PHASE (NgÃ y 1-2)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ¨ UI Wireframes/Mockups (náº¿u UX-critical)
- ğŸ”Œ API Contract Design (OpenAPI/Swagger)
  - New endpoints
  - Request/Response schemas
  - Error handling
- ğŸ—„ï¸ Database Schema Design (náº¿u cáº§n)
  - New tables/columns
  - Relationships
  - Indexes
- ğŸ“ Type definitions (TypeScript types tá»« API contract)

â†’ ğŸš¨ MCP Round 1: Approve design (API + UI + DB)
â†’ â¸ï¸ WAIT for design approval

BÆ¯á»šC 3: IMPLEMENTATION (PARALLEL) (NgÃ y 2-6)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Backend: Implement API + Database theo contract
  - Create migration (náº¿u cáº§n)
  - Implement endpoints
  - Add validation
  - Add error handling
  - Test API (Postman/curl)

**ğŸ§ª TEST INTEGRATION: BE â†” DB (Sau khi code backend xong)**
- âœ… Test BE káº¿t ná»‘i DB thÃ nh cÃ´ng (connection test)
- âœ… Test CRUD operations cá»§a feature (CREATE, READ, UPDATE, DELETE)
- âœ… Test queries vá»›i foreign keys (relationships má»›i)
- âœ… Test error handling (invalid data, database errors)
- âœ… Test transactions (rollback náº¿u cÃ³ lá»—i)
- ğŸ“Š Verify data integrity (constraints, validations)

- Frontend: Implement UI vá»›i generated types
  - Create components theo wireframes
  - Consume API vá»›i generated types
  - Add loading states
  - Add error handling
  - Test UI (manual/browser)
- Both teams work simultaneously

BÆ¯á»šC 4: INTEGRATION (NgÃ y 6-7)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Replace mock data vá»›i real API
- Integration testing
- Fix integration issues
- Verify end-to-end flow

**ğŸ§ª TEST INTEGRATION: FE â†” BE â†” DB (Sau khi integration xong)**
- âœ… Test toÃ n bá»™ flow: FE â†’ BE â†’ DB â†’ BE â†’ FE
- âœ… Test feature-specific CRUD operations
- âœ… Test data validation (FE validation + BE validation + DB constraints)
- âœ… Test error scenarios (network, API errors, DB errors)
- âœ… Test edge cases (empty data, large data, special characters)
- âœ… Test authentication/authorization (náº¿u feature cÃ³)
- ğŸ“Š Verify data consistency (FE state = BE response = DB data)

â†’ ğŸš¨ MCP Round 2: Approve implementation
â†’ â¸ï¸ WAIT for code approval

BÆ¯á»šC 5: REFINEMENT (NgÃ y 7+)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- UX refinement based on feedback
- API optimization if needed
- Performance tuning
- Documentation update
```

**Táº¡i sao chiáº¿n lÆ°á»£c nÃ y tá»‘i Æ°u ROI:**

1. **Context Understanding** â†’ Hiá»ƒu code cÅ© trÆ°á»›c (tiáº¿t kiá»‡m 2 ngÃ y refactor)
2. **API Contract Design** â†’ API contract rÃµ rÃ ng (tiáº¿t kiá»‡m 2 ngÃ y integration issues)
3. **Parallel Implementation** â†’ FE + BE song song (tiáº¿t kiá»‡m 3 ngÃ y vs tuáº§n tá»±)
4. **Type Safety** â†’ Generated types (tiáº¿t kiá»‡m 1 ngÃ y bug fixes)
5. **Integration Testing** â†’ Catch issues sá»›m (tiáº¿t kiá»‡m 2 ngÃ y debugging)
6. **Test Integration BE â†” DB** â†’ Verify backend hoáº¡t Ä‘á»™ng Ä‘Ãºng (tiáº¿t kiá»‡m 1 ngÃ y debugging)
7. **Test Integration FE â†” BE â†” DB** â†’ Verify end-to-end flow (tiáº¿t kiá»‡m 1 ngÃ y integration issues)

**Timeline:**
- Ngáº¯n háº¡n (1 tuáº§n): Simple feature (1-2 endpoints, 1-2 pages)
- Trung háº¡n (2 tuáº§n): Medium feature (3-5 endpoints, 3-5 pages)
- DÃ i háº¡n (3-4 tuáº§n): Complex feature (5+ endpoints, 5+ pages, complex logic)

**ROI Calculation:**
- Backend-First: 10 ngÃ y (5 BE + 5 FE)
- Frontend-First: 10 ngÃ y (5 FE + 5 BE)
- Hybrid Approach: 7 ngÃ y (1 design + 5 parallel + 1 integration)
- **ROI: +30%** âœ… (tiáº¿t kiá»‡m 3 ngÃ y má»—i feature)

---

### âœ… **TÆ¯Æ NG THÃCH Vá»šI VERSION 4.0**

**Äáº£m báº£o khÃ´ng mÃ¢u thuáº«n:**
- âœ… **Giá»¯ nguyÃªn Version 4.0:** Má»i task â†’ 2 rounds MCP (BEFORE + AFTER code)
- âœ… **Giá»¯ nguyÃªn MCP tools ecosystem:** Memory, PostgreSQL MCP, Interactive Feedback
- âœ… **Giá»¯ nguyÃªn Universal Workflow:** BÆ°á»›c 0-6 váº«n Ã¡p dá»¥ng
- âœ… **Bá»• sung thÃªm:** Chiáº¿n lÆ°á»£c code cho thÃªm tÃ­nh nÄƒng má»›i, khÃ´ng thay tháº¿

**CÃ¡ch hoáº¡t Ä‘á»™ng:**
- Chiáº¿n lÆ°á»£c code chá»‰ Ä‘á»‹nh lá»™ trÃ¬nh (timeline, thá»© tá»±) cho thÃªm tÃ­nh nÄƒng má»›i
- MCP Rounds váº«n Ã¡p dá»¥ng cho má»—i bÆ°á»›c trong lá»™ trÃ¬nh
- Universal Workflow váº«n cháº¡y cho má»—i task nhá»

**VÃ­ dá»¥:**
```
ThÃªm tÃ­nh nÄƒng má»›i â†’ Hybrid Approach
  â†’ BÆ°á»›c 1: Context Understanding
    â†’ PostgreSQL MCP: Analyze existing schema
  â†’ BÆ°á»›c 2: Design Phase
    â†’ ğŸš¨ MCP Round 1: Approve design (Version 4.0)
  â†’ BÆ°á»›c 3: Parallel Implementation
    â†’ Backend: Implement API
    â†’ Frontend: Implement UI
  â†’ BÆ°á»›c 4: Integration
    â†’ ğŸš¨ MCP Round 2: Approve implementation (Version 4.0)
  â†’ BÆ°á»›c 5: Refinement
```

---

### ğŸ”„ **MULTI-CONVERSATION SUPPORT - Há»— Trá»£ Nhiá»u Cuá»™c TrÃ² Chuyá»‡n**

**Ká»‹ch báº£n:** User chia nhá» cÃ´ng viá»‡c dá»± Ã¡n má»›i thÃ nh nhiá»u conversations:
- Conversation 1: BÆ°á»›c 1 (Architecture Design)
- Conversation 2: BÆ°á»›c 2 (UI Wireframes)
- Conversation 3: BÆ°á»›c 3 (Database Foundation)
- ...

**Váº¥n Ä‘á»:** AI cáº§n nháº­n biáº¿t:
- âœ… "ÄÃ¢y lÃ  bÆ°á»›c tiáº¿p theo cá»§a dá»± Ã¡n má»›i" (khÃ´ng pháº£i dá»± Ã¡n má»›i tá»« Ä‘áº§u)
- âœ… "ÄÃ£ lÃ m Ä‘áº¿n bÆ°á»›c nÃ o rá»“i?"
- âœ… "Cáº§n tiáº¿p tá»¥c tá»« bÆ°á»›c nÃ o?"

**Giáº£i phÃ¡p:** Sá»­ dá»¥ng **Memory Service** Ä‘á»ƒ lÆ°u vÃ  recall thÃ´ng tin giá»¯a cÃ¡c conversations

---

### ğŸ§  **MEMORY SERVICE - CÃ¡ch AI Nhá»› ThÃ´ng Tin Giá»¯a CÃ¡c Conversations**

**Memory Service lÃ  gÃ¬:**
- ğŸ§  **Persistent storage:** LÆ°u thÃ´ng tin vÃ o database (khÃ´ng máº¥t khi conversation káº¿t thÃºc)
- ğŸ” **Semantic search:** TÃ¬m thÃ´ng tin báº±ng semantic search (khÃ´ng cáº§n exact match)
- ğŸ“ **Tag-based search:** TÃ¬m thÃ´ng tin theo tags
- â° **Time-based recall:** TÃ¬m thÃ´ng tin theo thá»i gian ("last week", "yesterday")

**Bá»™ nhá»› lÆ°u á»Ÿ Ä‘Ã¢u:**
- ğŸ—„ï¸ **Persistent Storage:** Database (persistent storage - chÃ­nh)
  - **CÃ³ thá»ƒ lÃ :** PostgreSQL, SQLite, hoáº·c database khÃ¡c (tÃ¹y vÃ o cáº¥u hÃ¬nh MCP Server)
  - **LÆ°u trá»¯:** Content Ä‘áº§y Ä‘á»§ + Metadata + Tags + Embeddings
  - **Vá»‹ trÃ­:** Database server (local hoáº·c cloud) hoáº·c file-based (SQLite)
  - **An toÃ n:** Dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ persistent, khÃ´ng máº¥t khi conversation káº¿t thÃºc
  
- âš¡ **Cache Layer (Optional):** Redis hoáº·c in-memory cache (Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ truy cáº­p)
  - **LÆ°u trá»¯:** Cache cÃ¡c memories thÆ°á»ng dÃ¹ng
  - **Má»¥c Ä‘Ã­ch:** TÄƒng tá»‘c Ä‘á»™ truy xuáº¥t thÃ´ng tin
  - **Tá»± Ä‘á»™ng:** Há»‡ thá»‘ng tá»± Ä‘á»™ng cache khi cáº§n
  
- ğŸ“ **Vá»‹ trÃ­ cá»¥ thá»ƒ:**
  - Memory Service Ä‘Æ°á»£c quáº£n lÃ½ bá»Ÿi MCP Server
  - **Config:** ThÆ°á»ng trong `~/.cursor/mcp.json` hoáº·c environment variables
  - **Database:** Connection string Ä‘Æ°á»£c cáº¥u hÃ¬nh trong MCP config (cÃ³ thá»ƒ lÃ  PostgreSQL, SQLite, hoáº·c database khÃ¡c)
  - **LÆ°u Ã½:** Memory Service lÃ  má»™t MCP Server riÃªng biá»‡t, khÃ´ng phá»¥ thuá»™c vÃ o project code
  - **CÃ¡ch kiá»ƒm tra:** Xem config trong `~/.cursor/mcp.json` Ä‘á»ƒ biáº¿t database type vÃ  connection string

**CÃ¡ch hoáº¡t Ä‘á»™ng:**

```
Conversation 1 (HÃ´m nay):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
User: "Táº¡o dá»± Ã¡n má»›i - há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng"

AI: [Thá»±c hiá»‡n BÆ°á»›c 1: Architecture Design]
    [Sau khi hoÃ n thÃ nh]
    
    â†’ ğŸ§  Store Memory:
       mcp_memory_store_memory({
         content: "Project: há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng. 
                   Strategy: Hybrid Cáº£i Tiáº¿n. 
                   Current step: 1 (Architecture Design - completed). 
                   Next step: 2 (UI Wireframes). 
                   Tech stack: Next.js, PostgreSQL. 
                   Architecture: RESTful API, normalized schema",
         metadata: {
           tags: ["há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng", "dá»± Ã¡n má»›i", "progress", "step-1"],
           type: "project_progress"
         }
       })
    
    âœ… Memory Ä‘Ã£ Ä‘Æ°á»£c lÆ°u vÃ o database (persistent)

Conversation 2 (NgÃ y mai - Conversation má»›i):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
User: "Tiáº¿p tá»¥c dá»± Ã¡n quáº£n lÃ½ khÃ¡ch hÃ ng"

AI: [Tá»± Ä‘á»™ng gá»i Memory Service TRÆ¯á»šC KHI lÃ m gÃ¬]
    
    â†’ ğŸ§  Recall Memory:
       mcp_memory_retrieve_memory("há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng project progress")
       HOáº¶C
       mcp_memory_search_by_tag(["há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng", "dá»± Ã¡n má»›i", "progress"])
    
    â†’ âœ… TÃ¬m tháº¥y memory:
       "Project: há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng. 
        Current step: 1 (completed). 
        Next step: 2 (UI Wireframes). 
        Tech stack: Next.js, PostgreSQL"
    
    â†’ AI: "ğŸ§  Memory: TÃ¬m tháº¥y project progress
           â†’ Project: 'há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng'
           â†’ ÄÃ£ hoÃ n thÃ nh: BÆ°á»›c 1 (Architecture Design)
           â†’ BÆ°á»›c tiáº¿p theo: BÆ°á»›c 2 (UI Wireframes)
           
           Báº¡n muá»‘n tiáº¿p tá»¥c tá»« BÆ°á»›c 2 khÃ´ng?"
```

**Memory Tools:**
- `mcp_memory_store_memory` - LÆ°u thÃ´ng tin vÃ o Memory
- `mcp_memory_retrieve_memory` - TÃ¬m thÃ´ng tin báº±ng semantic search
- `mcp_memory_search_by_tag` - TÃ¬m thÃ´ng tin theo tags
- `mcp_memory_recall_memory` - TÃ¬m thÃ´ng tin theo thá»i gian

**Memory Tags Structure (cho dá»± Ã¡n má»›i):**
- `[project-name]` - TÃªn dá»± Ã¡n (vÃ­ dá»¥: "há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng")
- `dá»± Ã¡n má»›i` - Strategy type
- `progress` - Progress tracking
- `step-1`, `step-2`, etc. - Step numbers
- `architecture-design`, `ui-wireframes`, etc. - Step names

**âš ï¸ QUAN TRá»ŒNG:** Memory Service lÃ  **persistent** - thÃ´ng tin khÃ´ng máº¥t khi conversation káº¿t thÃºc!

---

### ğŸ” **AUTO-DETECTION: Dá»± Ãn Má»›i vs BÆ°á»›c Tiáº¿p Theo**

**AI PHáº¢I tá»± Ä‘á»™ng nháº­n biáº¿t TRÆ¯á»šC KHI báº¯t Ä‘áº§u conversation má»›i:**

```markdown
## ğŸ” DETECTION LOGIC - Multi-Conversation:

### Khi báº¯t Ä‘áº§u conversation má»›i (BÆ¯á»šC 0 - Memory Auto-Load):

BÆ¯á»šC 0: MEMORY AUTO-LOAD (Tá»± Ä‘á»™ng - TRÆ¯á»šC Má»ŒI THá»¨)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš ï¸ QUAN TRá»ŒNG: AI PHáº¢I tá»± Ä‘á»™ng gá»i Memory Service NGAY KHI báº¯t Ä‘áº§u conversation má»›i!

1. **Extract project name tá»« user statement:**
   - User: "Tiáº¿p tá»¥c dá»± Ã¡n quáº£n lÃ½ khÃ¡ch hÃ ng" â†’ Project name: "quáº£n lÃ½ khÃ¡ch hÃ ng"
   - User: "Tiáº¿p tá»¥c dá»± Ã¡n" â†’ Check codebase/workspace Ä‘á»ƒ infer project name
   - User: "Dá»± Ã¡n má»›i" â†’ KhÃ´ng cÃ³ project name â†’ Skip memory check

2. **Gá»i Memory Service:**
   ```typescript
   // Option 1: Semantic search
   mcp_memory_retrieve_memory("[project-name] project progress dá»± Ã¡n má»›i")
   
   // Option 2: Tag-based search (recommended)
   mcp_memory_search_by_tag(["project-name", "dá»± Ã¡n má»›i", "progress"])
   
   // Option 3: Time-based recall (náº¿u cáº§n)
   mcp_memory_recall_memory("project progress last week")
   ```

3. **Náº¿u tÃ¬m tháº¥y memory:**
   âœ… "ÄÃ¢y lÃ  bÆ°á»›c tiáº¿p theo cá»§a dá»± Ã¡n má»›i"
   â†’ Äá»c memory Ä‘á»ƒ biáº¿t:
     * Project name: [name]
     * Current step: [step number/name]
     * Completed steps: [list]
     * Next step: [step number/name]
     * Architecture decisions: [key decisions]
     * Tech stack: [stack]
   â†’ AI: "ğŸ§  Memory: TÃ¬m tháº¥y project progress...
          Báº¡n muá»‘n tiáº¿p tá»¥c tá»« bÆ°á»›c [next step] khÃ´ng?"
   â†’ SKIP Auto-Detection dá»± Ã¡n má»›i (Ä‘Ã£ biáº¿t lÃ  dá»± Ã¡n Ä‘ang lÃ m)

4. **Náº¿u KHÃ”NG tÃ¬m tháº¥y memory:**
   âš ï¸ Tiáº¿p tá»¥c BÆ¯á»šC 1 (Auto-Detection dá»± Ã¡n má»›i)

### Khi KHÃ”NG cÃ³ memory (Auto-Detection dá»± Ã¡n má»›i):

BÆ¯á»šC 1: CHECK USER STATEMENT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- User statement cÃ³ keywords "dá»± Ã¡n má»›i"?
  â†’ YES â†’ HIGH CONFIDENCE: Dá»± Ã¡n má»›i tá»« Ä‘áº§u
  â†’ NO â†’ Tiáº¿p tá»¥c BÆ¯á»šC 2

BÆ¯á»šC 2: CHECK CODEBASE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Codebase Ä‘Ã£ cÃ³ code?
  â†’ YES â†’ KhÃ´ng pháº£i dá»± Ã¡n má»›i tá»« Ä‘áº§u
  â†’ NO â†’ CÃ³ thá»ƒ lÃ  dá»± Ã¡n má»›i tá»« Ä‘áº§u

BÆ¯á»šC 3: CHECK DATABASE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ˜ PostgreSQL MCP: `list_tables`
  â†’ CÃ³ tables? â†’ KhÃ´ng pháº£i dá»± Ã¡n má»›i tá»« Ä‘áº§u
  â†’ Empty? â†’ CÃ³ thá»ƒ lÃ  dá»± Ã¡n má»›i tá»« Ä‘áº§u

BÆ¯á»šC 4: ASK USER (Náº¿u khÃ´ng cháº¯c)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Há»i user: "ÄÃ¢y lÃ  dá»± Ã¡n má»›i tá»« Ä‘áº§u hay báº¡n Ä‘ang tiáº¿p tá»¥c dá»± Ã¡n?"
```

---

### ğŸ“ **PROGRESS TRACKING - Theo DÃµi Tiáº¿n Äá»™**

**âœ… ÄÆ¯á»¢C - LÆ°u file JSON trong thÆ° má»¥c dá»± Ã¡n lÃ  HOÃ€N TOÃ€N á»”N vÃ  KHUYáº¾N NGHá»Š!**

**CÃ¡ch 1: LÆ°u vÃ o file `.cursor/progress.json` trong project (RECOMMENDED - ÄÆ¡n giáº£n nháº¥t)**

**âœ… HoÃ n toÃ n Ä‘Æ°á»£c phÃ©p vÃ  khuyáº¿n nghá»‹:**
- âœ… **ÄÆ¡n giáº£n:** KhÃ´ng cáº§n database, chá»‰ cáº§n file JSON trong project
- âœ… **Dá»… quáº£n lÃ½:** Äá»c/ghi trá»±c tiáº¿p tá»« project root
- âœ… **Git tracking:** Theo dÃµi vá»›i git, dá»… backup, dá»… share
- âœ… **Project-specific:** Má»—i project cÃ³ file riÃªng, khÃ´ng bá»‹ láº«n
- âœ… **Dá»… Ä‘á»c:** JSON format, dá»… xem vÃ  edit thá»§ cÃ´ng
- âœ… **KhÃ´ng phá»¥ thuá»™c:** KhÃ´ng cáº§n Memory Service external
- âœ… **Portable:** Copy project = copy luÃ´n progress
- âœ… **Version control:** Theo dÃµi thay Ä‘á»•i qua git history

**CÃ¡ch lÆ°u:**
```
File: .cursor/progress.json (trong project root - thÆ° má»¥c dá»± Ã¡n)

ğŸ“ my-project/
  â”œâ”€â”€ .cursor/
  â”‚   â””â”€â”€ progress.json  â† File nÃ y lÆ°u progress cá»§a dá»± Ã¡n
  â”œâ”€â”€ src/
  â”œâ”€â”€ package.json
  â””â”€â”€ ...

Ná»™i dung file .cursor/progress.json:
{
  "project_name": "há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng",
  "strategy": "Hybrid Cáº£i Tiáº¿n",
  "version": "1.0.0",
  "started_date": "2024-01-15T10:00:00Z",
  "last_updated": "2024-01-16T14:30:00Z",
  "current_step": 2,
  "current_step_name": "UI Wireframes",
  "current_step_status": "in_progress",
  "completed_steps": [
    {
      "step": 1,
      "name": "Architecture Design",
      "status": "completed",
      "started_date": "2024-01-15T10:00:00Z",
      "completed_date": "2024-01-15T18:00:00Z",
      "duration_hours": 8,
      "key_decisions": ["Decision 1", "Decision 2"],
      "files_created": ["file1.ts", "file2.ts"],
      "mcp_rounds": 2,
      "mcp_feedback": {
        "round_1": {
          "date": "2024-01-15T10:30:00Z",
          "status": "approved",
          "notes": "Approved architecture design"
        },
        "round_2": {
          "date": "2024-01-15T18:00:00Z",
          "status": "approved",
          "notes": "Approved implementation"
        }
      },
      "notes": "Architecture design completed successfully"
    }
  ],
  "skipped_steps": [],
  "next_step": 3,
  "next_step_name": "Database Foundation",
  "tech_stack": {
    "backend": "Next.js",
    "frontend": "React",
    "database": "PostgreSQL",
    "orm": "Prisma",
    "styling": "TailwindCSS"
  },
  "architecture_decisions": {
    "database_schema": "normalized",
    "api_pattern": "RESTful",
    "ui_framework": "Next.js",
    "auth_method": "JWT",
    "state_management": "Context API"
  },
  "dependencies": {
    "backend": ["next", "prisma", "jsonwebtoken"],
    "frontend": ["react", "tailwindcss"],
    "database": ["postgresql"]
  },
  "issues": [],
  "notes": "Project progressing smoothly. No blockers.",
  "metadata": {
    "created_by": "AI Assistant",
    "updated_by": "AI Assistant",
    "last_backup": "2024-01-16T12:00:00Z"
  }
}
```

**CÃ¡ch AI Ä‘á»c/ghi file:**
- âœ… **Read:** `read_file(".cursor/progress.json")` khi báº¯t Ä‘áº§u conversation
- âœ… **Write:** `write_file(".cursor/progress.json", ...)` sau má»—i bÆ°á»›c
- âœ… **Update:** Merge vá»›i existing data, khÃ´ng ghi Ä‘Ã¨ toÃ n bá»™
- âœ… **Create:** Tá»± Ä‘á»™ng táº¡o file náº¿u chÆ°a cÃ³

**CÃ¡ch 2: LÆ°u vÃ o Memory Service (Cross-project, Semantic Search)**

**Æ¯u Ä‘iá»ƒm:**
- âœ… **Semantic search:** TÃ¬m thÃ´ng tin báº±ng Ã½ nghÄ©a
- âœ… **Cross-project:** TÃ¬m patterns tá»« nhiá»u projects
- âœ… **Time-based recall:** TÃ¬m theo thá»i gian
- âœ… **Tag-based search:** TÃ¬m theo tags

**NhÆ°á»£c Ä‘iá»ƒm:**
- âš ï¸ Phá»¥ thuá»™c vÃ o Memory Service external
- âš ï¸ Cáº§n cáº¥u hÃ¬nh database
- âš ï¸ KhÃ³ quáº£n lÃ½ thá»§ cÃ´ng

**Hybrid Approach (RECOMMENDED - Tá»‘i Æ°u nháº¥t):**
- âœ… **Project progress:** LÆ°u vÃ o `.cursor/progress.json` trong project (Ä‘Æ¡n giáº£n, cá»¥ thá»ƒ, dá»… quáº£n lÃ½)
- âœ… **Patterns/Lessons:** LÆ°u vÃ o Memory Service (cross-project, semantic search cho patterns)

**Táº¡i sao Hybrid Approach tá»‘t nháº¥t:**
- File `.json` trong project: Perfect cho project progress (cá»¥ thá»ƒ, git-trackable, portable)
- Memory Service: Perfect cho patterns/lessons learned (semantic search, cross-project)
- Káº¿t há»£p cáº£ 2: Táº­n dá»¥ng Æ°u Ä‘iá»ƒm cá»§a má»—i cÃ¡ch

---

### ğŸ“ **MEMORY TRACKING - Theo DÃµi Tiáº¿n Äá»™**

**AI PHáº¢I lÆ°u progress sau má»—i bÆ°á»›c (theo thá»© tá»± Æ°u tiÃªn):**

```markdown
## ğŸ“ MEMORY STRUCTURE - Project Progress:

### Khi hoÃ n thÃ nh má»—i bÆ°á»›c, AI PHáº¢I store (theo thá»© tá»± Æ°u tiÃªn):

**1. Project Progress (PRIORITY 1 - CHÃNH):**
   â†’ ğŸ“ **LÆ°u vÃ o file `.cursor/progress.json` trong project root**
   ```json
   {
     "project_name": "[project-name]",
     "strategy": "Hybrid Cáº£i Tiáº¿n",
     "version": "1.0.0",
     "started_date": "2024-01-15T10:00:00Z",
     "last_updated": "2024-01-16T14:30:00Z",
     "current_step": 2,
     "current_step_name": "UI Wireframes",
     "current_step_status": "in_progress",
     "completed_steps": [
       {
         "step": 1,
         "name": "Architecture Design",
         "status": "completed",
         "started_date": "2024-01-15T10:00:00Z",
         "completed_date": "2024-01-15T18:00:00Z",
         "duration_hours": 8,
         "key_decisions": ["Decision 1", "Decision 2"],
         "files_created": ["file1.ts", "file2.ts"],
         "mcp_rounds": 2,
         "mcp_feedback": {
           "round_1": {
             "date": "2024-01-15T10:30:00Z",
             "status": "approved",
             "notes": "Approved architecture design"
           },
           "round_2": {
             "date": "2024-01-15T18:00:00Z",
             "status": "approved",
             "notes": "Approved implementation"
           }
         },
         "notes": "Architecture design completed successfully"
       }
     ],
     "skipped_steps": [],
     "next_step": 3,
     "next_step_name": "Database Foundation",
     "tech_stack": {
       "backend": "[framework]",
       "frontend": "[framework]",
       "database": "[database]"
     },
     "architecture_decisions": {
       "database_schema": "normalized",
       "api_pattern": "RESTful",
       "ui_framework": "Next.js"
     },
     "dependencies": {
       "backend": ["[package1]", "[package2]"],
       "frontend": ["[package1]", "[package2]"],
       "database": ["[package]"]
     },
     "issues": [],
     "notes": "Project progressing smoothly.",
     "metadata": {
       "created_by": "AI Assistant",
       "updated_by": "AI Assistant",
       "last_backup": "2024-01-16T12:00:00Z"
     }
   }
   ```

2. **Step Completion Memory:**
   ```json
   {
     "project_name": "[project-name]",
     "step": 1,
     "step_name": "Architecture Design",
     "completed_date": "2024-01-15",
     "outputs": {
       "files": ["file1.ts", "file2.ts"],
       "decisions": ["Decision 1", "Decision 2"],
       "mcp_feedback": "Approved design"
     }
   }
   ```

### Memory Tags:
- `[project-name]`, `dá»± Ã¡n má»›i`, `progress`, `step-[number]`, `[step-name]`
```

---

### ğŸš€ **WORKFLOW - Multi-Conversation**

**Khi user báº¯t Ä‘áº§u conversation má»›i:**

```
BÆ¯á»šC 1: PROGRESS LOAD (Tá»± Ä‘á»™ng)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- ğŸ“ **File-based (PRIORITY 1):** Check `.cursor/progress.json` trong project
  â†’ `read_file(".cursor/progress.json")` (náº¿u file tá»“n táº¡i)
  â†’ âœ… Náº¿u tÃ¬m tháº¥y: Äá»c project progress tá»« file
  
- ğŸ§  **Memory Service (PRIORITY 2 - Fallback):** Náº¿u khÃ´ng cÃ³ file
  â†’ mcp_memory_retrieve_memory("[project-name] project progress")
  â†’ mcp_memory_search_by_tag(["project-name", "dá»± Ã¡n má»›i", "progress"])

âœ… Náº¿u tÃ¬m tháº¥y:
  â†’ AI: "TÃ´i tháº¥y báº¡n Ä‘ang lÃ m dá»± Ã¡n '[project-name]'
       â†’ ÄÃ£ hoÃ n thÃ nh: [list completed steps]
       â†’ BÆ°á»›c hiá»‡n táº¡i: [current step]
       â†’ BÆ°á»›c tiáº¿p theo: [next step]
       
       Báº¡n muá»‘n tiáº¿p tá»¥c tá»« bÆ°á»›c [next step] khÃ´ng?"

âš ï¸ Náº¿u KHÃ”NG tÃ¬m tháº¥y:
  â†’ Tiáº¿p tá»¥c Auto-Detection dá»± Ã¡n má»›i (nhÆ° Ä‘Ã£ mÃ´ táº£)

BÆ¯á»šC 2: CONTINUE OR RESTART
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
User response:
- "Tiáº¿p tá»¥c" â†’ Báº¯t Ä‘áº§u tá»« bÆ°á»›c tiáº¿p theo
- "Dá»± Ã¡n má»›i" â†’ Báº¯t Ä‘áº§u tá»« Ä‘áº§u (Hybrid Cáº£i Tiáº¿n Strategy)
- "BÆ°á»›c X" â†’ Báº¯t Ä‘áº§u tá»« bÆ°á»›c X cá»¥ thá»ƒ

BÆ¯á»šC 3: EXECUTE STEP
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Thá»±c hiá»‡n bÆ°á»›c theo lá»™ trÃ¬nh Hybrid Cáº£i Tiáº¿n
- MCP Rounds: 2 rounds (BEFORE + AFTER code)
- Follow existing patterns tá»« memory (náº¿u cÃ³)

BÆ¯á»šC 4: STORE PROGRESS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Sau khi hoÃ n thÃ nh bÆ°á»›c:
  â†’ ğŸ“ **File-based (PRIORITY 1 - CHÃNH):** LÆ°u vÃ o `.cursor/progress.json` trong project root
    * Read existing `.cursor/progress.json` (náº¿u cÃ³)
    * Update: current_step, completed_steps, next_step, last_updated
    * Merge vá»›i existing data (khÃ´ng ghi Ä‘Ã¨ toÃ n bá»™)
    * Write to `.cursor/progress.json` trong thÆ° má»¥c dá»± Ã¡n
    * âœ… File náº±m trong project, dá»… quáº£n lÃ½, git-trackable
    
  â†’ ğŸ§  **Memory Service (PRIORITY 2 - Optional):** LÆ°u patterns/lessons learned
    * Store important decisions/patterns vÃ o Memory Service (cross-project)
    * Tags: `[project-name]`, `dá»± Ã¡n má»›i`, `progress`, `step-[number]`
    * âš ï¸ Chá»‰ lÆ°u patterns/lessons, khÃ´ng lÆ°u project progress (Ä‘Ã£ cÃ³ trong file)
```

---

### ğŸ“‹ **CHECKLIST - Khi Báº¯t Äáº§u Conversation Má»›i**

```
AI PHáº¢I tá»± Ä‘á»™ng:

[ ] BÆ¯á»šC 1: Check Progress File
    â†’ Check `.cursor/progress.json` trong project (PRIORITY 1)
    â†’ Náº¿u khÃ´ng cÃ³ â†’ Check Memory Service (PRIORITY 2 - Fallback)
    â†’ Náº¿u cÃ³ â†’ Show progress vÃ  há»i "Tiáº¿p tá»¥c?"
    â†’ Náº¿u khÃ´ng â†’ Tiáº¿p tá»¥c Auto-Detection

[ ] BÆ¯á»šC 2: Auto-Detection (Náº¿u khÃ´ng cÃ³ memory)
    â†’ Check user statement keywords
    â†’ Check codebase structure
    â†’ Check database state
    â†’ Check git history
    â†’ Determine: Dá»± Ã¡n má»›i? Hay bÆ°á»›c tiáº¿p theo?

[ ] BÆ¯á»šC 3: Confirm vá»›i user
    â†’ "ÄÃ¢y lÃ  dá»± Ã¡n má»›i tá»« Ä‘áº§u?"
    â†’ Hoáº·c "Báº¡n muá»‘n tiáº¿p tá»¥c tá»« bÆ°á»›c nÃ o?"

[ ] BÆ¯á»šC 4: Execute
    â†’ Thá»±c hiá»‡n bÆ°á»›c theo lá»™ trÃ¬nh
    â†’ MCP Rounds: 2 rounds (Version 4.0)

[ ] BÆ¯á»šC 5: Store Progress (Sau khi hoÃ n thÃ nh)
    â†’ ğŸ“ Update `.cursor/progress.json` trong project (PRIORITY 1)
    â†’ ğŸ§  Store patterns/lessons vÃ o Memory Service (PRIORITY 2 - Optional)
    â†’ Tags: `[project-name]`, `dá»± Ã¡n má»›i`, `progress`, `step-[number]`
```

---

### ğŸš¨ **EDGE CASES - Xá»­ LÃ½ TÃ¬nh Huá»‘ng Äáº·c Biá»‡t**

**Ká»‹ch báº£n Ä‘áº·c biá»‡t cÃ³ thá»ƒ xáº£y ra:**

#### **1. Skip Step (Bá» qua má»™t bÆ°á»›c)**

**Ká»‹ch báº£n:** User muá»‘n bá» qua má»™t bÆ°á»›c trong lá»™ trÃ¬nh (vÃ­ dá»¥: skip UI Wireframes, lÃ m tháº³ng Database)

**Xá»­ lÃ½:**
```
User: "Bá» qua bÆ°á»›c UI Wireframes, lÃ m tháº³ng Database"

AI PHáº¢I:
1. âš ï¸ Cáº¢NH BÃO: "Bá» qua UI Wireframes cÃ³ thá»ƒ dáº«n Ä‘áº¿n:
   - UX khÃ´ng Ä‘Æ°á»£c validate sá»›m
   - Cáº§n refactor UI sau nÃ y
   - TÄƒng thá»i gian phÃ¡t triá»ƒn

   Báº¡n cÃ³ cháº¯c muá»‘n bá» qua khÃ´ng?"

2. Náº¿u user confirm:
   â†’ Update `.cursor/progress.json`:
     * Mark step 2 (UI Wireframes) as "skipped"
     * Set current_step = 3 (Database Foundation)
     * Add note: "UI Wireframes skipped - user request"
   
3. Tiáº¿p tá»¥c vá»›i bÆ°á»›c tiáº¿p theo (Database Foundation)

4. âš ï¸ LÆ°u Ã½: Ghi nháº­n quyáº¿t Ä‘á»‹nh nÃ y trong memory Ä‘á»ƒ reference sau
```

#### **2. Redo Step (LÃ m láº¡i má»™t bÆ°á»›c)**

**Ká»‹ch báº£n:** User muá»‘n lÃ m láº¡i má»™t bÆ°á»›c Ä‘Ã£ hoÃ n thÃ nh (vÃ­ dá»¥: Database Foundation cáº§n redesign)

**Xá»­ lÃ½:**
```
User: "LÃ m láº¡i Database Foundation"

AI PHáº¢I:
1. âœ… XÃC NHáº¬N: "Báº¡n muá»‘n lÃ m láº¡i Database Foundation?
   â†’ ÄÃ£ hoÃ n thÃ nh: [Date]
   â†’ Files Ä‘Ã£ táº¡o: [List files]
   â†’ CÃ³ thá»ƒ áº£nh hÆ°á»Ÿng: [Steps phá»¥ thuá»™c]

   Báº¡n muá»‘n:
   - A. Giá»¯ nguyÃªn files cÅ©, táº¡o version má»›i?
   - B. XÃ³a vÃ  lÃ m láº¡i hoÃ n toÃ n?
   - C. Chá»‰nh sá»­a má»™t pháº§n?"

2. Náº¿u user chá»n option:
   â†’ Update `.cursor/progress.json`:
     * Mark step 3 (Database Foundation) as "in_progress"
     * Add note: "Redoing step 3 - [reason]"
     * Keep completed_steps nhÆ°ng mark as "needs_review"
   
3. Thá»±c hiá»‡n láº¡i bÆ°á»›c vá»›i approach má»›i
   â†’ ğŸš¨ MCP Round 1: Approve new design
   â†’ â¸ï¸ Äá»£i approval
   â†’ [Implement]
   â†’ ğŸš¨ MCP Round 2: Approve implementation
   
4. Sau khi hoÃ n thÃ nh:
   â†’ Update `.cursor/progress.json`:
     * Mark step 3 as "completed" (vá»›i date má»›i)
     * Add note: "Redone on [date] - [changes]"
```

#### **3. Corrupt Progress File (File bá»‹ lá»—i)**

**Ká»‹ch báº£n:** File `.cursor/progress.json` bá»‹ corrupt hoáº·c format sai

**Xá»­ lÃ½:**
```
AI PHáº¢I:
1. ğŸ” DETECT: Khi Ä‘á»c `.cursor/progress.json`:
   â†’ Try: `read_file(".cursor/progress.json")`
   â†’ If parse error hoáº·c invalid JSON:
   
2. âš ï¸ Cáº¢NH BÃO: "File `.cursor/progress.json` bá»‹ lá»—i format:
   â†’ Error: [specific error]
   â†’ File content: [show first 100 chars if safe]

   Báº¡n muá»‘n:
   - A. Táº¡o láº¡i file tá»« Ä‘áº§u (máº¥t progress tracking)
   - B. KhÃ´i phá»¥c tá»« backup (náº¿u cÃ³)
   - C. Sá»­a thá»§ cÃ´ng file (tÃ´i sáº½ giÃºp)"

3. Náº¿u user chá»n A (Táº¡o láº¡i):
   â†’ Create new `.cursor/progress.json` vá»›i structure máº·c Ä‘á»‹nh
   â†’ Ask user: "Báº¡n Ä‘ang á»Ÿ bÆ°á»›c nÃ o?"
   â†’ Update theo user input
   
4. Náº¿u user chá»n B (KhÃ´i phá»¥c):
   â†’ Check git history: `git log --oneline .cursor/progress.json`
   â†’ Show recent commits
   â†’ Ask user: "Báº¡n muá»‘n restore tá»« commit nÃ o?"
   â†’ Restore file tá»« git
   
5. Náº¿u user chá»n C (Sá»­a thá»§ cÃ´ng):
   â†’ Show file content (safe format)
   â†’ Suggest fixes
   â†’ User sá»­a â†’ AI verify format
```

#### **4. Missing Progress File (File khÃ´ng tá»“n táº¡i)**

**Ká»‹ch báº£n:** File `.cursor/progress.json` khÃ´ng tá»“n táº¡i (first time hoáº·c bá»‹ xÃ³a)

**Xá»­ lÃ½:**
```
AI PHáº¢I:
1. âœ… DETECT: `read_file(".cursor/progress.json")` â†’ File not found
   
2. ğŸ” CHECK Memory Service (Fallback):
   â†’ mcp_memory_retrieve_memory("[project-name] project progress")
   â†’ mcp_memory_search_by_tag(["project-name", "dá»± Ã¡n má»›i", "progress"])
   
3. Náº¿u tÃ¬m tháº¥y trong Memory:
   â†’ "TÃ¬m tháº¥y project progress trong Memory
      â†’ Project: [name]
      â†’ Current step: [step]
      â†’ Báº¡n muá»‘n táº¡o láº¡i file `.cursor/progress.json` tá»« Memory khÃ´ng?"
   
4. Náº¿u khÃ´ng tÃ¬m tháº¥y:
   â†’ "KhÃ´ng tÃ¬m tháº¥y progress file. Báº¡n muá»‘n:
      - A. Táº¡o file má»›i (dá»± Ã¡n má»›i)
      - B. Tá»± nháº­p progress hiá»‡n táº¡i
      - C. Bá» qua (khÃ´ng track progress)"
   
5. Náº¿u user chá»n A hoáº·c B:
   â†’ Create `.cursor/progress.json` vá»›i structure máº·c Ä‘á»‹nh
   â†’ Update theo user input
```

#### **5. Invalid Step Number (BÆ°á»›c khÃ´ng há»£p lá»‡)**

**Ká»‹ch báº£n:** User yÃªu cáº§u bÆ°á»›c khÃ´ng tá»“n táº¡i (vÃ­ dá»¥: "BÆ°á»›c 10" nhÆ°ng chá»‰ cÃ³ 6 bÆ°á»›c)

**Xá»­ lÃ½:**
```
User: "LÃ m bÆ°á»›c 10"

AI PHáº¢I:
1. âš ï¸ VALIDATE: "Lá»™ trÃ¬nh Hybrid Cáº£i Tiáº¿n chá»‰ cÃ³ 6 bÆ°á»›c:
   â†’ BÆ°á»›c 1: Architecture Design
   â†’ BÆ°á»›c 2: UI Wireframes
   â†’ BÆ°á»›c 3: Database Foundation
   â†’ BÆ°á»›c 4: API Backend Core
   â†’ BÆ°á»›c 5: Frontend Foundation
   â†’ BÆ°á»›c 6: Feature Development

   BÆ°á»›c 10 khÃ´ng tá»“n táº¡i.
   
   Báº¡n muá»‘n:
   - A. LÃ m bÆ°á»›c nÃ o? (1-6)
   - B. ThÃªm feature má»›i (bÆ°á»›c 6+)?"

2. Náº¿u user chá»n A:
   â†’ Tiáº¿p tá»¥c vá»›i bÆ°á»›c há»£p lá»‡
   
3. Náº¿u user chá»n B:
   â†’ Chuyá»ƒn sang Feature Development (bÆ°á»›c 6)
```

---

### ğŸ“‹ **CHECKLIST CHI TIáº¾T - Khi Detect Dá»± Ãn Má»›i**

**AI PHáº¢I thá»±c hiá»‡n Ä‘áº§y Ä‘á»§ cÃ¡c bÆ°á»›c sau:**

```
[ ] BÆ¯á»šC 1: PROGRESS FILE CHECK
    â†’ [ ] Read `.cursor/progress.json` (náº¿u cÃ³)
    â†’ [ ] Validate JSON format (náº¿u cÃ³)
    â†’ [ ] Parse vÃ  extract progress data (náº¿u cÃ³)
    â†’ [ ] Check file corruption (náº¿u cÃ³)
    â†’ [ ] Náº¿u file corrupt â†’ Handle edge case #3
    â†’ [ ] Náº¿u file khÃ´ng tá»“n táº¡i â†’ Handle edge case #4

[ ] BÆ¯á»šC 2: MEMORY SERVICE FALLBACK (Náº¿u khÃ´ng cÃ³ file)
    â†’ [ ] mcp_memory_retrieve_memory("[project-name] project progress")
    â†’ [ ] mcp_memory_search_by_tag(["project-name", "dá»± Ã¡n má»›i", "progress"])
    â†’ [ ] Parse memory results (náº¿u cÃ³)
    â†’ [ ] Compare vá»›i file progress (náº¿u cÃ³ file)

[ ] BÆ¯á»šC 3: AUTO-DETECTION (Náº¿u khÃ´ng cÃ³ progress)
    â†’ [ ] Check user statement keywords
       â†’ [ ] "dá»± Ã¡n má»›i", "project má»›i", "táº¡o project"
       â†’ [ ] "khá»Ÿi táº¡o dá»± Ã¡n", "init project", "new project"
       â†’ [ ] "báº¯t Ä‘áº§u tá»« Ä‘áº§u", "tá»« Ä‘áº§u", "tá»« con sá»‘ khÃ´ng"
    â†’ [ ] Check codebase structure
       â†’ [ ] list_dir() â†’ Count source files
       â†’ [ ] glob_file_search() â†’ Find source files (*.ts, *.js, *.py)
       â†’ [ ] grep() â†’ Find imports/exports/classes
    â†’ [ ] Check database state (náº¿u cÃ³ database)
       â†’ [ ] ğŸ˜ PostgreSQL MCP: list_tables()
       â†’ [ ] Check if tables empty
    â†’ [ ] Check git history (náº¿u cáº§n)
       â†’ [ ] run_terminal_cmd: `git log --oneline | head -5`
       â†’ [ ] Check commit count

[ ] BÆ¯á»šC 4: CONFIDENCE ASSESSMENT
    â†’ [ ] Calculate confidence level:
       â†’ [ ] HIGH: User statement + 2+ indicators
       â†’ [ ] MEDIUM: 2+ indicators
       â†’ [ ] LOW: 1 indicator
    â†’ [ ] Determine action:
       â†’ [ ] HIGH â†’ Apply Hybrid Cáº£i Tiáº¿n Strategy ngay
       â†’ [ ] MEDIUM â†’ Apply + Confirm with user
       â†’ [ ] LOW â†’ Ask user to confirm

[ ] BÆ¯á»šC 5: USER CONFIRMATION
    â†’ [ ] Show detection results
    â†’ [ ] Explain strategy (Hybrid Cáº£i Tiáº¿n)
    â†’ [ ] Show timeline (16 days foundation)
    â†’ [ ] Show ROI (+35.8%)
    â†’ [ ] Ask: "Báº¡n xÃ¡c nháº­n Ä‘Ãºng khÃ´ng?"
    â†’ [ ] Wait for user confirmation

[ ] BÆ¯á»šC 6: STRATEGY EXECUTION
    â†’ [ ] Initialize progress file (náº¿u chÆ°a cÃ³)
    â†’ [ ] Start with BÆ°á»›c 0: Context Understanding
    â†’ [ ] ğŸš¨ MCP Round 1: Approve approach
    â†’ [ ] â¸ï¸ Wait for approval
    â†’ [ ] Execute step
    â†’ [ ] ğŸš¨ MCP Round 2: Approve implementation
    â†’ [ ] â¸ï¸ Wait for approval
    â†’ [ ] Update progress file
    â†’ [ ] Store patterns/lessons in Memory (optional)
```

---

### ğŸ“ **PROGRESS FILE FORMAT - Example Äáº§y Äá»§**

**File: `.cursor/progress.json` (trong project root)**

```json
{
  "project_name": "há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng",
  "strategy": "Hybrid Cáº£i Tiáº¿n",
  "version": "1.0.0",
  "started_date": "2024-01-15T10:00:00Z",
  "last_updated": "2024-01-16T14:30:00Z",
  "current_step": 2,
  "current_step_name": "UI Wireframes",
  "current_step_status": "in_progress",
  "completed_steps": [
    {
      "step": 1,
      "name": "Architecture Design",
      "status": "completed",
      "started_date": "2024-01-15T10:00:00Z",
      "completed_date": "2024-01-15T18:00:00Z",
      "duration_hours": 8,
      "key_decisions": [
        "RESTful API pattern",
        "Normalized database schema",
        "Next.js App Router"
      ],
      "files_created": [
        "docs/architecture.md",
        "docs/api-spec.md",
        "docs/database-schema.md"
      ],
      "mcp_rounds": 2,
      "mcp_feedback": {
        "round_1": {
          "date": "2024-01-15T10:30:00Z",
          "status": "approved",
          "notes": "Approved architecture design"
        },
        "round_2": {
          "date": "2024-01-15T18:00:00Z",
          "status": "approved",
          "notes": "Approved implementation"
        }
      },
      "notes": "Architecture design completed successfully"
    }
  ],
  "skipped_steps": [],
  "next_step": 3,
  "next_step_name": "Database Foundation",
  "tech_stack": {
    "backend": "Next.js",
    "frontend": "React",
    "database": "PostgreSQL",
    "orm": "Prisma",
    "styling": "TailwindCSS"
  },
  "architecture_decisions": {
    "database_schema": "normalized",
    "api_pattern": "RESTful",
    "ui_framework": "Next.js",
    "auth_method": "JWT",
    "state_management": "Context API"
  },
  "dependencies": {
    "backend": ["next", "prisma", "jsonwebtoken"],
    "frontend": ["react", "tailwindcss"],
    "database": ["postgresql"]
  },
  "issues": [],
  "notes": "Project progressing smoothly. No blockers.",
  "metadata": {
    "created_by": "AI Assistant",
    "updated_by": "AI Assistant",
    "last_backup": "2024-01-16T12:00:00Z"
  }
}
```

**Field Descriptions:**

- `project_name`: TÃªn dá»± Ã¡n (string)
- `strategy`: Chiáº¿n lÆ°á»£c sá»­ dá»¥ng (string: "Hybrid Cáº£i Tiáº¿n")
- `version`: Version cá»§a progress file format (string: "1.0.0")
- `started_date`: NgÃ y báº¯t Ä‘áº§u dá»± Ã¡n (ISO 8601 string)
- `last_updated`: NgÃ y cáº­p nháº­t cuá»‘i (ISO 8601 string)
- `current_step`: BÆ°á»›c hiá»‡n táº¡i (number: 1-6)
- `current_step_name`: TÃªn bÆ°á»›c hiá»‡n táº¡i (string)
- `current_step_status`: Tráº¡ng thÃ¡i bÆ°á»›c hiá»‡n táº¡i (string: "in_progress" | "pending" | "completed" | "skipped")
- `completed_steps`: Array cÃ¡c bÆ°á»›c Ä‘Ã£ hoÃ n thÃ nh
  - `step`: Sá»‘ bÆ°á»›c (number)
  - `name`: TÃªn bÆ°á»›c (string)
  - `status`: Tráº¡ng thÃ¡i (string: "completed" | "skipped" | "redone")
  - `started_date`: NgÃ y báº¯t Ä‘áº§u (ISO 8601)
  - `completed_date`: NgÃ y hoÃ n thÃ nh (ISO 8601)
  - `duration_hours`: Thá»i gian hoÃ n thÃ nh (number)
  - `key_decisions`: Quyáº¿t Ä‘á»‹nh quan trá»ng (string[])
  - `files_created`: Files Ä‘Ã£ táº¡o (string[])
  - `mcp_rounds`: Sá»‘ MCP rounds (number)
  - `mcp_feedback`: Feedback tá»« MCP (object)
  - `notes`: Ghi chÃº (string)
- `skipped_steps`: Array cÃ¡c bÆ°á»›c Ä‘Ã£ bá» qua (tÆ°Æ¡ng tá»± `completed_steps` nhÆ°ng `status: "skipped"`)
- `next_step`: BÆ°á»›c tiáº¿p theo (number)
- `next_step_name`: TÃªn bÆ°á»›c tiáº¿p theo (string)
- `tech_stack`: Tech stack sá»­ dá»¥ng (object)
- `architecture_decisions`: Quyáº¿t Ä‘á»‹nh kiáº¿n trÃºc (object)
- `dependencies`: Dependencies (object)
- `issues`: Váº¥n Ä‘á» Ä‘ang gáº·p (array)
- `notes`: Ghi chÃº tá»•ng quan (string)
- `metadata`: Metadata vá» file (object)

---

### ğŸ’¡ **VÃ Dá»¤ - Multi-Conversation Scenario**

**Conversation 1:**
```
User: "TÃ´i muá»‘n táº¡o dá»± Ã¡n má»›i - há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng"

AI: "ğŸ” Auto-Detection: ÄÃ¢y lÃ  dá»± Ã¡n má»›i
â†’ Ãp dá»¥ng Hybrid Cáº£i Tiáº¿n Strategy

BÆ¯á»šC 1: Architecture Design
â†’ ğŸš¨ MCP Round 1: Approve design
â†’ â¸ï¸ Äá»£i approval
â†’ [Implement]
â†’ ğŸš¨ MCP Round 2: Approve implementation
â†’ âœ… HoÃ n thÃ nh BÆ°á»›c 1

â†’ ğŸ§  Memory: Store progress
  - Project: "há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng"
  - Current step: 1
  - Completed: [Architecture Design]
  - Next step: 2 (UI Wireframes)
```

**Conversation 2:**
```
User: "Tiáº¿p tá»¥c dá»± Ã¡n quáº£n lÃ½ khÃ¡ch hÃ ng"

AI: [Tá»± Ä‘á»™ng check `.cursor/progress.json`]
    â†’ âœ… TÃ¬m tháº¥y file: `.cursor/progress.json`
    â†’ Äá»c project progress tá»« file
    
    AI: "ğŸ“ Progress: TÃ¬m tháº¥y project progress
â†’ Project: 'há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng'
â†’ ÄÃ£ hoÃ n thÃ nh: BÆ°á»›c 1 (Architecture Design)
â†’ BÆ°á»›c tiáº¿p theo: BÆ°á»›c 2 (UI Wireframes)

Báº¡n muá»‘n tiáº¿p tá»¥c tá»« BÆ°á»›c 2 khÃ´ng?"

User: "ÄÃºng rá»“i"

AI: "BÆ¯á»šC 2: UI Wireframes
â†’ ğŸš¨ MCP Round 1: Approve wireframes design
â†’ â¸ï¸ Äá»£i approval
â†’ [Implement]
â†’ ğŸš¨ MCP Round 2: Approve implementation
â†’ âœ… HoÃ n thÃ nh BÆ°á»›c 2

â†’ ğŸ“ Update `.cursor/progress.json`:
  - Current step: 2
  - Completed: [Architecture Design, UI Wireframes]
  - Next step: 3 (Database Foundation)
  - Last updated: [current date]
```

**Conversation 3:**
```
User: "Tiáº¿p tá»¥c dá»± Ã¡n"

AI: [Tá»± Ä‘á»™ng check `.cursor/progress.json`]
    â†’ âœ… TÃ¬m tháº¥y file: `.cursor/progress.json`
    â†’ Äá»c project progress tá»« file
    
    AI: "ğŸ“ Progress: TÃ¬m tháº¥y project progress
â†’ Project: 'há»‡ thá»‘ng quáº£n lÃ½ khÃ¡ch hÃ ng'
â†’ ÄÃ£ hoÃ n thÃ nh: BÆ°á»›c 1, BÆ°á»›c 2
â†’ BÆ°á»›c tiáº¿p theo: BÆ°á»›c 3 (Database Foundation)

Báº¯t Ä‘áº§u BÆ°á»›c 3..."
```

---

### âœ… **TÆ¯Æ NG THÃCH Vá»šI MEMORY SERVICE**

**Äáº£m báº£o:**
- âœ… **Memory Auto-Load:** Tá»± Ä‘á»™ng load project progress khi báº¯t Ä‘áº§u conversation
- âœ… **Memory Store:** Tá»± Ä‘á»™ng store progress sau má»—i bÆ°á»›c
- âœ… **Memory Tags:** DÃ¹ng tags nháº¥t quÃ¡n Ä‘á»ƒ dá»… search
- âœ… **Memory Cleanup:** KHÃ”NG xÃ³a memories vá» project progress (quan trá»ng!)

**Memory Tags Structure:**
- `[project-name]` - Project identifier
- `dá»± Ã¡n má»›i` - Strategy type
- `progress` - Progress tracking
- `step-1`, `step-2`, etc. - Step numbers
- `architecture-design`, `ui-wireframes`, etc. - Step names

---


### ğŸ“ TODO Management:
**Khi nÃ o Táº O todos:**
- Tasks phá»©c táº¡p (>3 steps)
- Multi-step features
- User yÃªu cáº§u explicitly

**Khi nÃ o KHÃ”NG táº¡o todos:**
- Tasks Ä‘Æ¡n giáº£n (<3 steps)
- Single straightforward changes
- NEVER include: linting, testing, searching codebase

**Quy táº¯c vÃ ng:**
- Náº¿u khÃ´ng cháº¯c â†’ Feedback
- Náº¿u cháº¯c cháº¯n â†’ LÃ m luÃ´n
- Nghi ngá» gÃ¬ vá» requirements â†’ Há»i ngay, Ä‘á»«ng Ä‘oÃ¡n
- Infer user intent â†’ act accordingly, khÃ´ng há»i quÃ¡ nhiá»u

---

## âŒ Common Mistakes to AVOID

### 1. Over-Engineering
```
âŒ BAD: Táº¡o abstract factory pattern cho 1 class Ä‘Æ¡n giáº£n
âœ… GOOD: Start simple, refactor khi cáº§n

âŒ BAD: Táº¡o 5 layers cho logic Ä‘Æ¡n giáº£n
âœ… GOOD: Controller â†’ Service â†’ Database (Ä‘á»§ rá»“i)
```

### 2. Premature Optimization
```
âŒ BAD: Optimize má»i query ngay tá»« Ä‘áº§u
âœ… GOOD: Make it work â†’ Make it right â†’ Make it fast

âŒ BAD: Cache everything "just in case"
âœ… GOOD: Measure first, optimize bottlenecks
```

### 3. Inconsistent Naming
```
âŒ BAD: getUser, fetchCustomer, retrieveOrder
âœ… GOOD: getUser, getEntity, getTransaction (consistent - dÃ¹ng generic terms)

âŒ BAD: user_service.ts, CustomerService.ts
âœ… GOOD: user.service.ts, entity.service.ts (generic terms - thay tháº¿ báº±ng domain-specific term khi implement)
```

### 4. Missing Error Handling
```
âŒ BAD:
const user = await db.user.findUnique({ where: { id } });
return user.name; // Crash náº¿u null!

âœ… GOOD:
const user = await db.user.findUnique({ where: { id } });
if (!user) throw new NotFoundException('User not found');
return user.name;
```

### 5. Hardcoding Values
```
âŒ BAD:
const API_KEY = "sk-abc123...";
const DB_URL = "postgresql://localhost:5432/mydb";

âœ… GOOD:
const API_KEY = process.env.API_KEY;
const DB_URL = process.env.DATABASE_URL;
```

### 6. Ignoring Existing Patterns
```
âŒ BAD: Táº¡o pattern má»›i khi project Ä‘Ã£ cÃ³ pattern
âœ… GOOD: Follow existing patterns trong codebase

VÃ­ dá»¥: Náº¿u project dÃ¹ng Services â†’ dÃ¹ng Services
        Äá»«ng Ä‘á»™t nhiÃªn introduce Repositories
```

### 7. Too Much / Too Little Comments
```
âŒ BAD:
// This function adds two numbers
function add(a, b) { return a + b; } // Obviously!

âŒ BAD:
function calculateDiscountedPriceWithTaxAndShipping(items, coupon, location) {
  // No comments explaining complex logic
}

âœ… GOOD:
// Calculate final price: base + tax + shipping - discount
// Tax rate depends on location, discount from coupon if valid
function calculateFinalPrice(items, coupon, location) {
  // Implementation with comments at key steps
}
```

---

## ğŸ¯ Decision Making Guide

### "Should I ask or just do it?"

```
Confidence Level Guide:

100% Sure (DOANH domain logic):
â”œâ”€ Fix obvious typo: Just do it
â”œâ”€ Add simple validation: Just do it
â””â”€ Follow clear instruction: Just do it

80-99% Sure (Reasonable inference):
â”œâ”€ Implementation approach: Do it, explain reasoning
â”œâ”€ Tech choice (multiple valid options): Do it, mention alternatives
â””â”€ Naming/structure: Follow project patterns

50-79% Sure (Need validation):
â”œâ”€ Architecture decision: Ask first
â”œâ”€ Breaking changes: Ask first
â””â”€ Multiple valid approaches: Ask which one

< 50% Sure (Ambiguous):
â”œâ”€ Unclear requirements: Ask for clarification
â”œâ”€ Business logic: Ask domain expert (user)
â””â”€ Security implications: Ask before proceeding
```

### "Which approach should I use?"

```
Priority Order:

1. Follow existing project patterns (highest priority)
   â””â”€ Don't introduce new patterns without reason

2. Use framework conventions
   â””â”€ NestJS â†’ Modules/Controllers/Services
   â””â”€ Next.js â†’ App Router conventions
   
3. Apply SOLID/DRY/KISS principles
   â””â”€ Balance between principles and pragmatism

4. Consider project phase
   â””â”€ MVP/Prototype: Speed > Perfection
   â””â”€ Production: Reliability > Speed
   
5. User preference (if mentioned)
   â””â”€ "Keep it simple" â†’ Minimal solution
   â””â”€ "Scalable" â†’ Add abstractions
```

---

## Testing & Quality Assurance

---

## âš™ï¸ Quick Self QA (AI PHáº¢I Tá»° TEST)

TrÆ°á»›c khi Ä‘á» xuáº¥t commit, AI pháº£i tá»± kiá»ƒm tra:

- âœ… Code cÃ³ cháº¡y Ä‘Æ°á»£c (compile/build khÃ´ng lá»—i)
- âœ… KhÃ´ng cÃ³ syntax/linter warning
- âœ… CÃ³ Ã­t nháº¥t 1 test Ä‘Æ¡n giáº£n (unit hoáº·c manual) chá»©ng minh output Ä‘Ãºng
- âœ… Error handling Ä‘áº§y Ä‘á»§ (thá»­ edge case: null, timeout, invalid input)
- âœ… KhÃ´ng cÃ³ secret, token, hardcode
- âœ… KhÃ´ng Ä‘á»¥ng file ngoÃ i pháº¡m vi task

Náº¿u báº¥t ká»³ má»¥c nÃ o âŒ â†’ Feedback user trÆ°á»›c khi commit.

---

### Before Committing:
- [ ] Code compiles/runs without errors
- [ ] No linter warnings (hoáº·c justify náº¿u cÃ³)
- [ ] Test edge cases quan trá»ng
- [ ] Error handling Ä‘áº§y Ä‘á»§
- [ ] No console.log/print debug statements cÃ²n sÃ³t

### Linter Commands (cháº¡y khi cáº§n):
```bash
# JavaScript/TypeScript
npm run lint
eslint --fix .

# Python
ruff check .
black .
mypy .

# Go
go vet ./...
golangci-lint run

# Java
mvn checkstyle:check
```

---

## ğŸ¯ Professional QA Testing Strategy - Chiáº¿n LÆ°á»£c Testing ChuyÃªn Nghiá»‡p

### ğŸ“‹ **ÃP Dá»¤NG CHO:**
- âœ… **Dá»± Ã¡n má»›i:** Test trong quÃ¡ trÃ¬nh development (TDD, Continuous Testing)
- âœ… **Dá»± Ã¡n Ä‘Ã£ cÃ³ sáºµn:** Test khi nháº­n source code (Discovery â†’ Setup â†’ Comprehensive Testing)
- âœ… **Feature má»›i:** Test khi thÃªm tÃ­nh nÄƒng má»›i
- âœ… **Bug fixes:** Test sau khi fix bugs
- âœ… **Pre-Release:** Test trÆ°á»›c khi release

**Khi user nÃ³i:** "Test dá»± Ã¡n nÃ y", "Kiá»ƒm tra dá»± Ã¡n", "Test source code nÃ y"
â†’ AI tá»± Ä‘á»™ng cháº¡y comprehensive testing strategy vá»›i Ultimate Checklist (A-N: 14 categories)

---

### ğŸ—ï¸ **6 LAYERS TESTING PYRAMID - Kiáº¿n TrÃºc ToÃ n Diá»‡n**

**Layer 1: Unit Testing (Foundation - 50%)**
- âœ… Test functions, components, services riÃªng láº»
- âœ… Fast, isolated, repeatable
- âœ… Coverage: > 80%
- âœ… Tools: Jest, Vitest, pytest, mocha

**Layer 2: Integration Testing (Middle - 20%)**
- âœ… Test FE â†” BE integration
- âœ… Test BE â†” DB integration
- âœ… Test API endpoints vá»›i real DB
- âœ… Tools: Supertest, MSW, pytest

**Layer 3: System Testing (System - 15%)**
- âœ… Test toÃ n bá»™ há»‡ thá»‘ng (end-to-end workflows)
- âœ… Test system requirements (functional + non-functional)
- âœ… Test system behavior (real-world scenarios)
- âœ… Tools: Playwright, Cypress, Selenium

**Layer 4: Acceptance Testing (Acceptance - 10%)**
- âœ… UAT - User Acceptance Testing (real users)
- âœ… Beta Testing (limited users)
- âœ… Business Acceptance Testing (stakeholders)
- âœ… Tools: Manual testing, User feedback

**Layer 5: Production Readiness Testing (Readiness - 4%)**
- âœ… Production-like Environment Testing
- âœ… Load/Stress/Scalability Testing
- âœ… Recovery Testing (disaster recovery)
- âœ… Deployment Testing (deployment + rollback)
- âœ… Tools: K6, JMeter, Lighthouse

**Layer 6: Post-Production Testing (Monitoring - 1%)**
- âœ… Production Monitoring Testing
- âœ… User Feedback Testing
- âœ… Continuous Improvement Testing
- âœ… Tools: Sentry, Datadog, New Relic

---

### ğŸš€ **12 PHÆ¯Æ NG PHÃP Tá»I Æ¯U - Káº¿t Há»£p Táº¥t Cáº£ PhÆ°Æ¡ng PhÃ¡p Tá»‘t Nháº¥t**

**1. SHIFT-LEFT TESTING (Test Sá»›m)**
- âœ… Test ngay tá»« Design Phase
- âœ… Test trong Development Phase
- âœ… Test trong Code Review Phase
- **Lá»£i Ã­ch:** Catch bugs sá»›m (10x cheaper to fix)

**2. TEST-DRIVEN DEVELOPMENT (TDD)**
- âœ… Write tests first (RED)
- âœ… Write code to pass (GREEN)
- âœ… Refactor code (REFACTOR)
- **Lá»£i Ã­ch:** Better coverage, better design

**3. CONTINUOUS TESTING (Test LiÃªn Tá»¥c)**
- âœ… Pre-Commit: Quick checks (< 30 seconds)
- âœ… CI/CD: Full test suite (< 10 minutes)
- âœ… Post-Release: Monitoring
- **Lá»£i Ã­ch:** Fast feedback, continuous quality

**4. SMART TEST SELECTION (Test ThÃ´ng Minh)**
- âœ… Run only affected tests (impact analysis)
- âœ… Prioritize critical tests (risk-based)
- âœ… Parallelize tests (speed up)
- **Lá»£i Ã­ch:** Faster feedback (< 2 minutes)

**5. AI-POWERED TESTING (Test Tá»± Äá»™ng)**
- âœ… AI generate test cases (from requirements)
- âœ… AI find edge cases (automatically)
- âœ… AI suggest improvements (based on coverage)
- **Lá»£i Ã­ch:** Comprehensive coverage, save time

**6. RISK-BASED TESTING (Test Theo Rá»§i Ro)**
- âœ… Prioritize critical features (payment, auth)
- âœ… Test high-risk features thoroughly
- âœ… Test low-risk features lightly
- **Lá»£i Ã­ch:** Optimize resources, focus on critical

**7. COMPREHENSIVE TESTING CHECKLIST (Test Systematic)**
- âœ… UI/UX Testing (menu, buttons, forms)
- âœ… Data Testing (validation, sync)
- âœ… Integration Testing (FE â†” BE â†” DB)
- âœ… E2E Testing (user workflows)
- **Lá»£i Ã­ch:** Don't miss anything, systematic

**8. TEST AUTOMATION STRATEGY (Tá»± Äá»™ng HÃ³a)**
- âœ… Unit tests: 100% automated
- âœ… Integration tests: 100% automated
- âœ… E2E tests: 80% automated, 20% manual
- âœ… Visual tests: 70% automated, 30% manual
- **Lá»£i Ã­ch:** Save time, consistent results

**ğŸ“Š Automation vs Manual Testing Guide:**

**âœ… 100% AUTOMATED (Há»‡ thá»‘ng tá»± test):**
- **Unit Testing:** Functions, components, services (Jest, pytest)
- **Integration Testing:** FE â†” BE â†” DB (Supertest, MSW)
- **CRUD Operations:** ThÃªm/xÃ³a/sá»­a (Playwright, Cypress)
  - Click nÃºt thÃªm â†’ Fill form â†’ Submit â†’ Verify data
  - Click nÃºt sá»­a â†’ Update form â†’ Submit â†’ Verify updated
  - Click nÃºt xÃ³a â†’ Confirm â†’ Verify deleted
- **Buttons & Actions:** Click, submit, cancel, delete (Playwright, Cypress)
- **Data Validation:** Frontend + Backend + DB constraints (Unit tests)
- **API Testing:** GET, POST, PUT, DELETE, PATCH (Supertest, Postman)
- **Database Testing:** CRUD, transactions, relationships (Integration tests)
- **Performance Testing:** Load, stress, scalability (K6, JMeter)
- **Security Scanning:** Vulnerability scanning (OWASP ZAP, Snyk)

**âš¡ 80-90% AUTOMATED (Chá»§ yáº¿u tá»± Ä‘á»™ng, Ã­t manual):**
- **E2E Testing:** User workflows (Playwright 80%, Manual 20%)
  - Automated: Complete workflows (táº¡o â†’ xem â†’ sá»­a â†’ xÃ³a)
  - Manual: UX quality review (cáº§n human judgment)
- **Visual Regression:** UI visual changes (Percy 70%, Manual 30%)
  - Automated: Screenshot comparison
  - Manual: Design aesthetic review
- **Security Testing:** Authentication, authorization (OWASP ZAP 80%, Manual 20%)
  - Automated: Automated scanning
  - Manual: Penetration testing, security review
- **Compatibility Testing:** Cross-browser, cross-device (BrowserStack 90%, Manual 10%)
  - Automated: Automated cross-browser testing
  - Manual: Specific device testing

**âš ï¸ 50-70% AUTOMATED (Ná»­a tá»± Ä‘á»™ng, ná»­a manual):**
- **Accessibility Testing:** WCAG compliance (axe-core 50%, Manual 50%)
  - Automated: Basic accessibility checks (axe-core, Lighthouse)
  - Manual: Screen readers, keyboard navigation (cáº§n human judgment)
- **Usability Testing:** UX quality (Automated 30%, Manual 70%)
  - Automated: Basic checks (accessibility, responsive)
  - Manual: User experience, design quality (cáº§n human judgment)

**âŒ 100% MANUAL (Pháº£i test thá»§ cÃ´ng):**
- **UX/Design Review:** Design aesthetics, user experience
- **User Acceptance Testing (UAT):** Real users test
- **Beta Testing:** Limited users feedback
- **Business Acceptance:** Stakeholders review
- **Ad-hoc Testing:** Exploratory testing, edge cases discovery

**ğŸ› ï¸ Tools cho Automation:**
- **E2E Testing:** Playwright (recommended), Cypress, Selenium
- **Visual Testing:** Percy, Applitools, Chromatic
- **Accessibility:** axe-core, WAVE, Lighthouse
- **Performance:** K6, JMeter, Lighthouse
- **Security:** OWASP ZAP, Snyk, Burp Suite
- **Compatibility:** BrowserStack, Sauce Labs, LambdaTest

**ğŸ’¡ Best Practice:**
- **Automate repetitive tests:** CRUD, buttons, forms, validations
- **Manual for UX/Design:** User experience, design quality
- **Hybrid approach:** Automated for coverage, Manual for quality
- **CI/CD Integration:** Run automated tests trong CI/CD pipeline

---

## ğŸ¤– Comprehensive Automation Testing Strategy - Chiáº¿n LÆ°á»£c Tá»± Äá»™ng HÃ³a ToÃ n Diá»‡n

**Má»¥c tiÃªu:** Tá»± Ä‘á»™ng hÃ³a 100% nhá»¯ng gÃ¬ cÃ³ thá»ƒ tá»± Ä‘á»™ng test Ä‘Æ°á»£c

**NguyÃªn táº¯c:**
- âœ… **Automate everything repetitive:** CRUD, forms, buttons, validations
- âœ… **Automate critical paths:** User workflows, API endpoints, database operations
- âœ… **Manual for quality judgment:** UX/Design, usability, business acceptance
- âœ… **Hybrid approach:** Automated for coverage, Manual for quality

### ğŸ“‹ **AUTOMATION TESTING CHECKLIST - Nhá»¯ng GÃ¬ Tá»± Äá»™ng ÄÆ°á»£c:**

#### **1. CRUD Operations (100% Automated)**
**Tools:** Playwright (recommended), Cypress, Selenium

**Test Cases:**
- âœ… **CREATE (ThÃªm):**
  - Click nÃºt "ThÃªm má»›i" / "Add New"
  - Fill form vá»›i test data
  - Submit form
  - Verify data saved trong database
  - Verify success message hiá»ƒn thá»‹
  - Verify data xuáº¥t hiá»‡n trong danh sÃ¡ch
  
- âœ… **READ (Xem):**
  - Click "Xem chi tiáº¿t" / "View Details"
  - Verify data hiá»ƒn thá»‹ Ä‘Ãºng
  - Verify format Ä‘Ãºng (date, currency, number)
  - Verify pagination (náº¿u cÃ³)
  - Verify sorting/filtering (náº¿u cÃ³)
  
- âœ… **UPDATE (Sá»­a):**
  - Click "Sá»­a" / "Edit"
  - Verify form pre-filled vá»›i data hiá»‡n táº¡i
  - Update form fields
  - Submit form
  - Verify data updated trong database
  - Verify success message hiá»ƒn thá»‹
  - Verify updated data xuáº¥t hiá»‡n
  
- âœ… **DELETE (XÃ³a):**
  - Click "XÃ³a" / "Delete"
  - Verify confirmation dialog hiá»ƒn thá»‹
  - Confirm deletion
  - Verify data deleted tá»« database
  - Verify success message hiá»ƒn thá»‹
  - Verify data khÃ´ng cÃ²n trong danh sÃ¡ch

**Implementation Example (Playwright):**
```typescript
// CRUD Operations Test
// Note: "Entity" lÃ  generic term. Thay tháº¿ báº±ng domain-specific term cá»§a báº¡n:
// - E-commerce: "Product"
// - Service: "Service Package"
// - CRM: "Customer"
// - Booking: "Booking"
// - Project Management: "Project"
test('CRUD operations for Entity', async ({ page }) => {
  // CREATE
  await page.click('button:has-text("ThÃªm má»›i")');
  await page.fill('input[name="name"]', 'Test Entity');
  await page.fill('input[name="description"]', 'Entity description');
  await page.click('button:has-text("LÆ°u")');
  await expect(page.locator('.success-message')).toBeVisible();
  
  // READ
  await page.click('text=Test Entity');
  await expect(page.locator('input[name="name"]')).toHaveValue('Test Entity');
  
  // UPDATE
  await page.click('button:has-text("Sá»­a")');
  await page.fill('input[name="name"]', 'Updated Entity');
  await page.click('button:has-text("LÆ°u")');
  await expect(page.locator('text=Updated Entity')).toBeVisible();
  
  // DELETE
  await page.click('button:has-text("XÃ³a")');
  await page.click('button:has-text("XÃ¡c nháº­n")');
  await expect(page.locator('text=Updated Entity')).not.toBeVisible();
});
```

#### **2. Form Filling & Submission (100% Automated)**
**Tools:** Playwright, Cypress

**Test Cases:**
- âœ… **Fill all form fields:**
  - Text inputs: Type text, verify value
  - Number inputs: Type number, verify format
  - Date pickers: Select date, verify format
  - Select dropdowns: Select option, verify selected
  - Checkboxes: Check/uncheck, verify state
  - Radio buttons: Select option, verify selected
  - File uploads: Upload file, verify uploaded
  - Text areas: Type text, verify value
  
- âœ… **Form Validation:**
  - Required fields: Submit empty â†’ Verify error
  - Format validation: Invalid format â†’ Verify error
  - Range validation: Out of range â†’ Verify error
  - Real-time validation: Type â†’ See error immediately
  - Business rules validation: Invalid business logic â†’ Verify error
  
- âœ… **Form Submission:**
  - Submit valid form â†’ Verify success
  - Submit invalid form â†’ Verify errors
  - Cancel form â†’ Verify cancelled
  - Reset form â†’ Verify cleared

**Implementation Example (Playwright):**
```typescript
// Form Filling Test
test('Fill and submit form', async ({ page }) => {
  await page.fill('input[name="name"]', 'John Doe');
  await page.fill('input[name="email"]', 'john@example.com');
  await page.selectOption('select[name="country"]', 'VN');
  await page.check('input[name="agree"]');
  await page.setInputFiles('input[type="file"]', 'test-file.pdf');
  await page.click('button:has-text("Submit")');
  await expect(page.locator('.success-message')).toBeVisible();
});
```

#### **3. Buttons & Actions (100% Automated)**
**Tools:** Playwright, Cypress

**Test Cases:**
- âœ… **Click Actions:**
  - Click button â†’ Verify action executed
  - Click submit â†’ Verify form submitted
  - Click cancel â†’ Verify form cancelled
  - Click delete â†’ Verify confirmation â†’ Verify deleted
  - Click edit â†’ Verify edit mode activated
  - Click save â†’ Verify data saved
  - Click reset â†’ Verify form cleared
  
- âœ… **Loading States:**
  - Click button â†’ See spinner/loading
  - Wait for action complete
  - Verify loading state disappeared
  - Verify result displayed
  
- âœ… **Button States:**
  - Disabled button â†’ Verify cannot click
  - Enabled button â†’ Verify can click
  - Button with icon â†’ Verify icon displayed
  - Button with text â†’ Verify text displayed

**Implementation Example (Playwright):**
```typescript
// Button Actions Test
test('Button click actions', async ({ page }) => {
  // Click submit
  await page.click('button:has-text("Submit")');
  await expect(page.locator('.spinner')).toBeVisible();
  await expect(page.locator('.success-message')).toBeVisible();
  
  // Click cancel
  await page.click('button:has-text("Cancel")');
  await expect(page.locator('form')).not.toBeVisible();
});
```

#### **4. User Workflows (80% Automated)**
**Tools:** Playwright, Cypress

**Test Cases:**
- âœ… **Complete Workflows:**
  - Login â†’ Create â†’ View â†’ Edit â†’ Delete â†’ Logout
  - Register â†’ Verify email â†’ Login â†’ Dashboard
  - Search â†’ Filter â†’ Sort â†’ Export â†’ Print
  - Multi-step forms: Step 1 â†’ Step 2 â†’ Step 3 â†’ Submit
  
- âœ… **Conditional Workflows:**
  - If condition A â†’ Do action B
  - If condition C â†’ Do action D
  - Else â†’ Do action E
  
- âœ… **Error Scenarios:**
  - Invalid input â†’ Show error â†’ Retry
  - Network error â†’ Show error â†’ Retry
  - Permission denied â†’ Show error â†’ Redirect

**Implementation Example (Playwright):**
```typescript
// User Workflow Test
test('Complete user workflow', async ({ page }) => {
  // Login
  await page.fill('input[name="email"]', 'user@example.com');
  await page.fill('input[name="password"]', 'password123');
  await page.click('button:has-text("Login")');
  
  // Create
  await page.click('button:has-text("ThÃªm má»›i")');
  await page.fill('input[name="name"]', 'Test Item');
  await page.click('button:has-text("LÆ°u")');
  
  // View
  await page.click('text=Test Item');
  await expect(page.locator('text=Test Item')).toBeVisible();
  
  // Edit
  await page.click('button:has-text("Sá»­a")');
  await page.fill('input[name="name"]', 'Updated Item');
  await page.click('button:has-text("LÆ°u")');
  
  // Delete
  await page.click('button:has-text("XÃ³a")');
  await page.click('button:has-text("XÃ¡c nháº­n")');
  
  // Logout
  await page.click('button:has-text("Logout")');
  await expect(page.locator('input[name="email"]')).toBeVisible();
});
```

#### **5. Data Validation (100% Automated)**
**Tools:** Unit tests, Integration tests

**Test Cases:**
- âœ… **Frontend Validation:**
  - Required fields: Empty â†’ Error
  - Format validation: Invalid format â†’ Error
  - Range validation: Out of range â†’ Error
  - Real-time validation: Type â†’ See error
  
- âœ… **Backend Validation:**
  - API validation: Invalid data â†’ Error response
  - Business logic validation: Invalid logic â†’ Error
  - Database constraints: Invalid data â†’ Error
  
- âœ… **Data Sync:**
  - Frontend data = Backend response
  - Backend response = Database data
  - Verify consistency across layers

#### **6. API Testing (100% Automated)**
**Tools:** Supertest, Postman, MSW

**Test Cases:**
- âœ… **CRUD API:**
  - GET: Retrieve data â†’ Verify response
  - POST: Create data â†’ Verify created
  - PUT: Update data â†’ Verify updated
  - DELETE: Delete data â†’ Verify deleted
  - PATCH: Partial update â†’ Verify updated
  
- âœ… **Error Handling:**
  - Invalid data â†’ Error response
  - Unauthorized â†’ 401 error
  - Not found â†’ 404 error
  - Server error â†’ 500 error

**Implementation Example (Supertest):**
```typescript
// API Testing
// Note: "Entity" lÃ  generic term. Thay tháº¿ báº±ng domain-specific term cá»§a báº¡n
describe('Entity API', () => {
  test('POST /api/entities - Create entity', async () => {
    const response = await request(app)
      .post('/api/entities')
      .send({ name: 'Test Entity', description: 'Entity description' });
    expect(response.status).toBe(201);
    expect(response.body.name).toBe('Test Entity');
  });
  
  test('GET /api/entities/:id - Get entity', async () => {
    const response = await request(app)
      .get('/api/entities/1');
    expect(response.status).toBe(200);
    expect(response.body.id).toBe(1);
  });
});
```

#### **7. Database Testing (100% Automated)**
**Tools:** Integration tests, Database testing tools

**Test Cases:**
- âœ… **CRUD Operations:**
  - CREATE: Insert data â†’ Verify saved
  - READ: Select data â†’ Verify retrieved
  - UPDATE: Update data â†’ Verify updated
  - DELETE: Delete data â†’ Verify deleted
  
- âœ… **Transactions:**
  - Multiple operations â†’ Rollback if error
  - Verify data consistency
  - Verify foreign key constraints
  
- âœ… **Relationships:**
  - Foreign keys: Verify relationships
  - Cascading: Verify cascading actions
  - Constraints: Verify constraints enforced

### ğŸ› ï¸ **IMPLEMENTATION GUIDE - HÆ°á»›ng Dáº«n Triá»ƒn Khai:**

#### **Step 1: Setup Automation Tools**
```bash
# Install Playwright
npm install -D @playwright/test
npx playwright install

# Or Cypress
npm install -D cypress

# Install Supertest for API testing
npm install -D supertest
```

#### **Step 2: Configure Test Environment**
```typescript
// playwright.config.ts
export default {
  testDir: './tests',
  use: {
    baseURL: 'http://localhost:3000',
    screenshot: 'only-on-failure',
    video: 'retain-on-failure',
  },
};
```

#### **Step 3: Write Automation Tests**
```typescript
// tests/crud.spec.ts
// Note: "Entity" lÃ  generic term. Thay tháº¿ báº±ng domain-specific term cá»§a báº¡n
import { test, expect } from '@playwright/test';

test.describe('CRUD Operations', () => {
  test('Complete CRUD workflow', async ({ page }) => {
    // CREATE
    await page.goto('/entities');
    await page.click('button:has-text("ThÃªm má»›i")');
    await page.fill('input[name="name"]', 'Test Entity');
    await page.click('button:has-text("LÆ°u")');
    await expect(page.locator('.success-message')).toBeVisible();
    
    // READ
    await expect(page.locator('text=Test Entity')).toBeVisible();
    
    // UPDATE
    await page.click('text=Test Entity');
    await page.click('button:has-text("Sá»­a")');
    await page.fill('input[name="name"]', 'Updated Entity');
    await page.click('button:has-text("LÆ°u")');
    
    // DELETE
    await page.click('button:has-text("XÃ³a")');
    await page.click('button:has-text("XÃ¡c nháº­n")');
    await expect(page.locator('text=Updated Entity')).not.toBeVisible();
  });
});
```

#### **Step 4: Integrate vÃ o CI/CD**
```yaml
# .github/workflows/test.yml
name: Automated Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm install
      - run: npx playwright test
      - uses: actions/upload-artifact@v3
        if: failure()
        with:
          name: playwright-report
          path: playwright-report/
```

### ğŸ“Š **AUTOMATION COVERAGE TARGETS:**

**Must Achieve:**
- âœ… CRUD Operations: 100% automated
- âœ… Form Filling: 100% automated
- âœ… Buttons & Actions: 100% automated
- âœ… Data Validation: 100% automated
- âœ… API Testing: 100% automated
- âœ… Database Testing: 100% automated
- âœ… User Workflows: 80% automated (critical paths)
- âœ… Integration Testing: 100% automated

**Optional (Manual):**
- âš ï¸ UX/Design Review: 100% manual (cáº§n human judgment)
- âš ï¸ Usability Testing: 70% manual (cáº§n user feedback)
- âš ï¸ Business Acceptance: 100% manual (cáº§n stakeholders)

### ğŸ’¡ **BEST PRACTICES:**

1. **Automate First:**
   - Write automation tests cho má»i feature má»›i
   - Automate critical paths trÆ°á»›c
   - Automate repetitive tests

2. **Maintain Tests:**
   - Update tests khi code changes
   - Fix flaky tests ngay láº­p tá»©c
   - Review test coverage regularly

3. **CI/CD Integration:**
   - Run tests automatically on push
   - Run tests before merge
   - Generate test reports
   - Alert on failures

4. **Test Data Management:**
   - Setup test data trÆ°á»›c khi test
   - Cleanup test data sau khi test
   - Use test database riÃªng
   - Reset database state giá»¯a cÃ¡c tests

### ğŸ¯ **AUTOMATION PRIORITY:**

**Priority 1 (Must Automate):**
- CRUD operations
- Form filling & submission
- Buttons & actions
- Data validation
- API endpoints
- Database operations

**Priority 2 (Should Automate):**
- User workflows (critical paths)
- Integration tests
- Performance tests
- Security scanning

**Priority 3 (Optional):**
- Visual regression (70% automated)
- Accessibility checks (50% automated)
- Compatibility testing (90% automated)

**Manual Only:**
- UX/Design review
- Usability testing
- Business acceptance
- Ad-hoc testing

---

**9. REGRESSION TESTING (Test Há»“i Quy)**
- âœ… Test sau má»—i change (ensure no breaking changes)
- âœ… Automated regression tests
- âœ… Test critical paths (100% coverage)
- **Lá»£i Ã­ch:** Prevent breaking changes

**10. PRODUCTION-LIKE TESTING (Test Giá»‘ng Production)**
- âœ… Test trong mÃ´i trÆ°á»ng giá»‘ng production
- âœ… Test vá»›i real data patterns
- âœ… Test deployment procedures
- **Lá»£i Ã­ch:** Catch production issues early

**11. USER ACCEPTANCE TESTING (UAT)**
- âœ… Test vá»›i real users
- âœ… Beta testing, stakeholder testing
- âœ… Collect user feedback
- **Lá»£i Ã­ch:** Ensure user satisfaction

**12. MONITORING & ALERTING TESTING (Test Monitoring)**
- âœ… Test monitoring systems
- âœ… Test alerting mechanisms
- âœ… Test error tracking
- **Lá»£i Ã­ch:** Ensure production monitoring works

---

### ğŸ“‹ **ULTIMATE TESTING CHECKLIST - 14 Categories (A-N)**

**A. FUNCTIONAL TESTING (Chá»©c NÄƒng):**
- [ ] Unit Testing (> 80% coverage)
- [ ] Integration Testing (FE â†” BE â†” DB)
- [ ] System Testing (end-to-end workflows)
- [ ] Regression Testing (sau má»—i change)
- [ ] Smoke Testing (quick sanity check)

**B. UI/UX TESTING (Giao Diá»‡n):**
- [ ] Navigation & Menu (main menu, submenu, menu con)
- [ ] Buttons & Actions (click, submit, cancel, delete, loading states)
- [ ] Forms & Validation (required, format, real-time validation)
- [ ] Data Display (format, pagination, sorting, filtering)
- [ ] Loading States (spinner, skeleton)
- [ ] Error States (error messages, retry)
- [ ] Responsive Design (mobile, tablet, desktop)
- [ ] Visual Regression (UI visual changes)

**C. DATA TESTING (Dá»¯ Liá»‡u):**
- [ ] Frontend Validation (required, format, range, business rules)
- [ ] Backend Validation (API validation, business logic, DB constraints)
- [ ] Data Sync (FE = BE = DB consistency)
- [ ] Data Integrity (no orphaned records, transactions)
- [ ] Data Migration (migration testing, rollback)

**D. INTEGRATION TESTING (TÃ­ch Há»£p):**
- [ ] API Integration (GET, POST, PUT, DELETE, PATCH, error handling)
- [ ] Database Integration (CRUD, transactions, relationships, constraints)
- [ ] Third-party Integration (external APIs, services)
- [ ] Authentication Integration (JWT, OAuth, SSO)
- [ ] Authorization Integration (permissions, roles, access control)
- [ ] End-to-End Integration (FE â†’ BE â†’ DB flows)

**E. PERFORMANCE TESTING (Hiá»‡u NÄƒng):**
- [ ] Load Testing (normal load, < 2s response time)
- [ ] Stress Testing (overload, graceful degradation)
- [ ] Scalability Testing (scale up/down, auto-scaling)
- [ ] Endurance Testing (long-running, memory leaks)
- [ ] Spike Testing (sudden traffic spikes)
- [ ] Volume Testing (large data sets)

**F. SECURITY TESTING (Báº£o Máº­t):**
- [ ] Authentication Testing (login, logout, session)
- [ ] Authorization Testing (permissions, roles, access control)
- [ ] Injection Testing (SQL injection, XSS, command injection)
- [ ] CSRF Testing (CSRF token validation)
- [ ] Data Protection Testing (encryption, hashing)
- [ ] API Security Testing (rate limiting, authentication)
- [ ] Dependency Security Testing (vulnerability scanning)

**G. COMPATIBILITY TESTING (TÆ°Æ¡ng ThÃ­ch):**
- [ ] Cross-Browser Testing (Chrome, Firefox, Safari, Edge)
- [ ] Cross-Device Testing (mobile, tablet, desktop)
- [ ] Cross-OS Testing (Windows, macOS, Linux, iOS, Android)
- [ ] Backward Compatibility (old versions, migrations)
- [ ] Forward Compatibility (future versions)

**H. RELIABILITY TESTING (Äá»™ Tin Cáº­y):**
- [ ] Recovery Testing (disaster recovery, data recovery)
- [ ] Failover Testing (high availability, redundancy)
- [ ] Error Handling Testing (graceful error handling)
- [ ] Resilience Testing (system resilience, fault tolerance)
- [ ] Backup & Restore Testing (backup, restore procedures)

**I. USABILITY TESTING (Kháº£ NÄƒng Sá»­ Dá»¥ng):**
- [ ] User Experience Testing (UX, ease of use)
- [ ] Accessibility Testing (WCAG AA compliance)
- [ ] User Interface Testing (UI design, consistency)
- [ ] User Feedback Testing (user feedback, surveys)
- [ ] A/B Testing (different designs, features)

**J. ACCEPTANCE TESTING (Cháº¥p Nháº­n):**
- [ ] UAT - User Acceptance Testing (real users)
- [ ] Beta Testing (limited users, feedback)
- [ ] Business Acceptance Testing (stakeholders)
- [ ] Alpha Testing (internal testing)
- [ ] Contract Testing (API contracts, consumer/provider)

**K. DEPLOYMENT TESTING (Triá»ƒn Khai):**
- [ ] Deployment Testing (deployment procedures)
- [ ] Rollback Testing (rollback procedures)
- [ ] Environment Testing (dev, staging, production)
- [ ] Configuration Testing (environment variables, configs)
- [ ] Infrastructure Testing (server, database, network)

**L. MONITORING & ALERTING TESTING (GiÃ¡m SÃ¡t):**
- [ ] Monitoring Testing (error tracking, performance monitoring)
- [ ] Alerting Testing (alert rules, notifications)
- [ ] Logging Testing (log levels, log rotation)
- [ ] Metrics Testing (metrics collection, dashboards)
- [ ] Health Check Testing (health endpoints, status checks)

**M. DOCUMENTATION TESTING (TÃ i Liá»‡u):**
- [ ] User Documentation Testing (user guides, tutorials)
- [ ] Developer Documentation Testing (API docs, code comments)
- [ ] Deployment Documentation Testing (deployment guides)
- [ ] Troubleshooting Documentation Testing (troubleshooting guides)

**N. PRODUCTION READINESS TESTING (Sáºµn SÃ ng Production):**
- [ ] Production-like Environment Testing (test trong mÃ´i trÆ°á»ng giá»‘ng production)
- [ ] Real Data Testing (test vá»›i real data patterns)
- [ ] Production Monitoring Testing (monitoring systems)
- [ ] Disaster Recovery Testing (disaster recovery procedures)
- [ ] Business Continuity Testing (business continuity plans)

---

### ğŸš€ **TESTING WORKFLOW - 7 Phases (HoÃ n Thiá»‡n)**

**Phase 1: Pre-Development (Planning)**
- [ ] Review requirements
- [ ] Design test cases (TDD approach)
- [ ] Identify edge cases (AI-powered)
- [ ] Assess risks (risk-based testing)
- [ ] Prepare test data
- [ ] Setup test environment

**Phase 2: During Development (Continuous)**
- [ ] Write unit tests first (TDD - RED)
- [ ] Write code to pass (TDD - GREEN)
- [ ] Refactor code (TDD - REFACTOR)
- [ ] Write integration tests (after each API endpoint)
- [ ] Quick UI tests (after each UI change)
- [ ] Code review tests (review test coverage)
- [ ] Regression tests (after each change)

**Phase 3: Pre-Commit (Quick Checks)**
- [ ] Quick Self QA (existing - giá»¯ nguyÃªn)
- [ ] Unit tests (fast, < 30 seconds)
- [ ] Linter checks (code quality)
- [ ] Build checks (compile/build)
- [ ] Smoke tests (quick sanity check)

**Phase 4: Pre-Release (Comprehensive)**
- [ ] Full test suite (unit + integration + system + E2E)
- [ ] UI/UX Testing (menu, buttons, forms) - 100% coverage
- [ ] Data Testing (validation, sync) - 100% coverage
- [ ] Integration Testing (FE â†” BE â†” DB) - 100% coverage
- [ ] System Testing (end-to-end workflows) - 100% coverage
- [ ] Performance Testing (load, stress, scalability)
- [ ] Security Testing (authentication, authorization, injection)
- [ ] Compatibility Testing (cross-browser, cross-device)
- [ ] Reliability Testing (recovery, failover, resilience)
- [ ] Usability Testing (UX, accessibility)
- [ ] Visual Regression Testing (UI visual changes)
- [ ] Regression Testing (test after changes)

**Phase 5: Acceptance Testing (UAT & Beta)**
- [ ] UAT - User Acceptance Testing (real users test)
  - âœ… **UAT Manual Testing Workflow** (Xem section "UAT MANUAL TESTING" bÃªn dÆ°á»›i)
  - âœ… **UAT Manual Testing Checklist** (Xem section "UAT MANUAL TESTING" bÃªn dÆ°á»›i)
  - âœ… **UAT Test Scenarios** (Xem section "UAT MANUAL TESTING" bÃªn dÆ°á»›i)
- [ ] Beta Testing (limited users, collect feedback)
- [ ] Business Acceptance Testing (stakeholders review)
- [ ] Alpha Testing (internal testing)
- [ ] User Feedback Collection (surveys, interviews)

---

### ğŸ‘¤ **UAT MANUAL TESTING - Test Giá»‘ng NgÆ°á»i DÃ¹ng (100% Manual)**

**Má»¥c Ä‘Ã­ch:** Test há»‡ thá»‘ng nhÆ° ngÆ°á»i dÃ¹ng thá»±c táº¿ sá»­ dá»¥ng, phÃ¡t hiá»‡n váº¥n Ä‘á» UX/UI mÃ  automation khÃ´ng thá»ƒ phÃ¡t hiá»‡n

**Khi nÃ o dÃ¹ng:** 
- âœ… TrÆ°á»›c khi release (Phase 5)
- âœ… Sau khi automation tests pass
- âœ… Khi cÃ³ thay Ä‘á»•i UX/UI lá»›n
- âœ… Khi cáº§n feedback tá»« real users

**Äáº·c Ä‘iá»ƒm:**
- âœ… **100% Manual** - Real users test thá»§ cÃ´ng
- âœ… **Human judgment** - Cáº§n phÃ¡n Ä‘oÃ¡n cá»§a ngÆ°á»i dÃ¹ng
- âœ… **UX/Design review** - ÄÃ¡nh giÃ¡ tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng
- âœ… **Business acceptance** - Stakeholders review

**âš ï¸ QUAN TRá»ŒNG: Quy TrÃ¬nh Linh Hoáº¡t - Ãp Dá»¥ng Cho Má»i Loáº¡i á»¨ng Dá»¥ng**

**Logic linh hoáº¡t:**
- âœ… **Náº¿u cÃ³ authentication:** Test login/register/logout
- âœ… **Náº¿u KHÃ”NG cÃ³ authentication:** Bá» qua bÆ°á»›c authentication
- âœ… **Náº¿u cÃ³ CRUD:** Test thÃªm/xÃ³a/sá»­a
- âœ… **Náº¿u KHÃ”NG cÃ³ CRUD:** Bá» qua bÆ°á»›c CRUD, chá»‰ test cÃ¡c tÃ­nh nÄƒng cÃ³ sáºµn
- âœ… **Náº¿u cÃ³ data:** Test táº¡o dá»¯ liá»‡u
- âœ… **Náº¿u KHÃ”NG cÃ³ data:** Bá» qua bÆ°á»›c táº¡o dá»¯ liá»‡u
- âœ… **Náº¿u cÃ³ forms:** Test form validation
- âœ… **Náº¿u KHÃ”NG cÃ³ forms:** Bá» qua bÆ°á»›c form testing

**Ãp dá»¥ng cho:**
- âœ… **á»¨ng dá»¥ng phá»©c táº¡p:** CRM, ERP, Booking system (cÃ³ auth, CRUD, data)
- âœ… **á»¨ng dá»¥ng Ä‘Æ¡n giáº£n:** Landing page, Calculator, Tool (khÃ´ng cÃ³ auth, khÃ´ng cÃ³ CRUD)
- âœ… **á»¨ng dá»¥ng Ä‘á»c:** Blog, Documentation (khÃ´ng cÃ³ auth, khÃ´ng cÃ³ CRUD, chá»‰ Ä‘á»c)
- âœ… **á»¨ng dá»¥ng tÃ­nh toÃ¡n:** Calculator, Converter (khÃ´ng cÃ³ auth, khÃ´ng cÃ³ data storage)
- âœ… **á»¨ng dá»¥ng hiá»ƒn thá»‹:** Dashboard, Analytics (khÃ´ng cÃ³ CRUD, chá»‰ xem)

---

#### **ğŸ“‹ UAT MANUAL TESTING WORKFLOW - Quy TrÃ¬nh Test Giá»‘ng NgÆ°á»i DÃ¹ng**

**BÆ¯á»šC 1: PREPARE TEST DATA (Chuáº©n Bá»‹ Dá»¯ Liá»‡u Test)**
```
âš ï¸ CONDITIONAL: TÃ¹y thuá»™c vÃ o loáº¡i á»©ng dá»¥ng

1. Táº¡o dá»¯ liá»‡u test máº«u (âš ï¸ Náº¿u CÃ“ data storage):
   â†’ Táº¡o entities máº«u (customers, products, services, etc.)
   â†’ Táº¡o transactions máº«u (orders, bookings, requests, etc.)
   â†’ Táº¡o users máº«u vá»›i cÃ¡c roles khÃ¡c nhau (náº¿u cÃ³ multi-user)
   â†’ Táº¡o documents máº«u (contracts, records, etc.)

2. Prepare test input/output (âš ï¸ Náº¿u KHÃ”NG CÃ“ data storage):
   â†’ Prepare test input values (náº¿u lÃ  calculator, converter)
   â†’ Prepare test scenarios (náº¿u lÃ  tool, landing page)
   â†’ Prepare test data patterns (náº¿u lÃ  analytics, dashboard)

3. Setup test environment:
   â†’ Environment giá»‘ng production (staging)
   â†’ Test database vá»›i dá»¯ liá»‡u máº«u (âš ï¸ Náº¿u CÃ“ database)
   â†’ Test accounts cho real users (âš ï¸ Náº¿u CÃ“ authentication)
   â†’ Test input/output scenarios (âš ï¸ Náº¿u KHÃ”NG CÃ“ database)

4. Prepare test scenarios:
   â†’ List cÃ¡c workflows cáº§n test (conditional - chá»‰ workflows cÃ³ trong app)
   â†’ List cÃ¡c features cáº§n test (táº¥t cáº£ features chÃ­nh)
   â†’ List cÃ¡c edge cases cáº§n test
   â†’ Prepare test checklist (conditional - chá»‰ test items phÃ¹ há»£p)
```

**BÆ¯á»šC 2: MANUAL TESTING STEPS (CÃ¡c BÆ°á»›c Test Thá»§ CÃ´ng)**

**2.1. Authentication & Navigation (XÃ¡c thá»±c & Äiá»u hÆ°á»›ng)**
```
âš ï¸ CONDITIONAL: Chá»‰ test náº¿u á»©ng dá»¥ng CÃ“ authentication

âœ… Náº¿u CÃ“ Authentication:
   â†’ User: ÄÄƒng nháº­p vá»›i test account
   â†’ User: Verify login thÃ nh cÃ´ng
   â†’ User: Verify redirect Ä‘áº¿n dashboard/home
   â†’ User: Test logout
   â†’ User: Test "QuÃªn máº­t kháº©u" (náº¿u cÃ³)
   â†’ User: Test register (náº¿u cÃ³)

âœ… Náº¿u KHÃ”NG CÃ“ Authentication:
   â†’ Bá» qua bÆ°á»›c authentication
   â†’ Báº¯t Ä‘áº§u trá»±c tiáº¿p vá»›i navigation

âœ… Navigation (LuÃ´n test):
   â†’ User: Test menu navigation (náº¿u cÃ³ menu)
   â†’ User: Test breadcrumbs (náº¿u cÃ³ breadcrumbs)
   â†’ User: Test back button (náº¿u cÃ³)
   â†’ User: VÃ o cÃ¡c trang/features chÃ­nh:
     * Trang danh sÃ¡ch (náº¿u cÃ³)
     * Trang chi tiáº¿t (náº¿u cÃ³)
     * Trang táº¡o má»›i (náº¿u cÃ³)
     * Trang sá»­a (náº¿u cÃ³)
     * Trang cÃ i Ä‘áº·t (náº¿u cÃ³)
     * CÃ¡c tÃ­nh nÄƒng chÃ­nh cá»§a á»©ng dá»¥ng
```

**2.2. CRUD Operations - Manual Test (ThÃªm/XÃ³a/Sá»­a Thá»§ CÃ´ng)**
```
âš ï¸ CONDITIONAL: Chá»‰ test náº¿u á»©ng dá»¥ng CÃ“ CRUD operations

âœ… Náº¿u CÃ“ CRUD Operations:

   CREATE (Táº¡o Entity/Transaction):
   â†’ User: VÃ o trang danh sÃ¡ch (náº¿u cÃ³)
   â†’ User: Click nÃºt "ThÃªm má»›i" / "Táº¡o má»›i"
   â†’ User: Fill form vá»›i dá»¯ liá»‡u test
   â†’ User: Click "LÆ°u" / "Submit"
   â†’ User: Verify success message hiá»ƒn thá»‹
   â†’ User: Verify data xuáº¥t hiá»‡n trong danh sÃ¡ch (náº¿u cÃ³)
   â†’ User: Verify data saved Ä‘Ãºng (vÃ o trang chi tiáº¿t check)

   READ (Xem Entity/Transaction):
   â†’ User: VÃ o trang danh sÃ¡ch (náº¿u cÃ³)
   â†’ User: Click vÃ o entity Ä‘á»ƒ xem chi tiáº¿t (náº¿u cÃ³)
   â†’ User: Verify data hiá»ƒn thá»‹ Ä‘Ãºng
   â†’ User: Verify format Ä‘Ãºng (date, currency, number)
   â†’ User: Test pagination (náº¿u cÃ³)
   â†’ User: Test sorting/filtering (náº¿u cÃ³)
   â†’ User: Test search (náº¿u cÃ³)

   UPDATE (Sá»­a Entity/Transaction):
   â†’ User: VÃ o trang chi tiáº¿t (náº¿u cÃ³)
   â†’ User: Click nÃºt "Sá»­a" / "Edit"
   â†’ User: Verify form pre-filled vá»›i data hiá»‡n táº¡i
   â†’ User: Update cÃ¡c fields
   â†’ User: Click "LÆ°u" / "Save"
   â†’ User: Verify success message hiá»ƒn thá»‹
   â†’ User: Verify data updated Ä‘Ãºng (check láº¡i chi tiáº¿t)

   DELETE (XÃ³a Entity/Transaction):
   â†’ User: VÃ o trang chi tiáº¿t hoáº·c danh sÃ¡ch
   â†’ User: Click nÃºt "XÃ³a" / "Delete"
   â†’ User: Verify confirmation dialog hiá»ƒn thá»‹
   â†’ User: Click "XÃ¡c nháº­n" / "Confirm"
   â†’ User: Verify success message hiá»ƒn thá»‹
   â†’ User: Verify data khÃ´ng cÃ²n trong danh sÃ¡ch
   â†’ User: Test cancel deletion (click "Há»§y")

âœ… Náº¿u KHÃ”NG CÃ“ CRUD Operations:
   â†’ Bá» qua bÆ°á»›c CRUD
   â†’ Chuyá»ƒn sang test cÃ¡c tÃ­nh nÄƒng chÃ­nh cá»§a á»©ng dá»¥ng:
     * Test input/output (náº¿u lÃ  calculator, converter)
     * Test display (náº¿u lÃ  dashboard, analytics)
     * Test navigation (náº¿u lÃ  blog, documentation)
     * Test cÃ¡c chá»©c nÄƒng Ä‘áº·c thÃ¹ cá»§a á»©ng dá»¥ng
```

**2.3. Buttons & Actions - Manual Test (Click CÃ¡c NÃºt Thá»§ CÃ´ng)**
```
âœ… Button Click Actions:
   â†’ User: Click nÃºt "Submit" â†’ Verify action executed
   â†’ User: Click nÃºt "Cancel" â†’ Verify form cancelled
   â†’ User: Click nÃºt "Delete" â†’ Verify confirmation dialog
   â†’ User: Click nÃºt "Edit" â†’ Verify edit mode activated
   â†’ User: Click nÃºt "Save" â†’ Verify data saved
   â†’ User: Click nÃºt "Reset" â†’ Verify form cleared
   â†’ User: Click nÃºt "Back" â†’ Verify navigation back
   â†’ User: Click nÃºt "Export" â†’ Verify export file
   â†’ User: Click nÃºt "Print" â†’ Verify print dialog

âœ… Loading States:
   â†’ User: Click button â†’ Verify spinner/loading hiá»ƒn thá»‹
   â†’ User: Wait for action complete
   â†’ User: Verify loading state disappeared
   â†’ User: Verify result displayed

âœ… Button States:
   â†’ User: Verify disabled button khÃ´ng thá»ƒ click
   â†’ User: Verify enabled button cÃ³ thá»ƒ click
   â†’ User: Verify button vá»›i icon hiá»ƒn thá»‹ Ä‘Ãºng
   â†’ User: Verify button vá»›i text hiá»ƒn thá»‹ Ä‘Ãºng
```

**2.4. Forms & Validation - Manual Test (Form & Validation Thá»§ CÃ´ng)**
```
âœ… Fill Forms:
   â†’ User: Fill text inputs
   â†’ User: Fill number inputs
   â†’ User: Select date tá»« date picker
   â†’ User: Select option tá»« dropdown
   â†’ User: Check/uncheck checkboxes
   â†’ User: Select radio button
   â†’ User: Upload file
   â†’ User: Fill text area

âœ… Form Validation:
   â†’ User: Submit form empty â†’ Verify error messages
   â†’ User: Fill invalid format â†’ Verify format error
   â†’ User: Fill out of range â†’ Verify range error
   â†’ User: Type invalid data â†’ Verify real-time validation
   â†’ User: Test business rules validation

âœ… Form Submission:
   â†’ User: Submit valid form â†’ Verify success
   â†’ User: Submit invalid form â†’ Verify errors
   â†’ User: Cancel form â†’ Verify cancelled
   â†’ User: Reset form â†’ Verify cleared
```

**2.5. Data Creation - Manual Test (Táº¡o Dá»¯ Liá»‡u Thá»§ CÃ´ng)**
```
âš ï¸ CONDITIONAL: Chá»‰ test náº¿u á»©ng dá»¥ng CÃ“ data storage/CRUD

âœ… Náº¿u CÃ“ Data Storage/CRUD:
   â†’ User: Táº¡o entity máº«u (customer, product, service, etc.)
   â†’ User: Táº¡o transaction máº«u (order, booking, request, etc.)
   â†’ User: Táº¡o document máº«u (contract, record, etc.)
   â†’ User: Táº¡o user máº«u vá»›i roles khÃ¡c nhau (náº¿u cÃ³ multi-user)
   â†’ User: Verify táº¥t cáº£ data created Ä‘Ãºng

âœ… Náº¿u KHÃ”NG CÃ“ Data Storage:
   â†’ Bá» qua bÆ°á»›c táº¡o dá»¯ liá»‡u
   â†’ Test vá»›i input/output táº¡m thá»i:
     * Test vá»›i cÃ¡c giÃ¡ trá»‹ input khÃ¡c nhau
     * Test vá»›i cÃ¡c scenarios khÃ¡c nhau
     * Test vá»›i edge cases

âœ… Táº¡o Test Scenarios (LuÃ´n test):
   â†’ User: Táº¡o happy path scenario
   â†’ User: Táº¡o edge case scenario
   â†’ User: Táº¡o error scenario
   â†’ User: Táº¡o multi-step workflow scenario (náº¿u cÃ³)
```

**2.6. User Workflows - Manual Test (Workflows Thá»§ CÃ´ng)**
```
âš ï¸ CONDITIONAL: Test workflows phÃ¹ há»£p vá»›i á»©ng dá»¥ng

âœ… Náº¿u CÃ“ Authentication + CRUD:
   â†’ User: Login â†’ Create Entity â†’ View â†’ Edit â†’ Delete â†’ Logout
   â†’ User: Register â†’ Verify email â†’ Login â†’ Dashboard
   â†’ User: Search â†’ Filter â†’ Sort â†’ Export â†’ Print

âœ… Náº¿u CÃ“ Authentication nhÆ°ng KHÃ”NG CÃ“ CRUD:
   â†’ User: Login â†’ View Dashboard â†’ Navigate â†’ Logout
   â†’ User: Login â†’ View Content â†’ Search/Filter â†’ Logout

âœ… Náº¿u KHÃ”NG CÃ“ Authentication nhÆ°ng CÃ“ CRUD:
   â†’ User: Create Entity â†’ View â†’ Edit â†’ Delete
   â†’ User: Search â†’ Filter â†’ Sort â†’ Export

âœ… Náº¿u KHÃ”NG CÃ“ Authentication vÃ  KHÃ”NG CÃ“ CRUD:
   â†’ User: Input â†’ Process â†’ Output (náº¿u lÃ  calculator, converter)
   â†’ User: Navigate â†’ View Content (náº¿u lÃ  blog, documentation)
   â†’ User: Use Tool â†’ Get Result (náº¿u lÃ  tool)

âœ… Multi-step Workflows (âš ï¸ Náº¿u CÃ“):
   â†’ User: Multi-step forms: Step 1 â†’ Step 2 â†’ Step 3 â†’ Submit
   â†’ User: Wizard: Step 1 â†’ Step 2 â†’ ... â†’ Step N â†’ Complete

âœ… Conditional Workflows (âš ï¸ Náº¿u CÃ“ conditional logic):
   â†’ User: If condition A â†’ Do action B
   â†’ User: If condition C â†’ Do action D
   â†’ User: Else â†’ Do action E

âœ… Error Scenarios (LuÃ´n test):
   â†’ User: Invalid input â†’ Verify error â†’ Retry
   â†’ User: Network error â†’ Verify error â†’ Retry
   â†’ User: Permission denied â†’ Verify error â†’ Redirect (âš ï¸ Náº¿u CÃ“ auth)
```

**BÆ¯á»šC 3: COLLECT FEEDBACK (Thu Tháº­p Pháº£n Há»“i)**
```
1. User Feedback:
   â†’ User feedback vá» UX/UI
   â†’ User feedback vá» functionality
   â†’ User feedback vá» performance
   â†’ User feedback vá» bugs/issues

2. Bug Reports:
   â†’ Document bugs found
   â†’ Document steps to reproduce
   â†’ Document screenshots/videos
   â†’ Document severity (critical, high, medium, low)

3. Improvement Suggestions:
   â†’ UX improvements
   â†’ Feature suggestions
   â†’ Performance improvements
   â†’ Accessibility improvements
```

**BÆ¯á»šC 4: FIX ISSUES & RE-TEST (Sá»­a Lá»—i & Test Láº¡i)**
```
1. Fix Issues:
   â†’ Fix bugs based on feedback
   â†’ Improve UX based on feedback
   â†’ Optimize performance based on feedback
   â†’ Add features based on suggestions

2. Re-Test:
   â†’ Re-test fixed bugs
   â†’ Re-test improved features
   â†’ Re-test workflows
   â†’ Verify fixes work correctly

3. Final Approval:
   â†’ Get user approval
   â†’ Get stakeholder approval
   â†’ Sign off on release
```

---

#### **ğŸ“ UAT MANUAL TESTING CHECKLIST - Checklist Test Thá»§ CÃ´ng**

**âœ… AUTHENTICATION & NAVIGATION:**
- [ ] Login/Register workflow
- [ ] Logout workflow
- [ ] Navigation menu (main menu, submenu)
- [ ] Breadcrumbs navigation
- [ ] Back button
- [ ] Page routing (vÃ o cÃ¡c trang)

**âœ… CRUD OPERATIONS (Manual Test):**
- [ ] CREATE (Táº¡o entity/transaction má»›i)
- [ ] READ (Xem danh sÃ¡ch vÃ  chi tiáº¿t)
- [ ] UPDATE (Sá»­a entity/transaction)
- [ ] DELETE (XÃ³a entity/transaction)
- [ ] Verify data consistency (FE = BE = DB)

**âœ… BUTTONS & ACTIONS (Manual Test):**
- [ ] Click cÃ¡c nÃºt (Submit, Cancel, Delete, Edit, Save)
- [ ] Loading states (spinner khi Ä‘ang xá»­ lÃ½)
- [ ] Disabled states (nÃºt disabled khi cáº§n)
- [ ] Button icons/text hiá»ƒn thá»‹ Ä‘Ãºng
- [ ] Button actions execute Ä‘Ãºng

**âœ… FORMS & VALIDATION (Manual Test):**
- [ ] Fill form fields (text, number, date, dropdown, checkbox, radio, file upload)
- [ ] Form validation (required, format, range, business rules)
- [ ] Real-time validation (validate khi typing)
- [ ] Form submission (success, error, cancel, reset)
- [ ] Error messages hiá»ƒn thá»‹ Ä‘Ãºng vÃ  rÃµ rÃ ng

**âœ… DATA CREATION (Manual Test - âš ï¸ Náº¿u CÃ“ data storage):**
- [ ] Táº¡o entity máº«u (customer, product, service, project, etc.) (âš ï¸ Náº¿u CÃ“)
- [ ] Táº¡o transaction máº«u (order, booking, request, etc.) (âš ï¸ Náº¿u CÃ“)
- [ ] Táº¡o document máº«u (contract, record, etc.) (âš ï¸ Náº¿u CÃ“)
- [ ] Táº¡o user máº«u vá»›i roles khÃ¡c nhau (âš ï¸ Náº¿u CÃ“ multi-user)
- [ ] Verify táº¥t cáº£ data created Ä‘Ãºng (âš ï¸ Náº¿u CÃ“ data storage)
- [ ] Test vá»›i input/output táº¡m thá»i (âš ï¸ Náº¿u KHÃ”NG CÃ“ data storage)

**âœ… NAVIGATION (Manual Test):**
- [ ] VÃ o trang danh sÃ¡ch (List page) (âš ï¸ Náº¿u CÃ“)
- [ ] VÃ o trang chi tiáº¿t (Detail page) (âš ï¸ Náº¿u CÃ“)
- [ ] VÃ o trang táº¡o má»›i (Create page) (âš ï¸ Náº¿u CÃ“)
- [ ] VÃ o trang sá»­a (Edit page) (âš ï¸ Náº¿u CÃ“)
- [ ] VÃ o trang cÃ i Ä‘áº·t (Settings page) (âš ï¸ Náº¿u CÃ“)
- [ ] VÃ o cÃ¡c tÃ­nh nÄƒng chÃ­nh cá»§a á»©ng dá»¥ng
- [ ] Test menu navigation (âš ï¸ Náº¿u CÃ“ menu)
- [ ] Test breadcrumbs (âš ï¸ Náº¿u CÃ“ breadcrumbs)
- [ ] Test back button (âš ï¸ Náº¿u CÃ“ back button)

**âœ… USER WORKFLOWS (Manual Test):**
- [ ] Complete workflows (Login â†’ Create â†’ View â†’ Edit â†’ Delete â†’ Logout) (âš ï¸ Náº¿u CÃ“ auth + CRUD)
- [ ] Simple workflows (Input â†’ Process â†’ Output) (âš ï¸ Náº¿u KHÃ”NG CÃ“ auth/CRUD)
- [ ] Read-only workflows (Login â†’ View â†’ Logout) (âš ï¸ Náº¿u CÃ“ auth nhÆ°ng KHÃ”NG CÃ“ CRUD)
- [ ] Conditional workflows (If A â†’ B, Else â†’ C) (âš ï¸ Náº¿u CÃ“ conditional logic)
- [ ] Error scenarios (Invalid input â†’ Error â†’ Retry)
- [ ] Multi-step workflows (Step 1 â†’ Step 2 â†’ Step 3 â†’ Submit) (âš ï¸ Náº¿u CÃ“ multi-step)

**âœ… UX/UI QUALITY (Manual Test):**
- [ ] UI design consistency
- [ ] User experience quality
- [ ] Accessibility (keyboard navigation, screen readers)
- [ ] Responsive design (mobile, tablet, desktop)
- [ ] Visual design quality

**âœ… PERFORMANCE (Manual Test):**
- [ ] Page load time (< 3s)
- [ ] Form submission time (< 2s)
- [ ] Data loading time
- [ ] Smooth scrolling/animations
- [ ] No lag/freezing

**âœ… ERROR HANDLING (Manual Test):**
- [ ] Error messages rÃµ rÃ ng vÃ  helpful
- [ ] Error recovery (retry, cancel, go back)
- [ ] Network error handling
- [ ] Server error handling
- [ ] Validation error handling

---

#### **ğŸ¯ UAT TEST SCENARIOS - Test Scenarios Giá»‘ng NgÆ°á»i DÃ¹ng**

**Scenario 1: Táº¡o Entity/Transaction Má»›i (Generic)**
```
**User Story:** User muá»‘n táº¡o entity má»›i trong há»‡ thá»‘ng

**Steps:**
1. User: Login vÃ o há»‡ thá»‘ng
2. User: VÃ o trang danh sÃ¡ch entities
3. User: Click nÃºt "ThÃªm má»›i" / "Táº¡o má»›i"
4. User: Fill form vá»›i dá»¯ liá»‡u test:
   - Text fields (name, description)
   - Number fields (price, quantity)
   - Date fields (date, time)
   - Dropdown fields (category, status)
   - Checkboxes (options, features)
   - File upload (image, document)
5. User: Click "LÆ°u" / "Submit"
6. User: Verify success message hiá»ƒn thá»‹
7. User: Verify entity xuáº¥t hiá»‡n trong danh sÃ¡ch
8. User: Click vÃ o entity Ä‘á»ƒ xem chi tiáº¿t
9. User: Verify data saved Ä‘Ãºng

**Expected Result:**
âœ… Entity created successfully
âœ… Data saved correctly
âœ… Success message displayed
âœ… Entity appears in list
âœ… Data displayed correctly in detail page

**Note:** "Entity" lÃ  generic term. Thay tháº¿ báº±ng domain-specific term cá»§a báº¡n:
- E-commerce: "Product"
- Service: "Service Package"
- CRM: "Customer"
- Booking: "Booking"
- Project Management: "Project"
```

**Scenario 2: Xem & Sá»­a Entity (Generic)**
```
**User Story:** User muá»‘n xem vÃ  sá»­a entity hiá»‡n cÃ³

**Steps:**
1. User: VÃ o trang danh sÃ¡ch entities
2. User: Click vÃ o entity Ä‘á»ƒ xem chi tiáº¿t
3. User: Verify data hiá»ƒn thá»‹ Ä‘Ãºng
4. User: Verify format Ä‘Ãºng (date, currency, number)
5. User: Click nÃºt "Sá»­a" / "Edit"
6. User: Verify form pre-filled vá»›i data hiá»‡n táº¡i
7. User: Update má»™t sá»‘ fields
8. User: Click "LÆ°u" / "Save"
9. User: Verify success message hiá»ƒn thá»‹
10. User: Verify data updated Ä‘Ãºng (check láº¡i chi tiáº¿t)

**Expected Result:**
âœ… Entity displayed correctly
âœ… Form pre-filled correctly
âœ… Data updated successfully
âœ… Success message displayed
âœ… Updated data displayed correctly

**Note:** "Entity" lÃ  generic term. Ãp dá»¥ng cho má»i loáº¡i entity trong há»‡ thá»‘ng.
```

**Scenario 3: XÃ³a Entity (Generic)**
```
**User Story:** User muá»‘n xÃ³a entity khÃ´ng cáº§n thiáº¿t

**Steps:**
1. User: VÃ o trang danh sÃ¡ch entities
2. User: Click vÃ o entity Ä‘á»ƒ xem chi tiáº¿t
3. User: Click nÃºt "XÃ³a" / "Delete"
4. User: Verify confirmation dialog hiá»ƒn thá»‹
5. User: Click "XÃ¡c nháº­n" / "Confirm"
6. User: Verify success message hiá»ƒn thá»‹
7. User: Verify entity khÃ´ng cÃ²n trong danh sÃ¡ch
8. User: Test cancel deletion (click "Há»§y" / "Cancel")

**Expected Result:**
âœ… Confirmation dialog displayed
âœ… Entity deleted successfully
âœ… Success message displayed
âœ… Entity removed from list
âœ… Cancel deletion works correctly

**Note:** "Entity" lÃ  generic term. Ãp dá»¥ng cho má»i loáº¡i entity trong há»‡ thá»‘ng.
```

**Scenario 4: Navigation & Menu (Generic)**
```
**User Story:** User muá»‘n Ä‘iá»u hÆ°á»›ng trong há»‡ thá»‘ng

**Steps:**
1. User: Login vÃ o há»‡ thá»‘ng
2. User: Test main menu navigation
3. User: Click vÃ o menu item â†’ Verify page loaded
4. User: Test submenu navigation
5. User: Test breadcrumbs navigation
6. User: Test back button
7. User: Test vÃ o cÃ¡c trang khÃ¡c nhau:
   - Trang danh sÃ¡ch
   - Trang chi tiáº¿t
   - Trang táº¡o má»›i
   - Trang sá»­a
   - Trang cÃ i Ä‘áº·t

**Expected Result:**
âœ… Navigation works correctly
âœ… Pages load correctly
âœ… Breadcrumbs displayed correctly
âœ… Back button works correctly
âœ… Menu navigation smooth

**Note:** Ãp dá»¥ng cho má»i loáº¡i navigation trong há»‡ thá»‘ng.
```

**Scenario 5: Form Validation (Generic)**
```
**User Story:** User muá»‘n test form validation

**Steps:**
1. User: VÃ o trang táº¡o má»›i entity
2. User: Submit form empty â†’ Verify error messages
3. User: Fill invalid format â†’ Verify format error
4. User: Fill out of range â†’ Verify range error
5. User: Type invalid data â†’ Verify real-time validation
6. User: Test business rules validation
7. User: Fill valid data â†’ Verify success

**Expected Result:**
âœ… Required fields validated
âœ… Format validation works
âœ… Range validation works
âœ… Real-time validation works
âœ… Business rules validation works
âœ… Error messages clear and helpful

**Note:** Ãp dá»¥ng cho má»i loáº¡i form trong há»‡ thá»‘ng.
```

**Scenario 6: Complete User Workflow (Generic) - âš ï¸ Náº¿u CÃ“ CRUD**
```
**User Story:** User muá»‘n test complete workflow tá»« Ä‘áº§u Ä‘áº¿n cuá»‘i

**Steps (Conditional):**
1. User: Login vÃ o há»‡ thá»‘ng (âš ï¸ Náº¿u CÃ“ authentication)
2. User: VÃ o trang danh sÃ¡ch entities (âš ï¸ Náº¿u CÃ“)
3. User: Táº¡o entity má»›i (âš ï¸ Náº¿u CÃ“ create)
4. User: Xem entity vá»«a táº¡o (âš ï¸ Náº¿u CÃ“ read)
5. User: Sá»­a entity (âš ï¸ Náº¿u CÃ“ update)
6. User: Xem entity Ä‘Ã£ sá»­a (âš ï¸ Náº¿u CÃ“ read)
7. User: XÃ³a entity (âš ï¸ Náº¿u CÃ“ delete)
8. User: Verify entity khÃ´ng cÃ²n trong danh sÃ¡ch (âš ï¸ Náº¿u CÃ“ delete)
9. User: Logout (âš ï¸ Náº¿u CÃ“ authentication)

**Expected Result:**
âœ… Complete workflow works end-to-end
âœ… All CRUD operations work correctly (náº¿u cÃ³)
âœ… Data consistency maintained (náº¿u cÃ³ data storage)
âœ… Navigation smooth
âœ… No errors or bugs

**Note:** "Entity" lÃ  generic term. Ãp dá»¥ng cho má»i workflow trong há»‡ thá»‘ng.
```

**Scenario 7: á»¨ng Dá»¥ng ÄÆ¡n Giáº£n - KhÃ´ng CÃ³ Auth/CRUD (Generic)**
```
**User Story:** User muá»‘n test á»©ng dá»¥ng Ä‘Æ¡n giáº£n (khÃ´ng cÃ³ auth, khÃ´ng cÃ³ CRUD)

**VÃ­ dá»¥ á»©ng dá»¥ng:** Calculator, Converter, Landing Page, Tool, Blog (chá»‰ Ä‘á»c)

**Steps:**
1. User: VÃ o trang chÃ­nh cá»§a á»©ng dá»¥ng
2. User: Test cÃ¡c tÃ­nh nÄƒng chÃ­nh:
   â†’ Náº¿u Calculator: Test tÃ­nh toÃ¡n vá»›i cÃ¡c sá»‘ khÃ¡c nhau
   â†’ Náº¿u Converter: Test convert vá»›i cÃ¡c giÃ¡ trá»‹ khÃ¡c nhau
   â†’ Náº¿u Landing Page: Test navigation, links, forms (náº¿u cÃ³)
   â†’ Náº¿u Tool: Test input/output vá»›i cÃ¡c scenarios khÃ¡c nhau
   â†’ Náº¿u Blog: Test Ä‘á»c bÃ i viáº¿t, navigation, search (náº¿u cÃ³)
3. User: Test responsive design (mobile, tablet, desktop)
4. User: Test error handling (invalid input, edge cases)
5. User: Test performance (load time, smooth scrolling)

**Expected Result:**
âœ… TÃ­nh nÄƒng chÃ­nh hoáº¡t Ä‘á»™ng Ä‘Ãºng
âœ… Responsive design works
âœ… Error handling works
âœ… Performance acceptable
âœ… No errors or bugs

**Note:** Ãp dá»¥ng cho á»©ng dá»¥ng Ä‘Æ¡n giáº£n khÃ´ng cÃ³ authentication vÃ  CRUD.
```

**Scenario 8: á»¨ng Dá»¥ng Chá»‰ Äá»c - KhÃ´ng CÃ³ CRUD (Generic)**
```
**User Story:** User muá»‘n test á»©ng dá»¥ng chá»‰ Ä‘á»c (khÃ´ng cÃ³ create/update/delete)

**VÃ­ dá»¥ á»©ng dá»¥ng:** Blog, Documentation, Dashboard, Analytics, News Site

**Steps:**
1. User: Login vÃ o há»‡ thá»‘ng (âš ï¸ Náº¿u CÃ“ authentication)
2. User: Test Ä‘á»c ná»™i dung:
   â†’ Xem danh sÃ¡ch bÃ i viáº¿t/documents
   â†’ Xem chi tiáº¿t tá»«ng bÃ i viáº¿t/document
   â†’ Test pagination (náº¿u cÃ³)
   â†’ Test search (náº¿u cÃ³)
   â†’ Test filter/sort (náº¿u cÃ³)
3. User: Test navigation:
   â†’ Test menu navigation
   â†’ Test breadcrumbs
   â†’ Test links
4. User: Test responsive design
5. User: Test performance

**Expected Result:**
âœ… Äá»c ná»™i dung hoáº¡t Ä‘á»™ng Ä‘Ãºng
âœ… Navigation smooth
âœ… Search/filter/sort works (náº¿u cÃ³)
âœ… Responsive design works
âœ… Performance acceptable

**Note:** Ãp dá»¥ng cho á»©ng dá»¥ng chá»‰ Ä‘á»c, khÃ´ng cÃ³ CRUD operations.
```

---

#### **ğŸ“Š UAT MANUAL TESTING REPORT TEMPLATE - Template BÃ¡o CÃ¡o Test**

**Report Format:**
```
## UAT Manual Testing Report

**Project:** [Project Name]
**Date:** [Date]
**Tester:** [Tester Name]
**Environment:** [Staging/Production-like]

### Test Summary:
- Total Test Cases: [Number]
- Passed: [Number]
- Failed: [Number]
- Blocked: [Number]
- Pass Rate: [Percentage]

### Test Results:

#### âœ… Passed Tests:
- [Test Case 1]: âœ… Passed
- [Test Case 2]: âœ… Passed
- ...

#### âŒ Failed Tests:
- [Test Case 1]: âŒ Failed
  - Issue: [Description]
  - Steps to Reproduce: [Steps]
  - Severity: [Critical/High/Medium/Low]
  - Screenshot: [Link]

#### âš ï¸ Blocked Tests:
- [Test Case 1]: âš ï¸ Blocked
  - Reason: [Description]

### User Feedback:
- UX Feedback: [Feedback]
- UI Feedback: [Feedback]
- Performance Feedback: [Feedback]
- Feature Suggestions: [Suggestions]

### Bugs Found:
1. [Bug 1]: [Description]
2. [Bug 2]: [Description]
3. ...

### Recommendations:
- [Recommendation 1]
- [Recommendation 2]
- ...

### Sign-off:
- Tester: [Name] - [Date]
- Stakeholder: [Name] - [Date]
```

---

**Phase 6: Production Readiness (Pre-Deployment)**
- [ ] Production-like Environment Testing (test trong mÃ´i trÆ°á»ng giá»‘ng production)
- [ ] Real Data Testing (test vá»›i real data patterns)
- [ ] Load/Stress/Scalability Testing (test dÆ°á»›i táº£i cao)
- [ ] Recovery Testing (disaster recovery procedures)
- [ ] Deployment Testing (deployment + rollback procedures)
- [ ] Monitoring & Alerting Testing (monitoring systems)
- [ ] Documentation Testing (user guides, API docs)
- [ ] Final System Testing (toÃ n bá»™ há»‡ thá»‘ng one more time)

**Phase 7: Post-Release (Monitoring)**
- [ ] Production Monitoring (error tracking, performance monitoring)
- [ ] User Feedback Analysis (bug reports, feature requests)
- [ ] Continuous Improvement (better tests, better coverage)
- [ ] Regression Testing (test after production fixes)

---

### ğŸ› ï¸ **TESTING TOOLS & FRAMEWORKS**

**Unit Testing:**
- Jest (JavaScript/TypeScript) - recommended
- Vitest (faster alternative to Jest)
- pytest (Python) - recommended
- Mocha (JavaScript)

**Integration Testing:**
- Supertest (API testing)
- MSW (Mock Service Worker)
- pytest (Python API testing)
- nock (HTTP mocking)

**System & E2E Testing:**
- Playwright (recommended - fast, reliable, cross-browser)
- Cypress (popular, good DX)
- Selenium (classic, cross-browser)

**Performance Testing:**
- K6 (load testing) - recommended
- JMeter (load testing)
- Artillery (load testing)
- Lighthouse (performance audit)
- WebPageTest (load time testing)

**Security Testing:**
- OWASP ZAP (security scanning)
- Snyk (dependency vulnerability scanning)
- Burp Suite (security testing)

**Visual Testing:**
- Percy (visual regression testing)
- Applitools (AI visual testing)
- Chromatic (storybook visual testing)

**Compatibility Testing:**
- BrowserStack (cross-browser testing)
- Sauce Labs (cross-browser testing)
- LambdaTest (cross-browser testing)

**Monitoring & Alerting:**
- Sentry (error tracking)
- Datadog (monitoring)
- New Relic (APM)
- Prometheus (metrics)

**Testing Utilities:**
- Testing Library (React, Vue, Angular)
- Coverage: Istanbul, coverage.py
- Test Impact Analysis: TestImpact

---

### ğŸ“Š **TESTING METRICS & QUALITY GATES**

**Coverage Metrics (Must Achieve):**
- âœ… Code coverage: > 80% (unit tests)
- âœ… API coverage: 100% (all endpoints tested)
- âœ… UI coverage: 100% (all pages/components tested)
- âœ… E2E coverage: Critical paths 100%

**Quality Metrics (Must Achieve):**
- âœ… Pass rate: > 95%
- âœ… Bug detection rate: High (catch bugs early)
- âœ… Test execution time: < 10 minutes (full suite)
- âœ… Test maintenance: Low (stable tests)

**Quality Gates (Must Pass Before Release):**

**Functional Quality Gates:**
- âœ… All unit tests pass (100%)
- âœ… All integration tests pass (100%)
- âœ… All system tests pass (100%)
- âœ… All E2E tests pass (100%)
- âœ… Code coverage > 80%
- âœ… Regression tests pass (100%)

**Non-Functional Quality Gates:**
- âœ… Performance: Response time < 2s, Load time < 3s
- âœ… Security: No critical vulnerabilities
- âœ… Compatibility: All browsers/devices tested
- âœ… Reliability: Recovery tests pass (100%)
- âœ… Usability: Accessibility WCAG AA compliance
- âœ… Visual: No visual regression (except approved)

**Production Readiness Gates:**
- âœ… Production-like environment tested
- âœ… Load/Stress/Scalability tests pass
- âœ… Recovery tests pass (disaster recovery)
- âœ… Deployment tests pass (deployment + rollback)
- âœ… Monitoring systems tested
- âœ… Documentation complete and tested

**Acceptance Gates:**
- âœ… UAT passed (real users approve)
- âœ… Beta testing passed (limited users approve)
- âœ… Business acceptance passed (stakeholders approve)
- âœ… User feedback positive (> 80% satisfaction)

**Test Reporting:**
- âœ… Test results summary (pass/fail)
- âœ… Coverage report (line, branch, function)
- âœ… Performance report (response time, load time)
- âœ… Security report (vulnerabilities, fixes)
- âœ… Bug report (severity, status, fix)

---

### âœ… **BEST PRACTICES - Professional QA**

**Test Design:**
- âœ… Test cases clear vÃ  specific
- âœ… Test data realistic vÃ  diverse
- âœ… Test scenarios cover happy path + error cases
- âœ… Test isolation (each test independent)

**Test Execution:**
- âœ… Run tests automatically (CI/CD)
- âœ… Run tests in parallel (speed up)
- âœ… Run tests in clean environment (isolated)
- âœ… Run tests with real data (realistic)

**Test Maintenance:**
- âœ… Keep tests up-to-date (refactor when code changes)
- âœ… Remove flaky tests (unstable tests)
- âœ… Add tests for new features (don't skip)
- âœ… Review tests regularly (improve coverage)

**Test Reporting:**
- âœ… Report test results clearly (pass/fail summary)
- âœ… Report bugs with details (steps to reproduce)
- âœ… Track test coverage (identify gaps)
- âœ… Share test results (transparency)

---

### ğŸ”„ **INTEGRATION Vá»šI EXISTING WORKFLOW**

**Compatible vá»›i:**
- âœ… **Version 4.0:** MCP Rounds váº«n Ã¡p dá»¥ng (BEFORE + AFTER code)
- âœ… **Universal Workflow:** BÆ°á»›c 0-8 váº«n Ã¡p dá»¥ng (updated: BÆ¯á»šC 6: TESTING, BÆ¯á»šC 7: CLEANUP)
- âœ… **Quick Self QA:** Giá»¯ nguyÃªn (existing - line 4083-4094)
- âœ… **Before Committing:** Giá»¯ nguyÃªn (existing - line 4098-4122)
- âœ… **Code Strategy:** TEST INTEGRATION sections (line 2500-2550, 2893-2923) â†’ TÃ­ch há»£p vá»›i comprehensive testing
- âœ… **Resource Management & Cleanup:** Cleanup sau test (existing - line 4702+)

**Enhancement:**
- âœ… **Pre-Commit:** Quick Self QA (existing) + Quick checks (unit tests, linter)
- âœ… **Pre-Release:** Comprehensive testing (new) - Full test suite vá»›i 14 categories
- âœ… **Post-Release:** Monitoring & Alerting Testing (new)

**Workflow Integration:**
```
BÆ¯á»šC 1: PHÃ‚N TÃCH TASK
BÆ¯á»šC 2: DATABASE ANALYSIS (náº¿u cÃ³)
BÆ¯á»šC 3: ğŸš¨ MCP ROUND 1 - BEFORE CODE
BÆ¯á»šC 4: IMPLEMENT CODE
BÆ¯á»šC 5: ğŸš¨ MCP ROUND 2 - AFTER CODE
BÆ¯á»šC 6: TESTING (Comprehensive Testing Strategy)
  â†’ Phase 1: Pre-Development (Planning)
  â†’ Phase 2: During Development (Continuous)
  â†’ Phase 3: Pre-Commit (Quick Checks)
  â†’ Phase 4: Pre-Release (Comprehensive)
  â†’ Phase 5: Acceptance Testing (UAT & Beta)
  â†’ Phase 6: Production Readiness (Pre-Deployment)
  â†’ Phase 7: Post-Release (Monitoring)
BÆ¯á»šC 7: ğŸ§¹ CLEANUP (Resource Management - sau test)
BÆ¯á»šC 8: DONE âœ…
```

**Testing trong Code Strategy:**
- âœ… **Dá»± Ã¡n má»›i:** TEST INTEGRATION sections (line 2500-2550) â†’ TÃ­ch há»£p vá»›i comprehensive testing
- âœ… **ThÃªm tÃ­nh nÄƒng:** TEST INTEGRATION sections (line 2893-2923) â†’ TÃ­ch há»£p vá»›i comprehensive testing
- âœ… **Workflow:** Testing cháº¡y sau MCP Round 2 (AFTER code)

---

### ğŸ¯ **IMPLEMENTATION STRATEGY - Phased Approach (10 Weeks)**

**Phase 1: Foundation (Week 1-2)**
- âœ… Setup testing tools (Jest, Playwright, pytest)
- âœ… Setup CI/CD pipeline (automated testing)
- âœ… Implement Quick Self QA (existing - giá»¯ nguyÃªn)
- âœ… Implement Pre-Commit Testing (unit tests, linter)

**Phase 2: Core Testing (Week 3-4)**
- âœ… Implement TDD workflow (write tests first)
- âœ… Implement Unit Testing (coverage > 80%)
- âœ… Implement Integration Testing (FE â†” BE â†” DB)
- âœ… Implement Comprehensive Testing Checklist

**Phase 3: System Testing (Week 5-6)**
- âœ… Implement System Testing (end-to-end workflows)
- âœ… Implement E2E Testing (Playwright, critical paths)
- âœ… Implement Regression Testing (automated regression)
- âœ… Implement Performance Testing (load, stress, scalability)

**Phase 4: Advanced Testing (Week 7-8)**
- âœ… Implement Visual Regression Testing (Percy)
- âœ… Implement Security Testing (OWASP ZAP)
- âœ… Implement Compatibility Testing (cross-browser, cross-device)
- âœ… Implement Reliability Testing (recovery, failover)

**Phase 5: Production Readiness (Week 9)**
- âœ… Implement Production-like Environment Testing
- âœ… Implement Load/Stress/Scalability Testing
- âœ… Implement Recovery Testing (disaster recovery)
- âœ… Implement Deployment Testing (deployment + rollback)
- âœ… Implement Monitoring & Alerting Testing

**Phase 6: Acceptance Testing (Week 10)**
- âœ… Implement UAT (User Acceptance Testing)
- âœ… Implement Beta Testing (limited users)
- âœ… Implement Business Acceptance Testing
- âœ… Collect User Feedback

**Phase 7: Continuous Improvement (Ongoing)**
- âœ… Monitor test coverage (maintain > 80%)
- âœ… Monitor test performance (optimize slow tests)
- âœ… Monitor test quality (remove flaky tests)
- âœ… Continuous improvement (better tests, better coverage)

---

### ğŸ¯ **EXPECTED OUTCOME**

**Sau khi implement:**
- âœ… Test má»i thá»©: Functional, UI/UX, Data, Integration, System, Performance, Security, Compatibility, Reliability, Usability, Acceptance, Deployment, Monitoring, Documentation, Production Readiness
- âœ… Test tá»« má»i gÃ³c Ä‘á»™: Unit, Integration, System, E2E, Visual, Manual
- âœ… Test vá»›i má»i phÆ°Æ¡ng phÃ¡p: Shift-Left, TDD, Continuous, Smart, AI-Powered, Risk-Based, Checklist, Automation, Regression, Production-like, UAT, Monitoring
- âœ… Test systematic: Comprehensive checklist (A-N: 14 categories), 100% coverage
- âœ… Test automated: CI/CD integration, fast feedback
- âœ… Test quality: > 95% pass rate, > 80% coverage
- âœ… Production ready: All quality gates passed, UAT approved
- âœ… Äáº£m báº£o há»‡ thá»‘ng hoáº¡t Ä‘á»™ng trÆ¡n tru 100% trÆ°á»›c khi bÃ n giao

**Benefits:**
- ğŸ¯ Quality assurance: Catch bugs sá»›m vÃ  tá»‘t nháº¥t
- ğŸš€ Confidence: Äáº£m báº£o há»‡ thá»‘ng hoáº¡t Ä‘á»™ng Ä‘Ãºng 100%
- ğŸ“ˆ Professional: Giá»‘ng nhÆ° QA tester chuyÃªn nghiá»‡p nháº¥t
- ğŸ›¡ï¸ Safety: KhÃ´ng bÃ n giao code cÃ³ bug
- âš¡ Efficiency: Automated testing, save time
- ğŸ“Š Visibility: Test reports, coverage metrics, quality gates
- ğŸ† Production ready: Sáºµn sÃ ng production, UAT approved

---

### ğŸ”„ **COMPATIBILITY CHECK - Äáº£m Báº£o Liá»n Máº¡ch**

**âœ… TÆ°Æ¡ng thÃ­ch vá»›i Version 4.0:**
- âœ… MCP Rounds váº«n Ã¡p dá»¥ng (BEFORE + AFTER code)
- âœ… Testing cháº¡y sau MCP Round 2 (AFTER code approval)
- âœ… Testing khÃ´ng conflict vá»›i MCP workflow

**âœ… TÆ°Æ¡ng thÃ­ch vá»›i Universal Workflow:**
- âœ… Testing lÃ  BÆ¯á»šC 6 trong Universal Workflow (sau MCP Round 2)
- âœ… Cleanup lÃ  BÆ¯á»šC 7 trong Universal Workflow (sau Testing)
- âœ… DONE lÃ  BÆ¯á»šC 8 trong Universal Workflow (sau Cleanup)
- âœ… Testing khÃ´ng thay tháº¿ MCP Rounds
- âœ… Testing bá»• sung cho workflow

**âœ… TÆ°Æ¡ng thÃ­ch vá»›i Code Strategy:**
- âœ… TEST INTEGRATION sections (line 2500-2550, 2893-2923) â†’ TÃ­ch há»£p vá»›i comprehensive testing
- âœ… Testing trong Code Strategy â†’ Comprehensive testing strategy
- âœ… KhÃ´ng conflict vá»›i Code Strategy

**âœ… TÆ°Æ¡ng thÃ­ch vá»›i Resource Management & Cleanup:**
- âœ… Cleanup sau test (existing - line 4126+)
- âœ… Testing workflow â†’ Cleanup workflow (smooth integration)
- âœ… KhÃ´ng conflict vá»›i cleanup

**âœ… TÆ°Æ¡ng thÃ­ch vá»›i Quick Self QA:**
- âœ… Quick Self QA giá»¯ nguyÃªn (existing - line 4083-4094)
- âœ… Comprehensive testing bá»• sung cho Quick Self QA
- âœ… KhÃ´ng thay tháº¿ Quick Self QA

**âœ… TÆ°Æ¡ng thÃ­ch vá»›i Before Committing:**
- âœ… Before Committing giá»¯ nguyÃªn (existing - line 4098-4122)
- âœ… Comprehensive testing bá»• sung cho Before Committing
- âœ… KhÃ´ng thay tháº¿ Before Committing

---

## ğŸ§¹ Resource Management & Cleanup - Quáº£n LÃ½ TÃ i NguyÃªn & Dá»n Dáº¹p

### âš ï¸ **QUAN TRá»ŒNG: Cleanup Sau Khi Test**

**Váº¥n Ä‘á»:** Sau khi test xong, cÃ¡c processes váº«n cháº¡y khiáº¿n mÃ¡y náº·ng vÃ  nÃ³ng:
- Development servers khÃ´ng terminate
- Database connections khÃ´ng Ä‘Ã³ng
- File watchers khÃ´ng dá»«ng
- Background processes khÃ´ng cleanup
- Test runners váº«n cháº¡y

**Giáº£i phÃ¡p:** AI PHáº¢I tá»± Ä‘á»™ng cleanup táº¥t cáº£ processes sau khi test xong.

---

### ğŸš¨ **MANDATORY CLEANUP CHECKLIST - Sau Khi Test**

AI PHáº¢I tá»± Ä‘á»™ng cleanup TRÆ¯á»šC KHI káº¿t thÃºc task:

```
[ ] BÆ¯á»šC 1: CHECK RUNNING PROCESSES
    â†’ [ ] Check development servers (npm run dev, python manage.py runserver, etc.)
    â†’ [ ] Check database connections (PostgreSQL, MySQL, MongoDB connections)
    â†’ [ ] Check file watchers (nodemon, chokidar, etc.)
    â†’ [ ] Check test runners (jest, pytest, mocha, etc.)
    â†’ [ ] Check background workers (celery, bull, etc.)
    â†’ [ ] Check other processes liÃªn quan Ä‘áº¿n project

[ ] BÆ¯á»šC 2: TERMINATE PROCESSES
    â†’ [ ] Stop development servers (Ctrl+C equivalent hoáº·c kill process)
    â†’ [ ] Close database connections (pool.close(), connection.end(), etc.)
    â†’ [ ] Stop file watchers (nodemon, chokidar, etc.)
    â†’ [ ] Stop test runners (náº¿u váº«n cháº¡y)
    â†’ [ ] Stop background workers (náº¿u cÃ³)
    â†’ [ ] Kill orphaned processes (processes khÃ´ng cÃ³ parent)

[ ] BÆ¯á»šC 3: CLEANUP RESOURCES
    â†’ [ ] Cleanup temporary files (test files, temp directories)
    â†’ [ ] Cleanup test databases (drop test DB náº¿u cÃ³)
    â†’ [ ] Cleanup log files (test logs, debug logs)
    â†’ [ ] Cleanup cache files (test cache, build cache náº¿u cáº§n)
    â†’ [ ] Cleanup environment variables (reset test env vars)

[ ] BÆ¯á»šC 4: VERIFY CLEANUP
    â†’ [ ] Verify khÃ´ng cÃ²n processes Ä‘ang cháº¡y
    â†’ [ ] Verify khÃ´ng cÃ²n connections má»Ÿ
    â†’ [ ] Verify khÃ´ng cÃ²n temp files
    â†’ [ ] Check system resources (CPU, memory usage)
    â†’ [ ] Confirm vá»›i user: "ÄÃ£ cleanup xong, mÃ¡y Ä‘Ã£ nháº¹ láº¡i!"
```

---

### ğŸ” **AUTO-DETECTION: Processes Cáº§n Cleanup**

AI PHáº¢I tá»± Ä‘á»™ng detect cÃ¡c processes sau:

**1. Development Servers:**
- `npm run dev`, `npm start`, `yarn dev`, `pnpm dev`
- `python manage.py runserver`, `uvicorn`, `fastapi run`
- `go run`, `cargo run`
- `rails server`, `php artisan serve`
- Next.js dev server, Vite dev server, Webpack dev server

**2. Database Connections:**
- PostgreSQL connections (pool connections)
- MySQL connections (connection pool)
- MongoDB connections (client connections)
- Redis connections (client connections)
- SQLite connections (file locks)

**3. File Watchers:**
- `nodemon`, `chokidar`, `watchman`
- `tsc --watch`, `webpack --watch`
- `truffle watch`, `sass --watch`

**4. Test Runners:**
- `jest --watch`, `pytest --watch`, `mocha --watch`
- `vitest`, `playwright`, `cypress`
- Test processes Ä‘ang cháº¡y

**5. Background Workers:**
- Celery workers (Python)
- Bull workers (Node.js)
- Sidekiq workers (Ruby)
- Background job processors

**6. Other Processes:**
- Docker containers (test containers)
- Local tunnels (ngrok, localtunnel)
- Mock servers (MSW, nock)
- Proxy servers

---

### ğŸ› ï¸ **CLEANUP COMMANDS - Lá»‡nh Dá»n Dáº¹p**

**Detect Running Processes:**
```bash
# macOS/Linux
ps aux | grep -E "(node|python|java|go|ruby)" | grep -v grep
lsof -i :3000,8000,5432,3306  # Check ports Ä‘ang dÃ¹ng
pgrep -f "npm|yarn|pnpm|dev|test"  # Check processes by name

# Windows (PowerShell)
Get-Process | Where-Object {$_.ProcessName -match "node|python|java"}
netstat -ano | findstr ":3000 :8000 :5432"  # Check ports
```

**Terminate Processes:**
```bash
# macOS/Linux
pkill -f "npm run dev"  # Kill by pattern
kill -9 <PID>  # Force kill
killall node  # Kill all node processes (âš ï¸ Cáº©n tháº­n!)

# Windows (PowerShell)
Stop-Process -Name "node" -Force
taskkill /F /PID <PID>
```

**Cleanup Database Connections:**
```python
# Python
db.close()  # Close connection
pool.close()  # Close pool
connection.close()

# Node.js
await prisma.$disconnect()  # Prisma
await mongoose.connection.close()  # Mongoose
redis.quit()  # Redis
```

**Cleanup Test Resources:**
```bash
# Drop test database
dropdb test_db  # PostgreSQL
mysql -e "DROP DATABASE test_db;"  # MySQL

# Cleanup temp files
rm -rf /tmp/test-*  # Linux/macOS
rm -rf node_modules/.cache  # Node.js cache
rm -rf .pytest_cache  # Python pytest cache
```

---

### ğŸ“‹ **CLEANUP WORKFLOW - Quy TrÃ¬nh Dá»n Dáº¹p**

**ğŸ¯ TRIáº¾T LÃ: "Test Xong = Táº¯t Táº¥t Cáº£, Cháº¡y Láº¡i = Má»Ÿ Láº¡i"**

**NguyÃªn táº¯c:**
- âœ… **Sau khi test xong â†’ Táº®T Táº¤T Cáº¢ processes (MANDATORY)**
- âœ… **Khi cháº¡y láº¡i â†’ Má»Ÿ láº¡i processes má»›i**
- âœ… **Má»¥c Ä‘Ã­ch: MÃ¡y luÃ´n nháº¹, khÃ´ng tÃ­ch lÅ©y processes**

**Khi nÃ o cleanup:**
- âœ… **Sau khi test xong (MANDATORY - táº¯t táº¥t cáº£)**
- âœ… Sau khi build xong (náº¿u cÃ³ processes)
- âœ… TrÆ°á»›c khi commit (náº¿u cÃ³ processes cháº¡y)
- âœ… Khi user bÃ¡o "mÃ¡y náº·ng" hoáº·c "nhiá»u processes"

**Workflow (Simplified):**
```
BÆ¯á»šC 1: CHáº Y TEST
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â†’ Run tests
â†’ Verify test results

BÆ¯á»šC 2: CLEANUP SAU TEST (MANDATORY)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â†’ ğŸ” Detect processes:
   * Development servers
   * Test runners
   * File watchers
   * Database connections
   * Background workers
   
â†’ ğŸ›‘ Táº¯t Táº¤T Cáº¢:
   * Stop development servers
   * Stop test runners
   * Stop file watchers
   * Close database connections
   * Stop background workers
   * Kill orphaned processes

â†’ ğŸ§¹ Cleanup resources:
   * Cleanup temporary files
   * Cleanup test databases (náº¿u cáº§n)
   * Cleanup log files
   * Cleanup cache files

BÆ¯á»šC 3: VERIFY & CONFIRM
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â†’ Verify khÃ´ng cÃ²n processes Ä‘ang cháº¡y
â†’ Check system resources (CPU, memory)
â†’ Confirm vá»›i user: "âœ… ÄÃ£ táº¯t táº¥t cáº£ processes! MÃ¡y Ä‘Ã£ nháº¹ láº¡i."

BÆ¯á»šC 4: KHI CHáº Y Láº I
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â†’ Má»Ÿ láº¡i processes má»›i khi cáº§n
â†’ KhÃ´ng cáº§n cleanup trÆ°á»›c (vÃ¬ Ä‘Ã£ táº¯t háº¿t rá»“i)
```

**âš ï¸ LÆ¯U Ã:**
- KhÃ´ng cáº§n cleanup TRÆ¯á»šC test (vÃ¬ Ä‘Ã£ táº¯t háº¿t rá»“i)
- Chá»‰ cleanup SAU test (mandatory)
- Má»—i láº§n test xong = táº¯t táº¥t cáº£, khÃ´ng giá»¯ láº¡i processes

---

### âš ï¸ **SAFETY RULES - Quy Táº¯c An ToÃ n**

**KHÃ”NG BAO GIá»œ:**
- âŒ Kill processes khÃ´ng liÃªn quan Ä‘áº¿n project (system processes)
- âŒ Kill processes ngÆ°á»i dÃ¹ng Ä‘ang dÃ¹ng (editors, browsers)
- âŒ Force kill processes quan trá»ng (database servers náº¿u shared)
- âŒ Cleanup production databases hoáº·c production resources
- âŒ Cleanup files khÃ´ng pháº£i test files (source code, configs)

**PHáº¢I:**
- âœ… Chá»‰ cleanup processes cá»§a project hiá»‡n táº¡i
- âœ… Verify process owner trÆ°á»›c khi kill
- âœ… Há»i user náº¿u khÃ´ng cháº¯c process nÃ o cáº§n cleanup
- âœ… Backup trÆ°á»›c khi cleanup databases (náº¿u cáº§n)
- âœ… Log actions cleanup Ä‘á»ƒ user biáº¿t

---

### ğŸ¯ **INTEGRATION - TÃ­ch Há»£p VÃ o Workflow**

**Trong Test Workflow:**
```
1. Run tests
2. Verify test results
3. ğŸ§¹ CLEANUP SAU TEST (MANDATORY):
   â†’ Táº®T Táº¤T Cáº¢ processes:
     * Stop test runners
     * Stop development servers (náº¿u cÃ³)
     * Stop file watchers (náº¿u cÃ³)
     * Close database connections
     * Stop background workers (náº¿u cÃ³)
   â†’ Cleanup resources:
     * Cleanup test files
     * Cleanup temp files
     * Cleanup cache files
   â†’ Verify cleanup (check CPU/memory)
   â†’ Confirm: "âœ… ÄÃ£ táº¯t táº¥t cáº£! MÃ¡y Ä‘Ã£ nháº¹ láº¡i."
4. Report results
```

**Trong Development Workflow:**
```
1. Start development server (náº¿u cáº§n)
2. Make changes
3. Test changes
4. ğŸ§¹ CLEANUP SAU TEST (MANDATORY):
   â†’ Táº®T Táº¤T Cáº¢ processes:
     * Stop development server
     * Stop test runners
     * Close database connections
     * Stop file watchers
   â†’ Cleanup temp files
   â†’ Verify cleanup
   â†’ Confirm: "âœ… ÄÃ£ táº¯t táº¥t cáº£! MÃ¡y Ä‘Ã£ nháº¹ láº¡i."
5. Continue hoáº·c commit
   â†’ Khi cáº§n cháº¡y láº¡i â†’ Má»Ÿ láº¡i processes má»›i
```

**Trong Build Workflow:**
```
1. Build project
2. Run build tests
3. ğŸ§¹ CLEANUP (After build):
   â†’ Stop build processes
   â†’ Cleanup build artifacts (náº¿u cáº§n)
   â†’ Cleanup cache files
   â†’ Verify cleanup
4. Deploy hoáº·c package
```

---

### ğŸ“ **EXAMPLES - VÃ­ Dá»¥ Cá»¥ Thá»ƒ**

**Example 1: Cleanup sau khi test Node.js project**
```
User: "Test xong rá»“i"

AI:
1. ğŸ” Detect processes:
   â†’ Found: node (PID 1234) - npm run dev
   â†’ Found: node (PID 5678) - jest --watch
   â†’ Found: PostgreSQL connection (pool)

2. ğŸ›‘ Táº®T Táº¤T Cáº¢ (MANDATORY):
   â†’ kill -9 1234 (stop dev server)
   â†’ kill -9 5678 (stop test runner)
   â†’ await prisma.$disconnect() (close DB connection)
   â†’ Cleanup temp files

3. âœ… Verify:
   â†’ Check: No node processes running
   â†’ Check: No database connections
   â†’ Check: CPU usage giáº£m tá»« 85% â†’ 25%
   â†’ Confirm: "âœ… ÄÃ£ táº¯t táº¥t cáº£ processes! MÃ¡y Ä‘Ã£ nháº¹ láº¡i."
```

**Example 2: Cleanup sau khi test Python project**
```
User: "Test xong, cleanup giÃºp"

AI:
1. ğŸ” Detect processes:
   â†’ Found: python (PID 1234) - uvicorn app:app
   â†’ Found: python (PID 5678) - pytest --watch
   â†’ Found: PostgreSQL connection pool

2. ğŸ§¹ Cleanup:
   â†’ kill -9 1234 (stop uvicorn)
   â†’ kill -9 5678 (stop pytest)
   â†’ db.close() (close DB connection)
   â†’ rm -rf .pytest_cache (cleanup cache)

3. âœ… Verify:
   â†’ Check: No python processes running
   â†’ Check: No database connections
   â†’ Confirm: "ÄÃ£ cleanup xong!"
```

**Example 3: Cleanup khi user bÃ¡o mÃ¡y náº·ng**
```
User: "MÃ¡y tÃ´i náº·ng quÃ¡, kiá»ƒm tra giÃºp"

AI:
1. ğŸ” Check system resources:
   â†’ CPU usage: 85% (high!)
   â†’ Memory usage: 90% (high!)
   â†’ Running processes: 15+ (many!)

2. ğŸ” Detect project processes:
   â†’ Found: 3 node processes (dev server, test runner, watcher)
   â†’ Found: 2 python processes (api server, worker)
   â†’ Found: Multiple database connections

3. ğŸ§¹ Cleanup:
   â†’ Kill all project processes
   â†’ Close all database connections
   â†’ Cleanup temp files
   â†’ Cleanup cache

4. âœ… Verify:
   â†’ CPU usage: 25% (normal)
   â†’ Memory usage: 40% (normal)
   â†’ Running processes: 5 (normal)
   â†’ Confirm: "ÄÃ£ cleanup xong! CPU: 85% â†’ 25%, Memory: 90% â†’ 40%"
```

---

### ğŸš¨ **AUTO-CLEANUP TRIGGERS - Tá»± Äá»™ng Táº¯t Processes**

AI PHáº¢I tá»± Ä‘á»™ng Táº®T Táº¤T Cáº¢ processes khi:

1. **Test xong (MANDATORY - Æ¯u tiÃªn cao nháº¥t):**
   - âœ… Sau khi test passes/fails
   - âœ… Sau khi test suite completes
   - âœ… Tá»± Ä‘á»™ng Táº®T Táº¤T Cáº¢: test runners, dev servers, file watchers, DB connections
   - âœ… Confirm: "âœ… ÄÃ£ táº¯t táº¥t cáº£! MÃ¡y Ä‘Ã£ nháº¹ láº¡i."

2. **Build xong:**
   - Sau khi build succeeds/fails
   - Sau khi build completes
   - Tá»± Ä‘á»™ng táº¯t build processes

3. **User request:**
   - User: "Cleanup processes" â†’ Táº¯t táº¥t cáº£
   - User: "MÃ¡y náº·ng quÃ¡" â†’ Táº¯t táº¥t cáº£
   - User: "Kiá»ƒm tra processes" â†’ Táº¯t táº¥t cáº£

4. **System resource high:**
   - CPU usage > 80% â†’ Táº¯t táº¥t cáº£
   - Memory usage > 85% â†’ Táº¯t táº¥t cáº£
   - Nhiá»u processes Ä‘ang cháº¡y â†’ Táº¯t táº¥t cáº£

**âš ï¸ LÆ¯U Ã:**
- KhÃ´ng cáº§n cleanup TRÆ¯á»šC test (vÃ¬ Ä‘Ã£ táº¯t háº¿t rá»“i)
- Chá»‰ cleanup SAU test (mandatory)
- Má»—i láº§n test xong = táº¯t táº¥t cáº£, khÃ´ng giá»¯ láº¡i

---

### âœ… **BEST PRACTICES - Thá»±c HÃ nh Tá»‘t**

1. **Always cleanup after tests:**
   - âœ… Stop test runners
   - âœ… Close test database connections
   - âœ… Cleanup test files
   - âœ… Verify cleanup

2. **Monitor system resources:**
   - âœ… Check CPU/memory usage
   - âœ… Detect processes Ä‘ang cháº¡y
   - âœ… Alert náº¿u resources high

3. **Cleanup gradually:**
   - âœ… Stop development servers first
   - âœ… Close database connections second
   - âœ… Cleanup files last
   - âœ… Verify after each step

4. **Log cleanup actions:**
   - âœ… Log processes Ä‘Ã£ terminate
   - âœ… Log resources Ä‘Ã£ cleanup
   - âœ… Log system resources before/after

5. **Ask before force kill:**
   - âœ… Verify process owner
   - âœ… Check náº¿u process quan trá»ng
   - âœ… Há»i user náº¿u khÃ´ng cháº¯c

---

### ğŸ“Š **RESOURCE MONITORING - GiÃ¡m SÃ¡t TÃ i NguyÃªn**

**AI PHáº¢I check system resources khi:**
- User bÃ¡o "mÃ¡y náº·ng"
- Cleanup xong (verify cleanup successful)
- Nhiá»u processes Ä‘ang cháº¡y

**Commands Ä‘á»ƒ check:**
```bash
# macOS/Linux
top -l 1 | head -10  # CPU/Memory usage
ps aux --sort=-%mem | head -10  # Memory usage
ps aux --sort=-%cpu | head -10  # CPU usage

# Windows (PowerShell)
Get-Process | Sort-Object CPU -Descending | Select-Object -First 10
Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10
```

**Alert thresholds:**
- âš ï¸ CPU usage > 80% â†’ Alert vÃ  cleanup
- âš ï¸ Memory usage > 85% â†’ Alert vÃ  cleanup
- âš ï¸ Processes > 20 â†’ Check vÃ  cleanup

---

### ğŸ¯ **QUICK REFERENCE - Tham Kháº£o Nhanh**

**Cleanup Checklist:**
```
âœ… Stop development servers
âœ… Close database connections
âœ… Stop file watchers
âœ… Stop test runners
âœ… Cleanup temp files
âœ… Cleanup test databases
âœ… Verify cleanup
âœ… Confirm vá»›i user
```

**Commands:**
```bash
# Detect processes
ps aux | grep -E "(node|python|java)" | grep -v grep

# Kill processes
pkill -f "npm run dev"
kill -9 <PID>

# Cleanup
rm -rf .pytest_cache
rm -rf node_modules/.cache
```

**When to cleanup (Táº®T Táº¤T Cáº¢):**
- âœ… **After tests (MANDATORY - táº¯t táº¥t cáº£)**
- âœ… After build (if needed)
- âœ… User request
- âœ… System resources high

**Workflow:**
- Test xong â†’ Táº¯t táº¥t cáº£ processes
- Cháº¡y láº¡i â†’ Má»Ÿ láº¡i processes má»›i
- KhÃ´ng giá»¯ láº¡i processes sau test

---

## Framework-Specific Notes

### ğŸ“ **ÄIá»€N PHáº¦N NÃ€Y CHO Dá»° ÃN Cá»¦A Báº N**

### Backend Framework: **[YOUR_BACKEND_FRAMEWORK]**

**Patterns & Structure:**
- [Pattern chÃ­nh cá»§a framework, e.g., Controller â†’ Service â†’ Repository]
- [Dependency Injection pattern náº¿u cÃ³]
- [Middleware/Guards pattern]
- [DTO/Validation approach]
- [API Documentation tool náº¿u cÃ³]
- [Exception Handling pattern]

**Key Conventions:**
```[language]
// [Example 1: Controller/Router pattern]


// [Example 2: Service/Business Logic pattern]


// [Example 3: Database/ORM pattern]

```

---

### Frontend Framework: **[YOUR_FRONTEND_FRAMEWORK]**

**Patterns & Structure:**
- [Component structure (e.g., functional vs class, server vs client)]
- [State Management approach]
- [Data Fetching strategy]
- [Form Handling]
- [Styling approach]
- [Animation/Transition library náº¿u cÃ³]

**Key Conventions:**
```[language]
// [Example 1: Component pattern]


// [Example 2: State Management]


// [Example 3: Data Fetching]

```

---

### Database/ORM: **[YOUR_DATABASE + ORM]**

**Common operations:**
```[language]
// [Example 1: CRUD vá»›i relations]


// [Example 2: Transactions]


// [Example 3: Query optimization (eager loading, etc.)]


// [Example 4: Migration workflow commands]

```

---

**ğŸ’¡ TIP:** Tham kháº£o templates á»Ÿ cuá»‘i file (NestJS, FastAPI, Django, Spring Boot) Ä‘á»ƒ Ä‘iá»n pháº§n nÃ y

---

## Project-Specific Conventions

### ğŸ“ **ÄIá»€N PHáº¦N NÃ€Y CHO Dá»° ÃN Cá»¦A Báº N**

**API Conventions:**
- Base URL format: `[YOUR_API_BASE_URL]` (e.g., http://localhost:3000/api, https://api.yourapp.com)
- Authentication method: [YOUR_AUTH_METHOD] (e.g., JWT Bearer Token, API Key, Session Cookie)
- Response format: 
  ```[language]
  // Success
  [Your success response structure]
  
  // Error
  [Your error response structure]
  ```

**Naming Conventions:**
- **Files**: 
  - Backend: [YOUR_CONVENTION] (e.g., kebab-case, snake_case, PascalCase)
  - Frontend: [YOUR_CONVENTION]
- **Functions/Methods**: [YOUR_CONVENTION] (e.g., camelCase, snake_case)
- **Classes/Components**: [YOUR_CONVENTION] (e.g., PascalCase)
- **Constants**: [YOUR_CONVENTION] (e.g., UPPER_SNAKE_CASE, SCREAMING_SNAKE_CASE)
- **Enums**: [YOUR_CONVENTION] (e.g., PascalCase, UPPER_SNAKE_CASE)

**Key Directories:**
- **Config**: [Path to main config files]
- **Models/Entities**: [Path to database models/schemas]
- **Services/Business Logic**: [Path to service layer]
- **API Routes**: [Path to API controllers/routes]
- **Frontend Pages**: [Path to page components]
- **Frontend Components**: [Path to reusable components]
- **Tests**: [Path to test files]

**Important Files:**
- **Schema/Models**: [Path, e.g., prisma/schema.prisma, models.py]
- **Environment config**: [e.g., .env.example, config.yaml]
- **Backend entry**: [e.g., src/main.ts, app.py, server.js]
- **Frontend entry**: [e.g., src/app/layout.tsx, src/main.tsx, index.html]
- **API Client**: [Path to API client/fetcher]
- **State Management**: [Path to store/state management files]
- **Build/Deploy Scripts**: [e.g., build.sh, deploy.yml]

**Business Logic Notes:**
[Ghi chÃº vá» business logic quan trá»ng cá»§a dá»± Ã¡n, vÃ­ dá»¥:]
- **[Entity] Lifecycle**: [Describe flow, e.g., DRAFT â†’ PENDING â†’ APPROVED â†’ COMPLETED]
- **User Roles**: [List roles, e.g., ADMIN, USER, GUEST]
- **[Entity] Status**: [List possible statuses]
- **Important Workflows**: [Describe critical workflows]

---

## Quick Reference Card - ULTRA-SAFE MODE (v4.0)

```
ğŸš€ VERSION 4.0 - ULTRA-SAFE MODE (Maximum Safety):
âœ… Má»ŒI task â†’ 2 ROUNDS MCP - ALWAYS!
âœ… Round 1: BEFORE code (approve design)
âœ… Round 2: AFTER code (approve implementation)
âœ… No task classification needed
âœ… 100% visibility before AND after coding
âœ… Zero surprises for user
âœ… Maximum safety & quality

ğŸ¯ WORKFLOW - SIMPLIFIED:
1. PhÃ¢n tÃ­ch task
2. ğŸš¨ ROUND 1: Call MCP BEFORE code
3. â¸ï¸ Wait for design approval
4. Implement code
5. ğŸš¨ ROUND 2: Call MCP AFTER code
6. â¸ï¸ Wait for code approval
7. Done âœ…

ğŸ“‹ TWO MODES (Simplified in v4.0):

NORMAL MODE (95% tasks)
â”œâ”€ Trigger: Má»i task thÃ´ng thÆ°á»ng
â”œâ”€ MCP Rounds: 2 (BEFORE + AFTER code)
â”œâ”€ Round 1: Design approval (before coding)
â”œâ”€ Round 2: Implementation approval (after coding)
â”œâ”€ Flow: Analyze â†’ MCP R1 â†’ Approve â†’ Code â†’ MCP R2 â†’ Approve â†’ Done
â””â”€ Ãp dá»¥ng: Má»ŒI task (feature, bug fix, refactor, typo, etc.)

DEBUG MODE (5% tasks) ğŸ”¥
â”œâ”€ Trigger: ÄÃ£ lÃ m 2+ láº§n nhÆ°ng VáºªN CHÆ¯A GIáº¢I QUYáº¾T
â”œâ”€ MCP Rounds: 3 (BEFORE + DEBUG ANALYSIS + CLEANUP)
â”œâ”€ Flow: Deep analysis â†’ MCP R1 â†’ Add debug logs â†’ 
â”‚         Test â†’ MCP R2 (analyze logs) â†’ Fix â†’ 
â”‚         MCP R3 (confirm + cleanup) â†’ Remove logs â†’ Done
â””â”€ Ãp dá»¥ng: Mysterious bugs, 3-strike rule triggered

**Note:** MODE 1 vÃ  MODE 2 cÅ© giá» há»£p nháº¥t thÃ nh NORMAL MODE (Ä‘á»u 2 rounds)

ğŸš¨ MCP ALWAYS TRIGGERED:
âœ… **Má»ŒI task** - KhÃ´ng phÃ¢n biá»‡t lá»›n nhá»
âœ… Feature má»›i
âœ… Bug fixes  
âœ… Refactoring
âœ… Config changes
âœ… Documentation updates
âœ… Typo fixes
âœ… **EVERYTHING!**

ğŸ“‹ TASK ANALYSIS (Simplified):

Q1: Files affected?
    â†’ List all files that will change

Q2: Notable points?
    â†’ Database, API, Breaking, Dependencies, Risks

ğŸ› ï¸ MCP FEEDBACK TEMPLATE (Version 4.0):

ROUND 1 (BEFORE CODE - ALWAYS):
- Task description
- Approach/solution
- Files to change
- Technical details (Backend/Frontend/DB)
- Things to note (Dependencies, Risks, etc.)
- Alternatives considered
- Questions for user

ROUND 2 (AFTER CODE - ALWAYS):
- Implemented code summary
- Files changed with key highlights
- Verification checklist
- Differences from plan (if any)
- Ready to deploy?

Tool: mcp_interactive-feedback_interactive_feedback
Params: {
  project_directory: "[YOUR_ABSOLUTE_PROJECT_PATH]",
  summary: "[Detailed proposal based on mode]"
}

âš¡ TOOL USAGE:
- grep > codebase_search > read_file
- search_replace > write  
- Parallel calls when possible
- Read before write (always!)

ğŸ’¬ COMMUNICATION (v4.0):
Before EVERY task:
1. Analyze task (files affected, notable points)
2. State: "Theo Version 4.0: Má»ŒI task â†’ 2 ROUNDS MCP!"
3. ğŸš¨ Call MCP Round 1 (design)
4. â¸ï¸ Wait for approval
5. Implement code
6. ğŸš¨ Call MCP Round 2 (implementation)
7. â¸ï¸ Wait for approval
8. Done!

Language:      Vietnamese, concise, friendly
No tool names:  Say "TÃ´i Ä‘ang tÃ¬m..." not "Using grep..."
Format:        Analysis â†’ MCP â†’ Code â†’ Done
Git commits:   <type>: <message tiáº¿ng Viá»‡t>

âœ… ALWAYS DO (v4.0):
- ğŸš¨ Gá»ŒI MCP ROUND 1 TRÆ¯á»šC KHI code (Má»ŒI task - NO EXCEPTIONS!)
- â¸ï¸ Wait for design approval
- ğŸ’» Implement code
- ğŸš¨ Gá»ŒI MCP ROUND 2 SAU KHI code (Má»ŒI task - NO EXCEPTIONS!)
- â¸ï¸ Wait for implementation approval
- Error handling (try-catch, validation)
- Type safety (TypeScript strict)
- Follow existing patterns
- Parallel tool calls
- Read before write
- Clean up temp files

âŒ NEVER DO:
- **Skip ROUND 1 (before code)** - FORBIDDEN!
- **Skip ROUND 2 (after code)** - FORBIDDEN!
- Code without Round 1 approval
- Deploy without Round 2 approval
- Hardcode secrets/credentials
- Auto-commit (only when asked)
- Premature optimization
- Over-engineering
- Ignore existing patterns
- Leave debug statements

ğŸ¯ DECISION (v4.0 - EVEN SIMPLER):
**EVERYTHING â†’ 2 ROUNDS MCP!**
- No classification needed
- No risk analysis needed
- No mode detection needed (except Debug Mode for 3rd+ attempt)
- Just: 2 rounds ALWAYS!

ğŸ“Š KEY METRICS (v4.0):
- Normal Mode: ~95% of tasks (2 rounds MCP)
- Debug Mode: ~5% of tasks (3 rounds with logging) ğŸ”¥
- MCP Round 1 time: 2-5 min (design approval)
- MCP Round 2 time: 2-5 min (code approval)
- Total approval time: 4-10 min per task (vs 30-120 min refactor if wrong!)
- ROI: 10-20x from catching issues early (both design AND implementation)
- Debug success rate: 95% issues resolved
- User satisfaction: MAXIMUM (100% visibility before AND after code!)
- Surprise rate: 0% (everything approved twice!)

ğŸ¯ SUCCESS CRITERIA:
âœ… Zero unexpected changes
âœ… User approves every approach
âœ… High quality code (reviewed before)
âœ… Fast iterations (no refactors)
âœ… Clear communication
âœ… Peace of mind for everyone

ğŸ§¹ CLEANUP:
- Remove temp files after done
- No debug statements in final code
- Proper error messages (Vietnamese)
- **MANDATORY: Cleanup processes sau khi test:**
  - âœ… Stop development servers
  - âœ… Close database connections
  - âœ… Stop file watchers
  - âœ… Stop test runners
  - âœ… Cleanup temp files
  - âœ… Verify cleanup (check CPU/memory usage)
  - âœ… Confirm vá»›i user: "ÄÃ£ cleanup xong!"
```

---

## ğŸš€ One-Liner Prompts

**Nhá»› 3 prompts nÃ y lÃ  Ä‘á»§:**

### 1ï¸âƒ£ Dá»± Ã¡n má»›i (Setup):
```
Setup .cursorrules cho project nÃ y - tá»± Ä‘á»™ng toÃ n bá»™
```

### 2ï¸âƒ£ Session thÆ°á»ng (Daily):
```
HÃ´m nay tÃ´i cáº§n: [task cá»¥ thá»ƒ]
```

### 3ï¸âƒ£ Debug nhanh:
```
Fix lá»—i [mÃ´ táº£] - nhanh nháº¥t cÃ³ thá»ƒ
```

**Váº¬Y THÃ”I! ÄÆ¡n giáº£n Ä‘Ãºng khÃ´ng? ğŸ˜Š**

---

**ğŸ¯ Má»¥c tiÃªu:** Nhanh - Gá»n - ChÃ­nh xÃ¡c - Tiáº¿t kiá»‡m - Linh hoáº¡t

---

## ğŸ¤– Auto-Setup Instructions (Cho AI)

**Khi user yÃªu cáº§u "Setup .cursorrules cho project nÃ y":**

### BÆ°á»›c 1: PhÃ¢n TÃ­ch Project
```
1. Äá»c package.json / requirements.txt / go.mod / pom.xml
2. XÃ¡c Ä‘á»‹nh tech stack (Backend, Frontend, Database)
3. List dependencies chÃ­nh (frameworks, ORMs, libs)
4. Äá»c README.md náº¿u cÃ³ Ä‘á»ƒ hiá»ƒu má»¥c Ä‘Ã­ch
5. Cháº¡y `tree -L 2` hoáº·c `ls -R` Ä‘á»ƒ hiá»ƒu structure
```

### BÆ°á»›c 2: Äiá»n Tá»± Äá»™ng
```
1. Äiá»n "Project Context" section (lines 3-15)
   - Tech Stack dá»±a trÃªn dependencies detected
   - Má»¥c Ä‘Ã­ch tá»« README hoáº·c infer tá»« structure
   - Project Structure tá»« tree output

2. Äiá»n "Framework-Specific Notes" (lines 314-342)
   - Patterns cá»¥ thá»ƒ cho framework detected
   - Examples code vá»›i syntax Ä‘Ãºng

3. Äiá»n "Project-Specific Conventions" (lines 345-371)
   - API format náº¿u detect Ä‘Æ°á»£c (REST/GraphQL)
   - Naming conventions tá»« existing files
   - Key directories tá»« structure analysis

4. Update "Ignore" list náº¿u cáº§n (lines 87-127)
   - ThÃªm project-specific ignores
```

### BÆ°á»›c 3: Confirm & Commit
```
1. Show summary cá»§a nhá»¯ng gÃ¬ Ä‘Ã£ Ä‘iá»n
2. Ask: "XÃ¡c nháº­n vÃ  commit?"
3. If yes: git add .cursorrules && git commit -m "docs: setup Cursor AI rules"
```

---

## ğŸ“‹ Checklist Khi Báº¯t Äáº§u Dá»± Ãn Má»›i

### Option 1: Tá»± Äá»™ng (Khuyáº¿n Nghá»‹ - 2 phÃºt)
```markdown
Prompt: "Setup .cursorrules cho project nÃ y - tá»± Ä‘á»™ng toÃ n bá»™"

AI sáº½:
âœ… PhÃ¢n tÃ­ch project
âœ… Äiá»n má»i thá»© tá»± Ä‘á»™ng
âœ… Há»i confirm
âœ… Commit náº¿u báº¡n Ä‘á»“ng Ã½
```

### Option 2: Thá»§ CÃ´ng (5-10 phÃºt)
- [ ] Äiá»n Tech Stack (Backend, Frontend, Database, Deployment)
- [ ] Äiá»n Má»¥c Ä‘Ã­ch dá»± Ã¡n
- [ ] Äiá»n Project Structure (cháº¡y `tree -L 2`)
- [ ] Update Files & Directories to Ignore (náº¿u cáº§n)
- [ ] Äiá»n Framework-Specific Notes (patterns & examples)
- [ ] Äiá»n Project-Specific Conventions (API, Naming, Key Files)
- [ ] Commit: `git add .cursorrules && git commit -m "docs: setup Cursor AI rules"`

**ğŸ’¡ Tip:** DÃ¹ng Option 1 - Nhanh vÃ  chÃ­nh xÃ¡c hÆ¡n!

---

## ğŸ¯ Common Tech Stack Quick Templates

<details>
<summary>ğŸ“˜ NestJS + Prisma + Next.js (Click to expand)</summary>

```markdown
**Tech Stack:**
- Backend: NestJS + Prisma + PostgreSQL/MySQL
- Frontend: Next.js 14 + React + TailwindCSS
- Database: PostgreSQL/MySQL
- Deployment: Docker Compose

**Patterns:**
- Backend: Controller â†’ Service â†’ Prisma
- Frontend: App Router, Server Components default
- Auth: JWT + Passport
- Validation: class-validator (backend), Zod (frontend)
```
</details>

<details>
<summary>ğŸ FastAPI + SQLAlchemy + React (Click to expand)</summary>

```markdown
**Tech Stack:**
- Backend: FastAPI + SQLAlchemy + PostgreSQL
- Frontend: React 18 + Vite + TailwindCSS
- Database: PostgreSQL
- Deployment: Docker

**Patterns:**
- Backend: Router â†’ Service â†’ SQLAlchemy
- Frontend: Hooks, Context for state
- Auth: JWT Bearer
- Validation: Pydantic (backend), Yup/Zod (frontend)
```
</details>

<details>
<summary>ğŸ¸ Django + Vue (Click to expand)</summary>

```markdown
**Tech Stack:**
- Backend: Django + Django REST Framework + PostgreSQL
- Frontend: Vue 3 + Composition API + Vuetify
- Database: PostgreSQL
- Deployment: Docker

**Patterns:**
- Backend: Views â†’ Serializers â†’ Models
- Frontend: Composition API, Pinia for state
- Auth: Django Auth + JWT
- Validation: DRF Serializers
```
</details>

<details>
<summary>â˜• Spring Boot + Angular (Click to expand)</summary>

```markdown
**Tech Stack:**
- Backend: Spring Boot + JPA + MySQL
- Frontend: Angular 17 + TypeScript + Material
- Database: MySQL
- Deployment: Kubernetes

**Patterns:**
- Backend: Controller â†’ Service â†’ Repository
- Frontend: Services + RxJS, NgRx for state
- Auth: Spring Security + JWT
- Validation: Bean Validation (backend), Reactive Forms (frontend)
```
</details>

---

**ğŸ¯ Má»¥c tiÃªu:** Nhanh - Gá»n - ChÃ­nh xÃ¡c - Tiáº¿t kiá»‡m - Linh hoáº¡t

**Sau khi setup â†’ File nÃ y giÃºp AI hiá»ƒu project ngay láº­p tá»©c! ğŸš€**
